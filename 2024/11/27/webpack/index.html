<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.font.im/css?family=HarmonyOS_Regular:300,300italic,400,400italic,700,700italic|JetBrains Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"github.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="npm相关  课堂临时记录，后续单独开篇 ~  在我们需要下载第三方包之前 需要先初始化项目 npm init -y: 初始化项目, 生成 package.json 文件 init 表示的是初始化 -y 表示的是所有需要填写的内容都使用默认的">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack 学习">
<meta property="og:url" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/index.html">
<meta property="og:site_name" content="老许的欢乐世界">
<meta property="og:description" content="npm相关  课堂临时记录，后续单独开篇 ~  在我们需要下载第三方包之前 需要先初始化项目 npm init -y: 初始化项目, 生成 package.json 文件 init 表示的是初始化 -y 表示的是所有需要填写的内容都使用默认的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707230125487.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707230147762.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707230212662.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707224530157.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707230231353.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712165237536.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712165249707.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707231535073.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707231754415.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712163127495.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712164729873.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712164815568.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712170658784.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220712170714878.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20231212184839838.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20231212185339848.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20231212185404993.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220713233728291.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220714222243288.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220714222504046.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220714222917297.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220714223714865.png">
<meta property="article:published_time" content="2024-11-27T09:08:01.591Z">
<meta property="article:modified_time" content="2024-08-28T07:34:18.744Z">
<meta property="article:author" content="老许">
<meta property="article:tag" content="webpack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/image-20220707230125487.png">

<link rel="canonical" href="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<link rel="preconnect" href="https://s1.hdslb.com/" />
<link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/regular.css" media="all" onload="this.media='all'" />
<link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/medium.css" media="all" onload="this.media='all'" />

  <title>webpack 学习 | 老许的欢乐世界</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="老许的欢乐世界" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a href="https://github.com/xuwanghui" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">老许的欢乐世界</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">愿与上善 唯望君安</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">13</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">16</span></a>

  </li>
        <li class="menu-item menu-item-comments">

    <a href="/comments/" rel="section"><i class="fa fa-comments fa-fw"></i>留言板</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    <!--看板娘-->
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
    <script src="/live2d-widget/autoload.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/gh/xuwanghui/live2d-widget/autoload.js"></script>-->

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="老许">
      <meta itemprop="description" content="当学习成为了习惯<br/>知识也就变成了常识">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老许的欢乐世界">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          webpack 学习
        </h1>

        <div class="post-meta">
        
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-11-27 17:08:01" itemprop="dateCreated datePublished" datetime="2024-11-27T17:08:01+08:00">2024-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-28 15:34:18" itemprop="dateModified" datetime="2024-08-28T15:34:18+08:00">2024-08-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/webpack/" itemprop="url" rel="index"><span itemprop="name">webpack</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/11/27/webpack/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/11/27/webpack/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>42k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>38 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="npm相关">npm相关</h4>
<blockquote>
<p>课堂临时记录，后续单独开篇 ~</p>
</blockquote>
<p>在我们需要下载第三方包之前 需要先初始化项目</p>
<p><code>npm init -y</code>: 初始化项目, 生成 package.json 文件</p>
<p><code>init</code> 表示的是初始化</p>
<p><code>-y</code> 表示的是所有需要填写的内容都使用默认的</p>
<span id="more"></span>
<p><strong>package.json字段</strong></p>
<p>name：包名。规范定义它需要由小写的字母和数字组成，可以包含.、_和-，但不允许出现空格。不允许出现中文，<em><strong>*包名必须是唯一的*</strong></em>，以免对外公布时产生重名冲突的误解。除此之外，NPM还建议不要在包名中附带上node或js来重复标识它是JavaScript或Node模块。</p>
<p>author：作者</p>
<p>description：包的简介</p>
<p>version：版本号</p>
<p>main：入口文件</p>
<p>keywords：关键词数组，NPM中主要用来做分类搜索。一个好的关键词数组有利于用户快速找到你编写的包。</p>
<p>devDependencies：一些模块只在开发时需要依赖。配置这个属性，可以提示包的后续开发者安装依赖包。</p>
<p>dependencies：使用当前包所需要依赖的包列表。这个属性十分重要，NPM会通过这个属性帮助自动加载依赖的包。</p>
<p>scripts：脚本说明对象。它主要被包管理器用来安装、编译、测试和卸载包。</p>
<p>bin：一些包作者希望包可以作为命令行工具使用。配置好bin字段后，通过npm install package name -g命令可以将脚本添加到执行路径中，之后可以在命令行中直接执行。前面的node -gyp即是这样安装的。通过-g命令安装的模块包称为全局模式。</p>
<p><strong>dependencies  VS  devDependencies</strong></p>
<p>dependencies：生产依赖 项目在部署运行时需要用到的依赖</p>
<p>(npm i 包名 --save 或者 npm i 包名)</p>
<p>devDependencies：开发依赖 项目在开发时候需要用到的依赖</p>
<p>(npm i 包名 --save-dev 或者 npm i 包名 -D)</p>
<p>还有一种 npm i 包名 –g：全局安装 =&gt; 安装在nodejs目录下的node_modules中</p>
<p>安装在全局的目的是为了在任意位置都能够使用该包</p>
<p>为什么能在任意位置使用它呢？因为配置了环境变量</p>
<p>初始化项目后可以通过 npm i（install） 包名，比如：npm i jquery</p>
<p>来下载第三方模块，第三方模块会默认下载到当前项目下的node_modules中</p>
<p>卸载第三方包：npm un（uninstall） 包名（后缀和安装包的时候保持一致）</p>
<p>npm 设置淘宝镜像源：<code>npm config set registry=https://registry.npm.taobao.org/</code></p>
<h4 id="什么是构建工具">什么是构建工具</h4>
<p><strong>事实上随着前端的快速发展，目前前端的开发已经变的越来越复杂了：</strong></p>
<p>比如开发过程中我们需要通过模块化的方式来开发；</p>
<p>比如也会使用一些高级的特性来加快我们的开发效率或者安全性，比如通过ES6+、TypeScript开发脚本逻辑， 通过sass、less等方式来编写css样式代码；</p>
<p>比如开发过程中，我们还希望实时的监听文件的变化来并且反映到浏览器上，提高开发的效率；</p>
<p>比如开发完成后我们还需要将代码进行压缩、合并以及其他相关的优化；</p>
<p>等等….</p>
<p>上述这些工作理论上是可以人工完成的，但是它繁琐，工作量大，本质是无意义的劳动，人为的错误也随着流程的增加而增加了更多的出错率。所以每一个团队都希望有一种工具，能帮助整个团队在开发中能精简流程、提高效率、减少错误率，管理各种小工具之间的错综复杂的关系或者配置，这种工具就叫构建工具。</p>
<p>说到构建工具，我往往会在前面加**「自动化」**三个字，因为构建工具就是用来让我们不再做机械重复的事情，解放我们的双手的(my god)。所以构建工具作用是：提升项目性能，提高开发效率。</p>
<h4 id="构建工具的发展">构建工具的发展</h4>
<p>有了工具能满足基本的打包工作，对于开发人员而言总是需要更精益求精。就像在一辆能发动的车上去安装各种零件来提升使用者的体验。这些零件就是构建工具所需要的插件，这些插件对提升开发效率很有帮助，包括语法转换（Babel），模板热更新（HotModuleReplacementPlugin），清理重复的打包的文件（clean-webpack-plugin）等等。</p>
<p>构建工具目前来说还在处于不停发展的阶段，但是相应的打包技术已经很成熟。 本次主要介绍市面上比较火热的Gulp，Grunt， Webpack, Vite这三个打包工具之间的对比和它们的优势。</p>
<h4 id="构建工具介绍">构建工具介绍</h4>
<p>Grunt: 是一个优化前端的开发流程的工具。<br>
配置一系列的task，定义task处理的事务（例如文件压缩合并、启动server、版本控制等），然后定义执行顺序，来让Grunt执行这些task，从而构建项目的整个前端开发流程。<br>
工作方式：<br>
<img data-src="image-20220707230125487.png" alt=""></p>
<p>Wepack: 是一种模块化的解决方案。更强调模块化。<br>
把你的项目当做一个整体，通过一个指定的主文件名（index.js, 一般是入口文件），webpack 将从这个文件开始找到你的项目所依赖的文件，使用loaders 来处理它们，最后打包为一个浏览器可识别的js 文件。<br>
<img data-src="image-20220707230147762.png" alt=""></p>
<p>Vite: 一种新型前端构建工具,它区别与不同的打包工具,它在开发环境中不对项目进行整体打包。<br>
原因：当我们的构建的项目越来越庞大时，对整个项目进行资源整合的时间会变长，如果有数千个模块的项目在进行构建时甚至需要几分钟才能启动开发服务器。所以vite解决了在开发过程中需要等待整个项目打包这一段过程，让开发时更加丝滑。<br>
依赖：使用esbuild（GO编写）预构建依赖，比 JavaScript 编写的打包器预构建依赖快 10-100 倍。<br>
源码：在浏览器请求资源时-&gt; vite转换一些非js文件-&gt;动态导入代码。<br>
源码利用浏览器的协商缓存（304 Not Modified），依赖模块请求则会通过 Cache-Control: max-age=31536000, immutable 进行强缓存，保持热更新的速度。<br>
<img data-src="image-20220707230212662.png" alt=""></p>
<h4 id="如何选择适合的构建工具？">如何选择适合的构建工具？</h4>
<p>Grunt对于一些中小型项目而言更加轻便和灵活，如果只针对代码压缩合并，Grunt就可以满足要求，发展历程长，基本是稳定的。但是如果要处理庞大的项目文件，特别是处理多种类型的资源文件，强调模块开发，Webpack则更适合这个场景。Webpack对于中大型项目而言是更加稳定的，文档资料和迭代速度也很快。当然这对开发人员而言也是挺头疼的，隔一段时间就需要去适应文档的配置。Vite作为一门新的构建技术，想要它去构建一门稳定的中大型项目有点冒险，虽然已经发布稳定版本，但是还是会有一些潜在的风险，等它更多人推广后使用更加稳妥，但是对于平时构建一些个人网站和项目等使用vite，感受一下它的便捷也可以。</p>
<h4 id="什么是webpack">什么是webpack</h4>
<p>webpack是一种前端资源构建工具，一个静态模块打包器(module bundler)。 在 webpack看来,前端的所有资源文件(js/json/css/img/less/…)都会作为模块处理。 它将根据模块的依赖关系进行静态分析，打包生成对应的静态资源(bundle)。</p>
<p><img data-src="image-20220707224530157.png" alt=""></p>
<h4 id="理解module、chunk、bundle">理解module、chunk、bundle</h4>
<p>在 webpack 中，一切皆module，任何一个文件都可以看成是module。js、css、图片等都是module<br>
webpack 会将入口文件以及它的依赖引入到一个 chunk 中，然后进过一系列处理打包成bundle</p>
<p><img data-src="image-20220707230231353.png" alt=""></p>
<p>大致流程如下：</p>
<p>1、根据index.js入口文件依赖关系生成树状图</p>
<p>2、根据树状图引入相关的资源 生成chunk(块)</p>
<p>3、对chunk进行处理 (babel、less-loader …)</p>
<p>4、打包生成bundler.js</p>
<p>5、将bundler.js文件引入到index.html中</p>
<h4 id="webpack五个核心概念">webpack五个核心概念</h4>
<h5 id="Entry">Entry</h5>
<p>入口（Entry）：指示 webpack以哪个文件为入口起点开始打包，分析构建内部依赖图。其取值可以是字符串，数组或者一个对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 单入口单文件</span><br><span class="line">entry: &quot;./src/index.js&quot;</span><br><span class="line"></span><br><span class="line">// 单入口多文件</span><br><span class="line">entry: [&quot;./ src/index.js&quot;, &quot;./src/common.js&quot;] // 若index.js与common.js没有依赖关系，可以通过此方式将它们打包在一起</span><br><span class="line"></span><br><span class="line">// 多入口</span><br><span class="line">entry: &#123;</span><br><span class="line">  page1: &quot;./src/page1.js&quot;,</span><br><span class="line">  page2: &quot;./src/page2.js&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Output">Output</h5>
<p>输出（Output）：指示 webpack打包后的资源 bundles输出到哪里去，以及如何命名</p>
<p>webpack打包的输出，常用配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, &quot;./dist&quot;),</span><br><span class="line">  // 单入口时（默认）</span><br><span class="line">  // filename: &quot;main.js&quot;,</span><br><span class="line">  // filename: &quot;js/main.js&quot;, // filename也可以写路径，表示输出到 dist/js 目录下</span><br><span class="line">  // 多入口时，由于会有多个输出，因此文件名不能写死</span><br><span class="line">  filename: &quot;[name].js&quot;, // name表示chunk的名称，此处为entry中的key值</span><br><span class="line">  chunkFilename: &quot;[name].js&quot;, // 按需加载的模块打包后的名称</span><br><span class="line">  publicPath: &quot;/&quot; // 项目部署在服务器上的路径，如果在根路径则为 /</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Loader">Loader</h5>
<p>处理器（Loader）：webpack默认只能处理js、json格式的文件，而loader的作用则是将其他格式的文件，转换成webpack能够处理的文件</p>
<p>使用loader需要在webpack配置文件的module.rules中配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: ...,</span><br><span class="line"> output: ...,</span><br><span class="line"> module: &#123;</span><br><span class="line">   noParse:  /node_modules/, //忽略解析 node_modules 中的文件</span><br><span class="line">   rules: [</span><br><span class="line">     &#123;</span><br><span class="line">       test: /\.xxx$/, // 匹配后缀名为xxx的文件</span><br><span class="line">       // 单个loader</span><br><span class="line">       // loader: &quot;xxx-loader&quot;,</span><br><span class="line">       // options: &#123;&#125;,</span><br><span class="line">       // 多个loader，loader的处理顺序为从后往前，因此需要优先处理的loader放在数组最后面</span><br><span class="line">       // use: [&quot;xxxx-loader&quot;, &quot;xxx-loader&quot;],</span><br><span class="line">       //  如果某个loader需要配置，写成下面的格式</span><br><span class="line">       use: [</span><br><span class="line">         &#123;</span><br><span class="line">           loader: &quot;xxxx-loader&quot;,</span><br><span class="line">           options: &#123;&#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         &quot;xxx-loader&quot;</span><br><span class="line">       ],</span><br><span class="line">       include: [path.resolve(__dirname, &quot;./src&quot;)], // 只解析src中的文件，可以是正则</span><br><span class="line">       exclude: [path.resolve(__dirname, &quot;./library&quot;)], // 忽略library中的文件，可以是正则</span><br><span class="line">       // 当多个规则同时匹配某类文件时，可以使用enforce参数指定优先级</span><br><span class="line">       enforce: &quot;pre&quot; // 优先执行该规则里的loader，post 最后执行该规则里的loader</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       // 当规则匹配时，不再匹配后面的规则。例如某个文件匹配到了第一个规则，不再匹配后面规则</span><br><span class="line">       oneOf: [</span><br><span class="line">         &#123;</span><br><span class="line">           test: /\.xxx$/,</span><br><span class="line">           use: &quot;xxx-loader&quot;</span><br><span class="line">         &#125;, </span><br><span class="line">         &#123;</span><br><span class="line">           test: /\.xxx$/,</span><br><span class="line">           use: &quot;xxx-loader&quot;</span><br><span class="line">         &#125;</span><br><span class="line">       ] </span><br><span class="line">     &#125;</span><br><span class="line">   ]</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Plugins">Plugins</h5>
<p>插件(Plugins)可以用于执行范围更广的任务，它能处理loader无法处理的事情。插件的范围包括，从打包优化和压缩， 一直到重新定义环境中的变量等。</p>
<p>它使用非常简单，在plugins数组中添加插件的实例化对象即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const xxxWebpackPlugin = require(&quot;xxx-webpack-plugin&quot;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  entry: ...,</span><br><span class="line">  output: ...,</span><br><span class="line">  plugins: [</span><br><span class="line">    new xxxWebpackPlugin(),</span><br><span class="line">    new xxxxWebpackPlugin(&#123;</span><br><span class="line">      // 插件的配置项</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="mode">mode</h5>
<p>webpack打包分为两种模式，开发模式（development）与生产模式（production），默认为生产模式</p>
<table>
<thead>
<tr>
<th style="text-align:center">选项</th>
<th style="text-align:left">描述</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">development</td>
<td style="text-align:left">会将 process.env.NODE_ENV 的值设为 development。启用 NamedChunksPlugin 和 NamedModulesPlugin。</td>
<td>能让代码本地调试 运行的环境</td>
</tr>
<tr>
<td style="text-align:center">production</td>
<td style="text-align:left">会将 process.env.NODE_ENV 的值设为 production。启用 FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 UglifyJsPlugin.</td>
<td>能让代码优化上线 运行的环境</td>
</tr>
</tbody>
</table>
<p>Mode的配置更多含义</p>
<p><img data-src="image-20220712165237536.png" alt=""></p>
<p><img data-src="image-20220712165249707.png" alt=""></p>
<h4 id="webpack使用前提">webpack使用前提</h4>
<p>webpack的官方文档是 <a target="_blank" rel="noopener" href="https://webpack.js.org/">https://webpack.js.org/</a></p>
<p>webpack的中文官方文档是 <a target="_blank" rel="noopener" href="https://webpack.docschina.org/">https://webpack.docschina.org/</a></p>
<p>DOCUMENTATION：文档详情，也是我们最关注的</p>
<p>Webpack的运行是依赖Node环境的，所以我们电脑上必须有Node环境</p>
<p>所以我们需要先安装Node.js，并且同时会安装npm；</p>
<p>我当前电脑上的node版本是v14.15.5，npm版本是6.14.11（你也可以使用nvm或者n来管理Node版本）；</p>
<p>Node官方网站：<a target="_blank" rel="noopener" href="https://nodejs.org/">https://nodejs.org/</a></p>
<p><img data-src="image-20220707231535073.png" alt=""></p>
<h4 id="webpack安装">webpack安装</h4>
<p>webpack的安装目前分为两个：webpack、webpack-cli</p>
<p><strong>那么它们是什么关系呢？</strong></p>
<p>执行webpack命令，会执行node_modules下的.bin目录下的webpack；</p>
<p>webpack在执行时是依赖webpack-cli的，如果没有安装就会报错；</p>
<p>而webpack-cli中代码执行时，才是真正利用webpack进行编译和打包的过程；</p>
<p>所以在安装webpack时，我们需要同时安装webpack-cli（第三方的脚手架事实上是没有使用webpack-cli的，而是类似于自 己的 vue-service-cli 的东西）</p>
<p><img data-src="image-20220707231754415.png" alt=""></p>
<p>全局安装：<code>npm install webpack webpack-cli –g</code></p>
<p>局部安装：<code>npm install webpack webpack-cli –D</code></p>
<h4 id="webpack的默认打包">webpack的默认打包</h4>
<p>我们可以通过webpack进行打包，之后运行打包之后的代码</p>
<p>在目录下直接执行 webpack 命令：<code>webpack</code></p>
<p>生成一个dist文件夹，里面存放一个main.js的文件，就是我们打包之后的文件：</p>
<p>这个文件中的代码被压缩和丑化了；</p>
<p>另外我们发现代码中依然存在ES6的语法，比如箭头函数、const等，这是因为默认情况下webpack并不清楚我们打包后的文 件是否需要转成ES5之前的语法，后续我们需要通过babel来进行转换和设置；</p>
<p>我们发现是可以正常进行打包的，但是有一个问题，webpack是如何确定我们的入口的呢？</p>
<p>事实上，当我们运行webpack时，webpack会查找当前目录下的 src/index.js作为入口；</p>
<p>所以，如果当前项目中没有存在src/index.js文件，那么会报错；</p>
<p>当然，我们也可以通过配置来指定入口和出口</p>
<p>开发环境指令：</p>
<p><code>webpack src/js/index.js -o build/js/built.js --mode=development</code></p>
<p>功能：webpack能够编译打包 js和 json文件，并且能将 es6的模块化语法转换成 浏览器能识别的语法。</p>
<p><code>webpack --entry ./src/main.js --output-path ./build/js/bundle.js --mode=development</code></p>
<p>生产环境指令：</p>
<p><code>webpack src/js/index.js -o build/js/built.js --mode=production</code></p>
<p>功能：在开发配置功能上多一个功能，压缩代码。</p>
<p><code>webpack --entry ./src/main.js --output-path ./build/js/bundle.js --mode=production</code></p>
<h5 id="配置script脚本">配置script脚本</h5>
<p>在package.json，script字段下配置脚本，执行命令更为简便：npm run 脚本名</p>
<p>结论 ：</p>
<ul>
<li>webpack能够编译打包 js和 json文件。</li>
<li>能将 es6的模块化语法转换成浏览器能识别的语法。</li>
<li>能压缩代码。</li>
</ul>
<p>问题 ：</p>
<ul>
<li>不能编译打包 css、img等文件。</li>
<li>不能将 js的 es6基本语法转化为 es5以下语法。</li>
<li>在通常情况下，webpack需要打包的项目是非常复杂的，并且我们需要一系列的配置来满足要求，默认配置必然</li>
</ul>
<p>是不可以的。</p>
<h4 id="webpack开发环境配置">webpack开发环境配置</h4>
<h5 id="创建配置文件">创建配置文件</h5>
<p>在项目根目录下创建文件 webpack.config.js，来作为webpack的配置文件，名字默认，如果要修改，执行时需要添加 --config 配置文件名来读取该配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>); <span class="comment">// node 内置核心模块，用来处理路径问题</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">	<span class="attr">entry</span>: <span class="string">&#x27;./src/js/index.js&#x27;</span>, <span class="comment">// 入口文件</span></span><br><span class="line">	<span class="attr">output</span>: &#123; <span class="comment">// 输出配置</span></span><br><span class="line">		<span class="attr">filename</span>: <span class="string">&#x27;./bundle.js&#x27;</span>, <span class="comment">// 输出文件名</span></span><br><span class="line">		<span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build/js&#x27;</span>) <span class="comment">// 输出文件路径配置</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span> <span class="comment">//开发环境</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="打包样式资源">打包样式资源</h5>
<p>1、准备css、less资源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个元素</span><br><span class="line">let div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">div.className = &#x27;dv&#x27;</span><br><span class="line">div.style.width = &#x27;100px&#x27;</span><br><span class="line">div.style.height = &#x27;100px&#x27;</span><br><span class="line">div.innerHTML = &#x27;把酒祝东风，且共从容&#x27;</span><br><span class="line"></span><br><span class="line">document.body.appendChild(div)</span><br><span class="line"></span><br><span class="line">.dv &#123;</span><br><span class="line">  background-color:tomato;</span><br><span class="line">  /* 页面文字不让选中 */</span><br><span class="line">  user-select: none;</span><br><span class="line">&#125;</span><br><span class="line">执行编译发现报错: 模块解析失败，你需要一个合适的loader来处理这个文件类型</span><br><span class="line"></span><br><span class="line">上面的错误信息告诉我们需要一个loader来加载这个css文件，但是loader是什么呢？</span><br><span class="line">loader 可以用于对模块的源代码进行转换；</span><br><span class="line">我们可以将css文件也看成是一个模块，我们是通过import来加载这个模块的；</span><br><span class="line">在加载这个模块时，webpack其实并不知道如何对其进行加载，我们必须制定对应的loader来完成这个功能；</span><br><span class="line">那么我们需要一个什么样的loader呢？</span><br><span class="line">对于加载css文件来说，我们需要一个可以读取css文件的loader；</span><br><span class="line">这个loader最常用的是css-loader</span><br></pre></td></tr></table></figure>
<p>2、下载安装 loader 包 <code>npm i css-loader  -D</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如何使用这个loader来加载css文件呢？有三种方式：</span><br><span class="line">	- 内联方式；</span><br><span class="line">	- CLI方式（webpack5中不再使用）；</span><br><span class="line">	- 配置方式；</span><br><span class="line">内联方式：内联方式使用较少，因为不方便管理；</span><br><span class="line">	- 在引入的样式前加上使用的loader，并且使用!分割: import &#x27;css-loader!./js/a.css&#x27;</span><br><span class="line">CLI方式（webpack5中不再使用）这里不展开说</span><br></pre></td></tr></table></figure>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resolve 用来拼接绝对路径的方法</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// webpack 配置</span></span><br><span class="line">  <span class="comment">// 入口起点</span></span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="comment">// 输出</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// 输出文件名</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">    <span class="comment">// 输出路径</span></span><br><span class="line">    <span class="comment">// __dirname nodejs 的变量，代表当前文件的目录绝对路径</span></span><br><span class="line">    <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// loader 的配置</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">	<span class="comment">// module.rules中允许我们配置多个loader（因为我们也会继续使用其他的loader，来完成其他文件的加载）</span></span><br><span class="line">    <span class="comment">// 这种方式可以更好的表示loader的配置，也方便后期的维护，同时也让你对各个Loader有一个全局的概览</span></span><br><span class="line">    <span class="comment">// rules属性对应的值是一个数组 数组中存放的是一个个的Rule，Rule是一个对象，对象中可以设置多个属性</span></span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      <span class="comment">// 详细 loader 配置</span></span><br><span class="line">      <span class="comment">// 不同文件必须配置不同 loader 处理</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 用于对 resource（资源）进行匹配的，通常会设置成正则表达式</span></span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="comment">// 对应的值时一个数组 表示使用哪些 loader 进行处理</span></span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          <span class="comment">// use 数组中 loader 执行顺序：从右到左，从下到上 依次执行</span></span><br><span class="line">          <span class="comment">// 创建 style 标签，将 js 中的样式资源插入进行，添加到 head 中生效</span></span><br><span class="line">          <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">          <span class="comment">// 将 css 文件变成 commonjs 模块加载 js 中，里面内容是样式字符串</span></span><br><span class="line">          <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="comment">// use属性：对应的值时一个数组：[UseEntry]</span></span><br><span class="line">		<span class="comment">// UseEntry是一个对象，可以通过对象的属性来设置一些其他属性</span></span><br><span class="line">		<span class="comment">// loader：必须有一个 loader属性，对应的值是一个字符串；</span></span><br><span class="line">		<span class="comment">// options：可选的属性，值是一个字符串或者对象，值会被传入到loader中；</span></span><br><span class="line">		<span class="comment">// query：目前已经使用options来替代；</span></span><br><span class="line">		<span class="comment">// 传递字符串（如：use: [ &#x27;style-loader&#x27; ]）是 loader 属性的简写方式（如：use: [ &#123; loader: &#x27;style-loader&#x27;&#125; ]）；</span></span><br><span class="line">		<span class="comment">// loader属性： Rule.use: [ &#123; loader &#125; ] 的简写。</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 模式</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>, <span class="comment">// 开发模式</span></span><br><span class="line">  <span class="comment">// mode: &#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、运行指令：webpack 或 自定义脚本 npm run build</p>
<h5 id="style-loader">style-loader</h5>
<p>我们已经可以通过css-loader来加载css文件了</p>
<p>但是你会发现这个css在我们的代码中并没有生效（页面没有效果）。</p>
<p>这是为什么呢？</p>
<p>因为css-loader只是负责将.css文件进行解析，并不会将解析之后的css插入到页面中；</p>
<p>如果我们希望再完成插入style的操作，那么我们还需要另外一个loader，就是style-loader；</p>
<p>安装style-loader：<code>npm install style-loader -D</code></p>
<p>那么我们应该如何使用style-loader：</p>
<p>在配置文件中，添加style-loader，具体看上面代码</p>
<p>注意：因为loader的执行顺序是从右向左（或者说从下到上，或者说从后到前的），所以我们需要将style- loader写到css-loader的前面；</p>
<p>ps：当前目前我们的css是通过页内样式的方式添加进来的；</p>
<p>​		后续我们也会讲如何将css抽取到单独的文件中，并且进行压缩等操作</p>
<h5 id="less-loader">less-loader</h5>
<p>在我们开发中，我们可能会使用less、sass、stylus的预处理器来编写css样式，效率会更高。</p>
<p>那么，如何可以让我们的环境支持这些预处理器呢？</p>
<p>首先我们需要确定，less、sass等编写的css需要通过工具转换成普通的css；</p>
<p>比如我们编写如下的less样式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@fsz:20px;</span><br><span class="line">@fsw:&#x27;bold&#x27;;</span><br><span class="line"></span><br><span class="line">.dv &#123;</span><br><span class="line">  font-size: @fsz;</span><br><span class="line">  font-weight: @fsw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以使用less工具来完成它的编译转换：<code>npm install less -D</code></p>
<p>执行如下命令：<code>npx lessc ./src/css/title.less title.css</code></p>
<p>但是在项目中我们会编写大量的css，它们如何可以自动转换呢？</p>
<p>这个时候我们就可以使用less-loader，来自动使用less工具转换less到css；</p>
<p>此时我们需要配置webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	test: /\.less$/,</span><br><span class="line">	use: [</span><br><span class="line">		&#x27;style-loader&#x27;,</span><br><span class="line">		&#x27;css-loader&#x27;,</span><br><span class="line">		// 将 less 文件编译成 css 文件</span><br><span class="line">		// 需要下载 less-loader 和 less</span><br><span class="line">		&#x27;less-loader&#x27;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行npm run build，less就可以自动转换成css，并且页面也会生效了</p>
<h5 id="PostCss">PostCss</h5>
<p>什么是PostCSS呢？</p>
<p>PostCSS是一个通过JavaScript来转换样式的工具；</p>
<p>这个工具可以帮助我们进行一些CSS的转换和适配，比如自动添加浏览器前缀、css样式的重置；</p>
<p>但是实现这些功能，我们需要借助于PostCSS对应的插件；</p>
<p>如何使用PostCSS呢？主要就是两个步骤：</p>
<p>第一步：查找PostCSS在构建工具中的扩展，比如webpack中的postcss-loader；</p>
<p>第二步：选择可以添加你需要的PostCSS相关的插件；</p>
<p>当然，我们能不能也直接在终端使用PostCSS呢？</p>
<p>也是可以的，但是我们需要单独安装一个工具postcss-cli；</p>
<p>我们可以安装一下它们：postcss、postcss-cli</p>
<p><code>npm install postcss postcss-cli -D</code></p>
<p>我们编写一个需要添加前缀的css：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.dv &#123;</span><br><span class="line">  /* 页面文字不让选中 */</span><br><span class="line">  user-select: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="autoprefixer"><strong>autoprefixer</strong></h6>
<p>因为我们需要添加前缀，所以要安装autoprefixer：</p>
<p><code>npm install autoprefixer -D</code></p>
<p>直接使用使用postcss工具，并且制定使用autoprefixer</p>
<p><code>npx postcss --use autoprefixer -o end.css ./src/css/style.css</code></p>
<h6 id="postcss-loader"><strong>postcss-loader</strong></h6>
<p>真实开发中我们必然不会直接使用命令行工具来对css进行处理，而是可以借助于构建工具：</p>
<p>在webpack中使用postcss就是使用postcss-loader来处理的；</p>
<p>我们来安装postcss-loader：</p>
<p><code>npm install postcss-loader -D</code></p>
<p>我们修改加载css的loader：（配置文件已经过多，给出一部分了）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  loader: &quot;postcss-loader&quot;,</span><br><span class="line">  options: &#123;</span><br><span class="line">  postcssOptions: &#123;</span><br><span class="line">  // 使用插件 </span><br><span class="line">  // ps:因为postcss需要有对应的插件才会起效果，所以我们需要配置它的plugin；</span><br><span class="line">  plugins: [</span><br><span class="line">  // 引入插件</span><br><span class="line">    require(&#x27;autoprefixer&#x27;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，我们也可以将这些配置信息放到一个单独的文件中进行管理：</p>
<p>在根目录下创建postcss.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    require(&#x27;autoprefixer&#x27;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="postcss-preset-env"><strong>postcss-preset-env</strong></h6>
<p>事实上，在配置postcss-loader时，我们配置插件并不需要使用autoprefixer。</p>
<p>我们可以使用另外一个插件：postcss-preset-env</p>
<p>postcss-preset-env也是一个postcss的插件；</p>
<p>它可以帮助我们将一些现代的CSS特性，转成大多数浏览器认识的CSS，并且会根据目标浏览器或者运行时环境 添加所需的polyfill；</p>
<p>也包括会自动帮助我们添加autoprefixer（所以相当于已经内置了autoprefixer）；</p>
<p>首先，我们需要安装postcss-preset-env：</p>
<p><code>npm install postcss-preset-env -D</code></p>
<p>之后，我们直接修改掉之前的autoprefixer即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  loader: &quot;postcss-loader&quot;,</span><br><span class="line">  options: &#123;</span><br><span class="line">  postcssOptions: &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    require(&#x27;postcss-preset-env&#x27;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="打包HTML资源">打包HTML资源</h5>
<h6 id="HtmlWebpackPlugin"><strong>HtmlWebpackPlugin</strong></h6>
<p>另外还有一个<strong>不太规范</strong>的地方：</p>
<p>我们的HTML文件是编写在根目录下的，而最终打包的dist文件夹中是没有index.html文件的。</p>
<p>在进行项目部署的时，必然也是需要有对应的入口文件index.html；</p>
<p>所以我们也需要对index.html进行打包处理；</p>
<p>对HTML进行打包处理我们可以使用另外一个插件：<strong>HtmlWebpackPlugin</strong>；</p>
<p>1、创建html页面</p>
<p>2、下载安装 plugin 包：npm install -D html-webpack-plugin</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="comment">// html-webpack-plugin</span></span><br><span class="line">    <span class="comment">//功能：默认会创建一个空的 HTML，自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">    <span class="comment">//需求：需要有结构的 HTML文件</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">//复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="打包图片资源">打包图片资源</h5>
<h6 id="file-loader">file-loader</h6>
<blockquote>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c0de85a2d3fb">https://www.jianshu.com/p/c0de85a2d3fb</a></p>
</blockquote>
<p>1、创建图片资源</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">方式一:</span><br><span class="line"><span class="keyword">let</span> dv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">dv.<span class="property">className</span> = <span class="string">&#x27;box&#x27;</span></span><br><span class="line">dv.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line">dv.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(dv)</span><br><span class="line"></span><br><span class="line">.<span class="property">box</span> &#123;</span><br><span class="line">  background-<span class="attr">image</span>: <span class="title function_">url</span>(<span class="string">&#x27;../imgs/2.jpg&#x27;</span>);</span><br><span class="line">  background-<span class="attr">repeat</span>: no-repeat;</span><br><span class="line">  background-<span class="attr">size</span>: contain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">方式二:</span><br><span class="line"><span class="keyword">import</span> imgUrl <span class="keyword">from</span> <span class="string">&#x27;./imgs/1.png&#x27;</span></span><br><span class="line"><span class="keyword">let</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line"><span class="comment">// img.src = &#x27;./imgs/1.png&#x27;</span></span><br><span class="line">img.<span class="property">src</span> = imgUrl</span><br><span class="line">img.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line">img.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(img)</span><br></pre></td></tr></table></figure>
<p>2、下载安装 loader 包 npm install --save-dev file-loader</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;imgs/[name]-[hash:5].[ext]&#x27;</span></span><br><span class="line">            <span class="comment">// outputPath: imgs</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;javascript/auto&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>文件命名规则</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">有时候我们处理后的文件名称按照一定的规则进行显示：</span><br><span class="line">比如保留原来的文件名、扩展名，同时为了防止重复，包含一个hash值等；</span><br><span class="line">这个时候我们可以使用PlaceHolders来完成，webpack给我们提供了大量的PlaceHolders来显示不同的内容：</span><br><span class="line">https://webpack.js.org/loaders/file-loader/#placeholders</span><br><span class="line">我们可以在文档中查阅自己需要的placeholder；</span><br><span class="line">我们这里介绍几个最常用的placeholder：</span><br><span class="line">[ext]： 处理文件的扩展名；</span><br><span class="line">[name]：处理文件的名称；</span><br><span class="line">[hash]：文件的内容，使用MD4的散列函数处理，生成的一个128位的hash值（32个十六进制）；</span><br><span class="line">[contentHash]：在file-loader中和[hash]结果是一致的（在webpack的一些其他地方不一样，后面会讲到）；</span><br><span class="line">[hash:&lt;length&gt;]：截图hash的长度，默认32个字符太长了；</span><br><span class="line">[path]：文件相对于webpack配置文件的路径；</span><br></pre></td></tr></table></figure>
<h6 id="url-loader">url-loader</h6>
<p><strong>url-loader</strong>和<strong>file-loader</strong>的工作方式是相似的，但是可以将较小的文件，转成base64的URI</p>
<p>安装：<code>npm install url-loader -D</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">    <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;[name]-[hash:5].[ext]&#x27;</span>,</span><br><span class="line">            <span class="attr">outputPath</span>: <span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">            <span class="attr">limit</span>: <span class="number">20</span> * <span class="number">1024</span></span><br><span class="line">          &#125;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>显示结果是一样的，并且图片可以正常显示；</strong></p>
<p>但是在dist文件夹中，我们会看不到图片文件：</p>
<p>因为默认情况下url-loader会将所有的图片文件转成base64编码</p>
<p>但是开发中我们往往是小的图片需要转换，但是大的图片直接使用图片即可</p>
<p>这是因为小的图片转换base64之后可以和页面一起被请求，减少不必要的请求过程；</p>
<p>而大的图片也进行转换，反而会影响页面的请求速度；</p>
<p>那么，我们如何可以<strong>限制哪些大小的图片转换和不转换</strong>呢？</p>
<p>url-loader有一个options属性<strong>limit</strong>，可以用于设置转换的限制；</p>
<blockquote>
<p>url-loader在webpack5中已废弃</p>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36e972b19b28">https://</a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36e972b19b28">www.jianshu.com</a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36e972b19b28">/p/</a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36e972b19b28">36e972b19b28</a></p>
</blockquote>
<h6 id="html-loader">html-loader</h6>
<p>在html中引入一张图片，npm run build后发现该图片无法打包</p>
<p>解决方式：</p>
<p>安装html-loader <code>npm i html-loader -D</code></p>
<p>修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 处理html中的图片</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="attr">test</span>: <span class="regexp">/\.(html|htm)$/</span>,</span><br><span class="line">   <span class="comment">// 处理html文件的img图片(负责引入img, 从而能被url-loader进行处理)</span></span><br><span class="line">   <span class="attr">loader</span>: <span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="打包其它资源">打包其它资源</h5>
<p>1、引入字体图标</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> elI = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">elI.<span class="property">className</span> = <span class="string">&#x27;icomoon icon-heart&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(elI)</span><br></pre></td></tr></table></figure>
<p>2、下载 file-loader ：<code>npm i file-loader -D</code></p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增规则 =&gt; 打包其他资源(除了 html/js/css资源以外的资源)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">//排除 css/js/html资源</span></span><br><span class="line">   <span class="attr">exclude</span>: <span class="regexp">/\.(css|js|html|less)$/</span>,</span><br><span class="line">   <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">   <span class="attr">options</span>: &#123;</span><br><span class="line">   <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;fonts/[hash:10].[ext]&#x27;</span></span><br><span class="line"> &#125;,</span><br><span class="line">   <span class="attr">type</span>: <span class="string">&#x27;javascript/auto&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h4 id="asset-module-type"><strong>asset</strong> <strong>module</strong> <strong>type</strong></h4>
<p>我们当前使用的webpack版本是webpack5：</p>
<p>在webpack5之前，加载这些资源我们需要使用一些loader，比如raw-loader 、url-loader、file-loader；</p>
<p>在webpack5开始，我们可以直接使用资源模块类型（<strong>asset</strong> <strong>module</strong> <strong>type</strong>），来替代上面的这些loader；</p>
<p><strong>资源模块类型</strong>(<strong>asset</strong> <strong>module</strong> <strong>type)</strong>，通过添加 4 种新的模块类型，来替换所有这些 loader：</p>
<p><strong>asset/resource</strong> 发送一个单独的文件并导出 URL。之前通过使用 file-loader 实现；</p>
<p><strong>asset/inline</strong> 导出一个资源的 data URI。之前通过使用 url-loader 实现；</p>
<p><strong>asset/source</strong> 导出资源的源代码。之前通过使用 raw-loader 实现；</p>
<p><strong>asset</strong> 在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过 url-loader + limit 配置资源体积限制实现；</p>
<p><strong>比如打包图片：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;asset&#x27;</span>,</span><br><span class="line">    <span class="comment">// 生成器</span></span><br><span class="line">    <span class="attr">generator</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:5][ext]&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 解析</span></span><br><span class="line">  <span class="attr">parser</span>: &#123;</span><br><span class="line">    <span class="comment">// 条件</span></span><br><span class="line">    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">      <span class="comment">// 小于20kb的图片都转成base64位</span></span><br><span class="line">      <span class="attr">maxSize</span>: <span class="number">20</span> * <span class="number">1024</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><strong>转base64</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">因为不生成文件，所以没有generator属性</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">	<span class="attr">type</span>: <span class="string">&#x27;asset/inline&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>比如打包字体：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(woff2?|eot|ttf)$/</span>,</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">  <span class="attr">generator</span>: &#123;</span><br><span class="line">     <span class="attr">filename</span>: <span class="string">&#x27;font/[name].[ext]&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Plugins-2">Plugins</h4>
<p><strong>Webpack</strong>的另一个核心是Plugin，官方有这样一段对Plugin的描述：</p>
<p>While loaders are used to transform certain types of modules, plugins can be leveraged to perform a  wider range of tasks like bundle optimization, asset management and injection of environment variables.</p>
<p>上面表达的含义翻译过来就是：</p>
<p>Loader是用于特定的模块类型进行转换；</p>
<p>Plugin可以用于执行更加广泛的任务，比如打包优化、资源管理、环境变量注入等</p>
<p><img data-src="image-20220712163127495.png" alt=""></p>
<h5 id="CleanWebpackPlugin"><strong>CleanWebpackPlugin</strong></h5>
<p>前面我们演示的过程中，每次修改了一些配置，重新打包时，都需要手动删除build文件夹：</p>
<p>我们可以借助于一个插件来帮助我们完成，这个插件就是CleanWebpackPlugin；</p>
<p>首先，我们先安装这个插件：</p>
<p><code>npm install clean-webpack-plugin -D</code></p>
<p>修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>()</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="HtmlWebpackPlugin-2"><strong>HtmlWebpackPlugin</strong></h5>
<p>对HTML进行打包处理我们可以使用另外一个插件：<strong>HtmlWebpackPlugin</strong>；</p>
<p>1、创建html页面</p>
<p>2、下载安装 plugin 包：npm install -D html-webpack-plugin</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="comment">// html-webpack-plugin</span></span><br><span class="line">    <span class="comment">//功能：默认会创建一个空的 HTML，自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">    <span class="comment">//需求：需要有结构的 HTML文件</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">//复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>自定义html模板</strong></p>
<p><strong>如果我们想在自己的模块中加入一些比较特别的内容：</strong></p>
<p>比如添加一个noscript标签，在用户的JavaScript被关闭时，给予响应的提示；</p>
<p>比如在开发vue或者react项目时，我们需要一个可以挂载后续组件的根标签 ；</p>
<p>我们需要一个属于自己的模板</p>
<p>我们选择复制vue的index.html作为模板</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>We&#x27;re sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面的代码中，会有一些类似这样的语法&lt;%= 变量 %&gt;，这个是EJS模块填充数据的方式。</p>
<p>在配置HtmlWebpackPlugin时，我们可以添加如下配置：</p>
<p>template：指定我们要使用的模块所在的路径；</p>
<p>title：在进行htmlWebpackPlugin.options.title读取时，就会读到该信息；</p>
<p>但是，这个时候编译还是会报错，因为在我们的模块中还使用到一个<strong>BASE_URL</strong>的常量：</p>
<p><img data-src="image-20220712164729873.png" alt=""></p>
<p>这是因为在编译template模块时，有一个BASE_URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;icon&quot; href=&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>但是我们并没有设置过这个常量值，所以会出现没有定义的错误；</p>
<p>这个时候我们可以使用DefinePlugin插件</p>
<h5 id="DefinePlugin"><strong>DefinePlugin</strong></h5>
<p>DefinePlugin允许在编译时创建配置的全局常量，是一个webpack内置的插件（不需要单独安装）：</p>
<p><img data-src="image-20220712164815568.png" alt=""></p>
<p>这个时候，编译template就可以正确的编译了，会读取到BASE_URL的值</p>
<h5 id="CopyWebpackPlugin"><strong>CopyWebpackPlugin</strong></h5>
<p>在vue的打包过程中，如果我们将一些文件放到public的目录下，那么这个目录会被复制到dist文件夹中。</p>
<p>这个复制的功能，我们可以使用CopyWebpackPlugin来完成；</p>
<p>安装CopyWebpackPlugin插件：</p>
<p><code>npm install copy-webpack-plugin -D</code></p>
<p><strong>接下来配置CopyWebpackPlugin即可：</strong></p>
<p>复制的规则在patterns中设置；</p>
<p>**from：**设置从哪一个源中开始复制；</p>
<p>**to：**复制到的位置，可以省略，会默认复制到打包的目录下；</p>
<p>**globOptions：**设置一些额外的选项，其中可以编写需要忽略的文件：</p>
<p>.DS_Store：mac目录下回自动生成的一个文件；</p>
<p>index.html：也不需要复制，因为我们已经通过HtmlWebpackPlugin完成了index.html的生成；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title function_">copyWebpackPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">patterns</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">from</span>: <span class="string">&#x27;public&#x27;</span>,</span><br><span class="line">      <span class="attr">globOptions</span>: &#123;</span><br><span class="line">        <span class="comment">// 忽略</span></span><br><span class="line">        <span class="attr">ignore</span>: [</span><br><span class="line">          <span class="string">&#x27;**/.DS_Store&#x27;</span></span><br><span class="line">          <span class="string">&#x27;**/index.html&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Babel相关">Babel相关</h4>
<p>事实上，在开发中我们很少直接去接触babel，但是<strong>babel</strong>对于前端开发来说，目前是不可缺少的一部分：</p>
<p>开发中，我们想要使用ES6+的语法，想要使用TypeScript，开发React项目，它们都是离不开Babel的；</p>
<p>所以，学习Babel对于我们理解代码从编写到线上的转变过程至关重要；</p>
<p>那么，<strong>Babel到底是什么呢？</strong></p>
<p>Babel是一个工具链，主要用于旧浏览器或者环境中将ECMAScript 2015+代码转换为向后兼容版本的 JavaScript；</p>
<p>包括：语法转换、源代码转换等；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> num = <span class="number">10</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>].<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>Babel命令行使用</strong></p>
<p>babel本身可以作为<strong>一个独立的工具</strong>（和postcss一样），不和webpack等构建工具配置来单独使用。</p>
<p>如果我们希望在命令行尝试使用babel，需要安装如下库：</p>
<p>@babel/core：babel的核心代码，必须安装；</p>
<p>@babel/cli：可以让我们在命令行使用babel；</p>
<p><code>npm install @babel/cli @babel/core -D</code></p>
<p>使用babel来处理我们的源代码：</p>
<p>src：是源文件的目录；</p>
<p>–out-dir：指定要输出的文件夹dist；</p>
<p><code>npx babel src --out-dir dist</code></p>
<p><strong>插件的使用</strong></p>
<p>比如我们需要转换箭头函数，那么我们就可以使用<strong>箭头函数转换相关的插件</strong></p>
<p><code>npm install @babel/plugin-transform-arrow-functions -D</code></p>
<p><code>npx babel src --out-dir dist --plugins=@babel/plugin-transform-arrow-functions</code></p>
<p>查看转换后的结果：我们会发现 const 并没有转成 var</p>
<p>这是因为 plugin-transform-arrow-functions，并没有提供这样的功能；</p>
<p>我们需要使用 plugin-transform-block-scoping 来完成这样的功能；</p>
<p><code>npm install @babel/plugin-transform-block-scoping -D</code></p>
<p><code>npx babel src --out-dir dist --plugins=@babel/plugin-transform-block-scoping,@babel/plugin-transform-arrow-functions</code></p>
<p><strong>Babe的预设preset</strong></p>
<p>但是如果要转换的内容过多，一个个设置是比较麻烦的，我们可以使用预设（preset）：</p>
<p>后面我们再具体来讲预设代表的含义；</p>
<p>安装@babel/preset-env预设：</p>
<p><code>npm install @babel/preset-env -D</code></p>
<p>执行如下命令：</p>
<p><code>npx babel src --out-dir dist --presets=@babel/preset-env</code></p>
<p><strong>Babel的底层原理</strong></p>
<p>babel是如何做到将我们的一段代码（ES6、TypeScript、React）转成另外一段代码（ES5）的呢？</p>
<p>从一种源代码（原生语言）转换成另一种源代码（目标语言），这是什么的工作呢？</p>
<p>就是<strong>编译器</strong>，事实上我们可以将babel看成就是一个编译器。</p>
<p>Babel编译器的作用就是将我们的源代码，转换成浏览器可以直接识别的另外一段源代码；</p>
<p><strong>Babel也拥有编译器的工作流程：</strong></p>
<ul>
<li>解析阶段（Parsing)</li>
<li>转换阶段（Transformation）</li>
<li>生成阶段（Code Generation）</li>
</ul>
<p>参考：<a href="https://github.com/jamiebuilds/the-super-tiny-compiler">https://github.com/jamiebuilds/the-super-tiny-compiler</a></p>
<p><strong>Babel编译器执行原理</strong></p>
<p><img data-src="image-20220712170658784.png" alt=""></p>
<p>当然，这只是一个简化版的编译器工具流程，在每个阶段又会有自己具体的工作</p>
<p><img data-src="image-20220712170714878.png" alt="image-20220712170714878"></p>
<p><strong>babel-loader</strong></p>
<p>在实际开发中，我们通常会在构建工具中通过配置babel来对其进行使用的，比如在webpack中。</p>
<p>那么我们就需要去安装相关的依赖：</p>
<p>如果之前已经安装了@babel/core，那么这里不需要再次安装；</p>
<p><code>npm install babel-loader @babel/core</code></p>
<p>我们可以设置一个规则，在加载js文件时，使用我们的babel</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/.js$/</span>,</span><br><span class="line">    <span class="attr">use</span>: &#123;</span><br><span class="line">    <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="comment">// 指定使用的插件</span></span><br><span class="line">      <span class="comment">// plugins: [</span></span><br><span class="line">      <span class="comment">//   &quot;@babel/plugin-transform-arrow-functions&quot;,</span></span><br><span class="line">      <span class="comment">//   &quot;@babel/plugin-transform-block-scoping&quot;</span></span><br><span class="line">      <span class="comment">// ]</span></span><br><span class="line">      <span class="comment">// 指定预设环境</span></span><br><span class="line">      <span class="comment">// presets: [</span></span><br><span class="line">      <span class="comment">//   [&quot;@babel/preset-env&quot;]</span></span><br><span class="line">      <span class="comment">// ]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="babel-preset-env">babel/preset-env</h5>
<p>如果我们一个个去安装使用插件，那么需要手动来管理大量的babel插件，我们可以直接给webpack提供一个 preset，webpack会根据我们的预设来加载对应的插件列表，并且将其传递给babel。</p>
<p>比如常见的预设有三个：</p>
<p>env</p>
<p>react</p>
<p>TypeScript</p>
<p>安装preset-env：</p>
<p><code>npm install @babel/preset-env</code></p>
<p>配置文件修改看上面</p>
<h5 id="babel配置文件">babel配置文件</h5>
<p>像之前一样，我们可以将babel的配置信息放到一个独立的文件中，babel给我们提供了两种配置文件的编写：</p>
<p>babel.config.json（或者.js，.cjs，.mjs）文件；</p>
<p>.babelrc.json（或者.babelrc，.js，.cjs，.mjs）文件；</p>
<p>它们两个有什么区别呢？目前很多的项目都采用了多包管理的方式（babel本身、element-plus、umi等）；</p>
<p>.babelrc.json：早期使用较多的配置方式，但是对于配置Monorepos项目是比较麻烦的；</p>
<p>babel.config.js（babel7）：可以直接作用于Monorepos项目的子包，更加推荐；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">presets</span>: [</span><br><span class="line">    <span class="string">&quot;@babel/preset-env&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="corejs">corejs</h5>
<p>js兼容性处理：babel-loader @babel/core</p>
<ul>
<li>
<p>基本js兼容性处理 --&gt; @babel/preset-env</p>
<ul>
<li>问题：只能转换基本语法，如promise高级语法不能转换</li>
</ul>
</li>
<li>
<p>全部js兼容性处理 --&gt; @babel/polyfill</p>
</li>
<li>
<p>问题：我只要解决部分兼容性问题，但是将所有兼容性代码全部引入，体积太大了~</p>
</li>
<li>
<p>需要做兼容性处理的就做：按需加载  --&gt; core-js</p>
<p>配置文件修改</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">    <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">    <span class="attr">presets</span>: [</span><br><span class="line">      [</span><br><span class="line">        <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">// 按需加载</span></span><br><span class="line">          <span class="attr">useBuiltIns</span>: <span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">          <span class="comment">// 指定core-js版本</span></span><br><span class="line">          <span class="attr">corejs</span>: &#123;</span><br><span class="line">            <span class="attr">version</span>: <span class="number">3</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// 指定兼容性做到哪个版本浏览器</span></span><br><span class="line">          <span class="attr">targets</span>: &#123;</span><br><span class="line">            <span class="attr">chrome</span>: <span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">            <span class="attr">firefox</span>: <span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">            <span class="attr">ie</span>: <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">            <span class="attr">safari</span>: <span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">            <span class="attr">edge</span>: <span class="string">&#x27;17&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 开启babel缓存</span></span><br><span class="line">    <span class="attr">cacheDirectory</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="eslint-3">eslint</h5>
<p>我们希望通过eslint对js语法进行检查 目的为了统一编码规范</p>
<p>1、官网查找eslint-loader 发现过期了 官网推荐使用eslint-webpack-plugin<br>
2、找到eslint-webpack-plugin包 提示需要安装eslint包<br>
3、安装完以后 webpack执行命令报错src路径下缺少.eslintrc.js文件(自定义校验规则文件)<br>
4、在src下新增**.eslintrc.js**文件 自定义编码规则 webpack执行检查是否生效</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="string">&quot;env&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;browser&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;es6&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;node&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;eslint:recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;parserOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;ecmaVersion&quot;</span>: <span class="number">2015</span>,</span><br><span class="line">    <span class="string">&quot;sourceType&quot;</span>: <span class="string">&quot;module&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;rules&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 缩进</span></span><br><span class="line">    <span class="string">&quot;indent&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="number">4</span> <span class="comment">//我的是编辑器自动格式化，不是使用tabs，而是四个空格</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;linebreak-style&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="string">&quot;windows&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 引号</span></span><br><span class="line">    <span class="string">&quot;quotes&quot;</span>: [</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;single&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 分号结尾</span></span><br><span class="line">    <span class="string">&quot;semi&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="string">&quot;always&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;no-unused-vars&quot;</span>: [<span class="number">2</span>, &#123;</span><br><span class="line">    <span class="comment">// 允许声明未使用变量</span></span><br><span class="line">    <span class="string">&quot;vars&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">    <span class="comment">// 参数不检查</span></span><br><span class="line">    <span class="string">&quot;args&quot;</span>: <span class="string">&quot;none&quot;</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="comment">// 最大空行100</span></span><br><span class="line">    <span class="string">&quot;no-multiple-empty-lines&quot;</span>: [<span class="number">0</span>, &#123; <span class="string">&quot;max&quot;</span>: <span class="number">100</span> &#125;],</span><br><span class="line">    <span class="string">&quot;no-mixed-spaces-and-tabs&quot;</span>: [<span class="number">0</span>],</span><br><span class="line">    <span class="comment">//不能使用console</span></span><br><span class="line">    <span class="string">&quot;no-console&quot;</span>: <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line">    <span class="comment">//未定义变量不能使用</span></span><br><span class="line">    <span class="string">&quot;no-undef&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="comment">//一行结束后面不要有空格</span></span><br><span class="line">    <span class="string">&quot;no-trailing-spaces&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="comment">//强制驼峰法命名</span></span><br><span class="line">    <span class="string">&quot;camelcase&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="comment">//对象字面量项尾不能有逗号</span></span><br><span class="line">    <span class="string">&quot;comma-dangle&quot;</span>: [<span class="number">2</span>, <span class="string">&quot;never&quot;</span>],</span><br><span class="line">    <span class="comment">//this别名</span></span><br><span class="line">    <span class="string">&quot;consistent-this&quot;</span>: [<span class="number">2</span>, <span class="string">&quot;that&quot;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>5、查找eslint-config-airbnb-base包 提示如果要支持es6以上的语法需要安装eslint-plugin-import和eslint<br>
6、安装完成后 配置package.json文件 继承airbnb-base校验规则<br>
7、执行webpack 检查校验规则是否生效</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">语法检查： eslint-loader  eslint</span><br><span class="line">注意：只检查自己写的源代码，第三方的库是不用检查的</span><br><span class="line">设置检查规则：</span><br><span class="line">package.<span class="property">json</span>中eslintConfig中设置~</span><br><span class="line">  <span class="string">&quot;eslintConfig&quot;</span>: &#123;</span><br><span class="line">     <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">airbnb --&gt; eslint-config-airbnb-base  eslint-plugin-<span class="keyword">import</span> eslint</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">ESLintPlugin</span>(&#123;</span><br><span class="line">    <span class="comment">// 指定eslint检查的路径</span></span><br><span class="line">    <span class="attr">context</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">	fix : <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="Vue源码打包">Vue源码打包</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 入口文件</span></span><br><span class="line"><span class="comment">// runtime + compiler</span></span><br><span class="line"><span class="comment">// runtime-only</span></span><br><span class="line"><span class="comment">// import &#123; createApp &#125; from &#x27;vue/dist/vue.esm-bundler.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./vue/App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./js/a.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">module</span>.<span class="property">hot</span>)&#123;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./js/a.js&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a.js更新了&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const app = createApp(&#123;</span></span><br><span class="line"><span class="comment">//   template: &#x27;#mytemp&#x27;,</span></span><br><span class="line"><span class="comment">//   data()&#123;</span></span><br><span class="line"><span class="comment">//     return &#123;</span></span><br><span class="line"><span class="comment">//       title: &#x27;hello vue3&#x27;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;,</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br><span class="line"><span class="comment">// app.mount(&#x27;#app&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>通过查看我们发现界面上是没有效果的</p>
<p>并且查看运行的控制台，会发现如下的警告信息</p>
<p><img data-src="image-20231212184839838.png" alt="image-20231212184839838"></p>
<h5 id="Vue打包后不同版本解析">Vue打包后不同版本解析</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vue(.runtime).global(.prod).js：</span><br><span class="line">  通过浏览器中的 &lt;script src=&quot;...&quot;&gt; 直接使用</span><br><span class="line">  我们之前通过CDN引入和下载的Vue版本就是这个版本</span><br><span class="line">  会暴露一个全局的Vue来使用</span><br><span class="line"></span><br><span class="line">vue(.runtime).esm-browser(.prod).js：</span><br><span class="line">  用于通过原生 ES 模块导入使用 (在浏览器中通过 &lt;script type=&quot;module&quot;&gt; 来使用)</span><br><span class="line">  </span><br><span class="line">vue(.runtime).esm-bundler.js：</span><br><span class="line">  用于 webpack，rollup 和 parcel 等构建工具</span><br><span class="line">  构建工具中默认是vue.runtime.esm-bundler.js</span><br><span class="line">  如果我们需要解析模板template，那么需要手动指定vue.esm-bundler.js</span><br><span class="line">  </span><br><span class="line">vue.cjs(.prod).js：</span><br><span class="line">  服务器端渲染使用</span><br><span class="line">  通过require()在Node.js中使用</span><br></pre></td></tr></table></figure>
<h5 id="运行时-编译器-vs-仅运行时">运行时+编译器 vs 仅运行时</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在Vue的开发过程中我们有三种方式来编写DOM元素：</span><br><span class="line">方式一：template模板的方式（之前经常使用的方式）</span><br><span class="line">方式二：render函数的方式，使用h函数来编写渲染的内容</span><br><span class="line">方式三：通过.vue文件中的template来编写模板</span><br><span class="line"></span><br><span class="line">它们的模板分别是如何处理的呢？</span><br><span class="line">方式二中的h函数可以直接返回一个虚拟节点，也就是Vnode节点</span><br><span class="line">方式一和方式三的template都需要有特定的代码来对其进行解析</span><br><span class="line">方式三.vue文件中的template可以通过在vue-loader对其进行编译和处理</span><br><span class="line">方式一种的template我们必须要通过源码中一部分代码来进行编译</span><br><span class="line"></span><br><span class="line">所以，Vue在让我们选择版本的时候分为 运行时+编译器 vs 仅运行时</span><br><span class="line">运行时+编译器包含了对template模板的编译代码，更加完整，但是也更大一些</span><br><span class="line">仅运行时没有包含对template版本的编译代码，相对更小一些；</span><br></pre></td></tr></table></figure>
<h5 id="全局标识的配置">全局标识的配置</h5>
<p>我们会发现控制台还有另外的一个警告：</p>
<p><img data-src="image-20231212185339848.png" alt="image-20231212185339848"></p>
<p>在GitHub上的文档中我们可以找到说明：</p>
<p><img data-src="image-20231212185404993.png" alt="image-20231212185404993"></p>
<p>这是两个特性的标识，一个是使用Vue的Options，一个是Production模式下是否支持devtools工具</p>
<p>虽然他们都有默认值，但是强烈建议我们手动对他们进行配置；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">    <span class="attr">BASE_URL</span>: <span class="string">&quot;&#x27;./&#x27;&quot;</span>,</span><br><span class="line">    <span class="comment">// 是否支持OptionsApi</span></span><br><span class="line">    <span class="attr">__VUE_OPTIONS_API__</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 生产环境下是否支持DEVTOOLS</span></span><br><span class="line">    <span class="attr">__VUE_PROD_DEVTOOLS__</span>: <span class="literal">false</span></span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure>
<h5 id="VSCode对SFC文件的支持">VSCode对SFC文件的支持</h5>
<p>真实开发中多数情况下我们都是使用SFC（ single-file components (单文件组件) ）</p>
<p>我们先说一下VSCode对SFC的支持</p>
<p>插件一：Vetur，从Vue2开发就一直在使用的VSCode支持Vue的插件；</p>
<p>插件二：Volar，官方推荐的插件（后续会基于Volar开发官方的VSCode插件）；</p>
<h5 id="编写App-vue代码">编写App.vue代码</h5>
<p>Father.vue</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">:parentMsg</span>=<span class="string">parentMsg</span>&gt;</span><span class="tag">&lt;/<span class="name">Child</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Child</span> <span class="keyword">from</span> <span class="string">&#x27;./Child.vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">components</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Child</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">title</span>: <span class="string">&#x27;我是父组件&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">parentMsg</span>: <span class="string">&#x27;你站在这里别动 我去买几个橘子~~~&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>Son.vue</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h4</span> @<span class="attr">click</span>=<span class="string">&#x27;buy&#x27;</span>&gt;</span>&#123;&#123;childMsg&#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: [<span class="string">&#x27;parentMsg&#x27;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">msg</span>: <span class="string">&#x27;我是子组件&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">childMsg</span>: <span class="variable language_">this</span>.<span class="property">parentMsg</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">buy</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// console.log(this.parentMsg)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">childMsg</span> = <span class="string">&#x27;我感觉你在侮辱我&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h5 id="App-vue的打包过程">App.vue的打包过程</h5>
<p>我们对代码打包会报错：我们需要合适的Loader来处理文件</p>
<p>这个时候我们需要使用vue-loader</p>
<p><code>npm install vue-loader@next -D</code></p>
<p>在webpack的模板规则中进行配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">   <span class="attr">loader</span>: <span class="string">&#x27;vue-loader&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="vue-compiler-sfc">@vue/compiler-sfc</h5>
<p>打包依然会报错，这是因为我们必须添加@vue/compiler-sfc来对template进行解析</p>
<p><code>npm install @vue/compiler-sfc -D</code></p>
<p>另外我们需要配置对应的Vue插件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构vue-loader</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">VueLoaderPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;vue-loader&#x27;</span>)</span><br><span class="line"><span class="attr">plugins</span>:[</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">VueLoaderPlugin</span>()   </span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="搭建本地服务器"><strong>搭建本地服务器</strong></h4>
<p>为什么要搭建？</p>
<p>目前我们开发的代码，为了运行需要有两个操作：</p>
<p>操作一：npm run build，编译相关的代码；</p>
<p>操作二：通过live server或者直接通过浏览器，打开index.html代码，查看效果；</p>
<p>这个过程经常操作会影响我们的开发效率，我们希望可以做到，当文件发生变化时，可以自动的完成 编译 和 展示；</p>
<p>为了完成自动编译，webpack提供了几种可选的方式：</p>
<p>webpack watch mode；</p>
<p>webpack-dev-server（常用）；</p>
<p>webpack-dev-middleware；</p>
<h5 id="Webpack-watch"><strong>Webpack watch</strong></h5>
<p>webpack给我们提供了watch模式：</p>
<p>在该模式下，webpack依赖图中的所有文件，只要有一个发生了更新，那么代码将被重新编译；</p>
<p>我们不需要手动去运行 npm run build指令了；</p>
<p>如何开启watch呢？两种方式：</p>
<p>方式一：在导出的配置中，添加 watch: true；</p>
<p>方式二：在启动webpack的命令中，添加 --watch的标识；</p>
<p>这里我们选择方式二，在package.json的 scripts 中添加一个 watch 的脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;npx webpack&quot;,</span><br><span class="line">    &quot;watch&quot;: &quot;webpack --watch&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="webpack-dev-server"><strong>webpack-dev-server</strong></h5>
<p>上面的方式可以监听到文件的变化，但是事实上它本身是没有自动刷新浏览器的功能的：</p>
<p>当然，目前我们可以在VSCode中使用live-server来完成这样的功能；</p>
<p>但是，我们希望在不使用live-server的情况下，可以具备live reloading（实时重新加载）的功能；</p>
<p>安装webpack-dev-server</p>
<p><code>npm install webpack-dev-server -D</code></p>
<p>修改配置文件，告知 dev server，从什么位置查找文件：</p>
<p>contentBase 已经从webpack5中移除 使用static取代</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    // 主要是指定静态资源的根目录的 下面这种方式已废弃</span><br><span class="line">    // contentBase: &#x27;./public&#x27;,</span><br><span class="line">    </span><br><span class="line">    // webpack5最新的方式</span><br><span class="line">    static: &#123;</span><br><span class="line">       directory: path.join(__dirname, &#x27;public&#x27;),</span><br><span class="line">     &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>webpack-dev-server 在编译之后不会写入到任何输出文件。而是将 bundle 文件保留在内存中：事实上webpack-dev-server使用了一个库叫memfs（memory-fs webpack自己写的）</p>
<h5 id="认识模块热替换（HMR）">认识模块热替换（HMR）</h5>
<p>什么是HMR呢？</p>
<p>HMR的全称是Hot Module Replacement，翻译为模块热替换；</p>
<p>模块热替换是指在 应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个页面；</p>
<p>HMR通过如下几种方式，来提高开发的速度：</p>
<p>不重新加载整个页面，这样可以保留某些应用程序的状态不丢失；</p>
<p>只更新需要变化的内容，节省开发的时间；</p>
<p>修改了css、js源代码，会立即在浏览器更新，相当于直接在浏览器的devtools中直接修改样式；</p>
<p>如何使用HMR呢？</p>
<p>默认情况下，webpack-dev-server已经支持HMR，我们只需要开启即可；</p>
<p>在不开启HMR的情况下，当我们修改了源代码之后，整个页面会自动刷新，使用的是live reloading</p>
<h5 id="开启HMR">开启HMR</h5>
<p>修改配置文件:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">	<span class="attr">static</span>: &#123;</span><br><span class="line">       <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>),</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">hot</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>浏览器控制台查看效果</p>
<p><img data-src="image-20220713233728291.png" alt=""></p>
<p>但是你会发现，当我们修改了某一个模块的代码时，依然是刷新的整个页面：</p>
<p>这是因为我们需要去指定哪些模块发生更新时，进行HMR；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./a.js&#x27;</span></span><br><span class="line"><span class="comment">// 指定哪些模块发生更新时进行HMR</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">module</span>.<span class="property">hot</span>)&#123;</span><br><span class="line">  <span class="comment">// accept: 认可 同意</span></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./a.js&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a.js已经更新啦~~~~~~&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="框架的HMR">框架的HMR</h5>
<p>有一个问题：在开发其他项目时，我们是否需要经常手动去写入 module.hot.accpet相关的API呢？</p>
<p>比如开发Vue、React项目，我们修改了组件，希望进行热更新，这个时候应该如何去操作呢？</p>
<p>事实上社区已经针对这些有很成熟的解决方案了：</p>
<p>比如vue开发中，我们使用vue-loader，此loader支持vue组件的HMR，提供开箱即用的体验；</p>
<p>比如react开发中，有React Hot Loader，实时调整react组件（目前React官方已经弃用了，改成使用react- refresh）；</p>
<h5 id="HRM原理">HRM原理</h5>
<p>那么HMR的原理是什么呢？如何可以做到只更新一个模块中的内容呢？</p>
<p>webpack-dev-server会创建两个服务：提供静态资源的服务（express）和Socket服务（net.Socket）；</p>
<p>express server负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）；</p>
<p>HMR Socket Server，是一个socket的长连接：</p>
<p>长连接有一个最好的好处是建立连接后双方可以通信（服务器可以直接发送文件到客户端）；</p>
<p>当服务器监听到对应的模块发生变化时，会生成两个文件.json（manifest文件）和.js文件（update chunk）；</p>
<p>通过长连接，可以直接将这两个文件主动发送给客户端（浏览器）；</p>
<p>浏览器拿到两个新的文件后，通过HMR runtime机制，加载这两个文件，并且针对修改的模块进行更新；</p>
<p><img data-src="image-20220714222243288.png" alt=""></p>
<h5 id="hotOnly、host配置">hotOnly、host配置</h5>
<p>host设置主机地址：</p>
<p>默认值是localhost；</p>
<p>如果希望其他地方也可以访问，可以设置为 0.0.0.0；</p>
<p>localhost 和 0.0.0.0 的区别：</p>
<p>localhost：本质上是一个域名，通常情况下会被解析成127.0.0.1;</p>
<p>127.0.0.1：回环地址(Loop Back Address)，表达的意思其实是我们主机自己发出去的包，直接被自己接收;</p>
<p>正常的数据库包发送过程 应用层 - 传输层 - 网络层 - 数据链路层 - 物理层 ;</p>
<p>而回环地址，是在网络层直接就被获取到了，是不会经常数据链路层和物理层的;</p>
<p>比如我们监听 127.0.0.1时，在同一个网段下的主机中，通过ip地址是不能访问的;</p>
<p>0.0.0.0：监听IPV4上所有的地址，再根据端口找到不同的应用程序;</p>
<p>比如我们监听 0.0.0.0时，在同一个网段下的主机中，通过ip地址是可以访问的;</p>
<h5 id="port、open、compress">port、open、compress</h5>
<p>port设置监听的端口，默认情况下是8080</p>
<p>open是否打开浏览器：</p>
<p>默认值是false，设置为true会打开浏览器；</p>
<p>也可以设置为类似于 Google Chrome等值；</p>
<p>compress是否为静态文件开启gzip compression：</p>
<p>默认值是false，可以设置为true；</p>
<p><img data-src="image-20220714222504046.png" alt=""></p>
<h5 id="Proxy-2">Proxy</h5>
<p>proxy是我们开发中非常常用的一个配置选项，它的目的设置代理来解决跨域访问的问题：</p>
<p>比如我们的一个api请求是 <a target="_blank" rel="noopener" href="http://localhost:8888">http://localhost:8888</a>，但是本地启动服务器的域名是 <a target="_blank" rel="noopener" href="http://localhost:8000">http://localhost:8000</a>，这 个时候发送网络请求就会出现跨域的问题；</p>
<p>那么我们可以将请求先发送到一个代理服务器，代理服务器和API服务器没有跨域的问题，就可以解决我们的跨域问题了；</p>
<p>我们可以进行如下的设置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">proxy</span>: [</span><br><span class="line">  <span class="comment">// 所有以api开头的请求路径 会被代理到3000端口</span></span><br><span class="line">  <span class="comment">// 原地址: http://localhost:7777/api/getuserlist</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">context</span>: [<span class="string">&#x27;/api&#x27;</span>],</span><br><span class="line">    <span class="comment">// 代理的目标地址</span></span><br><span class="line">    <span class="attr">target</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">    <span class="comment">// target代理后: http://localhost:3000/api/getuserlist</span></span><br><span class="line">    <span class="comment">// 路径重写</span></span><br><span class="line">    <span class="attr">pathRewrite</span>: &#123; <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">    <span class="comment">// 真正请求: http://localhost:3000/getuserlist</span></span><br><span class="line">    <span class="comment">// 默认情况下不接收转发到https的服务器上，如果希望支持，可以设置为false</span></span><br><span class="line">    <span class="attr">secure</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 它表示是否更新代理后请求的headers中host地址</span></span><br><span class="line">    <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>target：表示的是代理到的目标地址，比如 /api-hy/moment会被代理到 <a target="_blank" rel="noopener" href="http://localhost:8888/api-">http://localhost:8888/api-</a>  hy/moment；</p>
<p>pathRewrite：默认情况下，我们的 /api-hy 也会被写入到URL中，如果希望删除，可以使用pathRewrite；</p>
<p>secure：默认情况下不接收转发到https的服务器上，如果希望支持，可以设置为false；</p>
<p>changeOrigin：它表示是否更新代理后请求的headers中host地址；</p>
<h5 id="changeOrigin">changeOrigin</h5>
<p>这个 changeOrigin官方说的非常模糊，通过查看源码我发现其实是要修改代理请求中的headers中的host属性：</p>
<p>因为我们真实的请求，其实是需要通过 http://localhost:8888来请求的；</p>
<p>但是因为使用了代码，默认情况下它的值时 <a target="_blank" rel="noopener" href="http://localhost:8000">http://localhost:8000</a>；</p>
<p>如果我们需要修改，那么可以将changeOrigin设置为true即可；</p>
<p><img data-src="image-20220714222917297.png" alt=""></p>
<h5 id="historyApiFallback">historyApiFallback</h5>
<p>historyApiFallback是开发中一个非常常见的属性，它主要的作用是解决SPA页面在路由跳转之后，进行页面刷新 时，返回404的错误。</p>
<p>boolean值：默认是false</p>
<p>如果设置为true，那么在刷新时，返回404错误时，会自动返回 index.html 的内容；</p>
<p>object类型的值，可以配置rewrites属性：</p>
<p>可以配置from来匹配路径，决定要跳转到哪一个页面；</p>
<p>事实上devServer中实现historyApiFallback功能是通过connect-history-api-fallback库的：</p>
<p>可以查看connect-history-api-fallback 文档</p>
<h5 id="resolve模块解析">resolve模块解析</h5>
<p>resolve用于设置模块如何被解析：</p>
<p>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库；</p>
<p>resolve可以帮助webpack从每个 require/import 语句中，找到需要引入到合适的模块代码；</p>
<p>webpack 使用 enhanced-resolve 来解析文件路径；</p>
<p><strong>webpack能解析三种文件路径：</strong></p>
<p>绝对路径</p>
<p>由于已经获得文件的绝对路径，因此不需要再做进一步解析。</p>
<p>相对路径</p>
<p>在这种情况下，使用 import 或 require 的资源文件所处的目录，被认为是上下文目录；</p>
<p>在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径；</p>
<p>模块路径</p>
<p>在 resolve.modules中指定的所有目录检索模块；</p>
<p>默认值是 [‘node_modules’]，所以默认会从node_modules中查找文件；</p>
<p>我们可以通过设置别名的方式来替换初识模块路径，具体后面讲解alias的配置；</p>
<p><strong>确实文件还是文件夹</strong></p>
<p>如果是一个文件：</p>
<p>如果文件具有扩展名，则直接打包文件；</p>
<p>否则，将使用 resolve.extensions选项作为文件扩展名解析；</p>
<p>如果是一个文件夹：</p>
<p>会在文件夹中根据 resolve.mainFiles配置选项中指定的文件顺序查找；</p>
<p>resolve.mainFiles的默认值是 [‘index’]；</p>
<p>再根据 resolve.extensions来解析扩展名；</p>
<h5 id="extensions和alias配置">extensions和alias配置</h5>
<p>extensions是解析到文件时自动添加扩展名：</p>
<p>默认值是 [‘.wasm’, ‘.mjs’, ‘.js’, ‘.json’]；</p>
<p>所以如果我们代码中想要添加加载 .vue 或者 jsx 或者 ts 等文件时，我们必须自己写上扩展名；</p>
<p>另一个非常好用的功能是配置别名alias：</p>
<p>特别是当我们项目的目录结构比较深的时候，或者一个文件的路径可能需要 …/…/…/这种路径片段；</p>
<p>我们可以给某些常见的路径起一个别名；</p>
<p><img data-src="image-20220714223714865.png" alt=""></p>
<h4 id="webpack生产环境配置">webpack生产环境配置</h4>
<h5 id="css提取">css提取</h5>
<p>下载插件 <code>npm install --save-dev mini-css-extract-plugin</code></p>
<p>修改配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="attr">rules</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">       <span class="attr">use</span>: [</span><br><span class="line">           <span class="comment">//创建 style标签，将样式放入</span></span><br><span class="line">           <span class="comment">// &#x27;style-loader&#x27;,</span></span><br><span class="line">           <span class="comment">//这个 loader取代 style-loader。作用：提取 js中的 css成单独文件</span></span><br><span class="line">           <span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>,</span><br><span class="line">           <span class="comment">//将 css文件整合到 js文件中</span></span><br><span class="line">           <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">    <span class="comment">//对输出的 css文件进行重命名</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h5 id="css兼容">css兼容</h5>
<p>详见：postcss-preset-env</p>
<p>补充一点：package.json中指定要兼容到哪个版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;browserslist&quot;</span> : &#123;</span><br><span class="line">	<span class="string">&quot;development&quot;</span> :[</span><br><span class="line">		<span class="string">&quot;last 1 chrome version&quot;</span> ,</span><br><span class="line">		<span class="string">&quot;last 1 firefox version&quot;</span> ,</span><br><span class="line">		<span class="string">&quot;last 1 safari version&quot;</span></span><br><span class="line">    ],</span><br><span class="line">	<span class="string">&quot;production&quot;</span>:[</span><br><span class="line">        <span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">		<span class="string">&quot;not dead&quot;</span> ,</span><br><span class="line">		<span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;last 1 chrome version&quot;</span> 表示兼容最近版本的 chrome</span><br><span class="line"><span class="string">&quot;&gt;0.2%&quot;</span> 表示大于 <span class="number">99.8</span>% 的浏览器</span><br><span class="line"><span class="string">&quot;not dead&quot;</span> 表示不要已经死去的浏览器(如 <span class="title class_">IE10</span>)</span><br><span class="line"><span class="string">&quot;not op_mini all&quot;</span> 表示要 欧朋mini 浏览器 (不兼容已经死去的浏览器)</span><br></pre></td></tr></table></figure>
<p>或者在根目录下新建<code>.browserslistrc</code>文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="number">1</span>%</span><br><span class="line">last <span class="number">2</span> versions</span><br><span class="line">not dead</span><br></pre></td></tr></table></figure>
<p><code>browserslist</code>默认使用的是production环境变量 我们可以修改nodejs的环境变量来决定它的环境变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.<span class="property">env</span>.<span class="property">NODE_ENV</span> = <span class="string">&#x27;development&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="css压缩">css压缩</h5>
<p>下载插件 <code>npm install --save-dev optimize-css-assets-webpack-plugin</code></p>
<p>webpack5改用 <code>npm i -D css-minimizer-webpack-plugin</code></p>
<p>修改配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h5 id="js语法检查">js语法检查</h5>
<p>详见：eslint</p>
<h5 id="js兼容处理">js兼容处理</h5>
<p>详见：babel</p>
<h5 id="js压缩">js压缩</h5>
<p>生产环境下会自动压缩 js代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mode: &#x27;production&#x27;</span><br></pre></td></tr></table></figure>
<h5 id="HTML压缩">HTML压缩</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">    <span class="comment">//压缩 html代码</span></span><br><span class="line">    <span class="attr">minify</span>: &#123;</span><br><span class="line">      <span class="comment">//移除空格</span></span><br><span class="line">      <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">//移除注释</span></span><br><span class="line">      <span class="attr">removeComments</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// 移除空元素</span></span><br><span class="line">      <span class="attr">removeEmptyElements</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="性能优化">性能优化</h4>
<p>开发环境性能优化</p>
<ul>
<li>优化打包构建速度</li>
<li>优化代码调试</li>
</ul>
<p>生产环境性能优化</p>
<ul>
<li>优化打包构建速度</li>
<li>优化代码运行的性能</li>
</ul>
<h5 id="HMR">HMR</h5>
<p><strong>HMR：hot module replacement 热模块替换/模块热替换 是基于开发环境的</strong></p>
<p><strong>作用</strong>：一个模块发生变化，只会宠幸打包这一个文件，而不是打包所有的源文件</p>
<p><strong>样式文件</strong>：可以使用HMR，因为在style-loader内部实现了，所以在开发环境中，都用style-loader</p>
<p><strong>js文件</strong>：默认不能使用HMR.要使用，在对应js文件中添加如下代码</p>
<p><strong>注意</strong>：HMR功能对js的处理，只能处理非入口js文件的其他文件！！！！</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable language_">module</span>.<span class="property">hot</span>)&#123;</span><br><span class="line">    <span class="comment">//这里以build.js为例子,不能处理入口js文件</span></span><br><span class="line">    moule.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&#x27;./build.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//会监听index.js的变化，一旦发生变化，就会执行这里的函数</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>html文件</strong>：默认不能使用HMR功能，同时会导致问题： html文件不能热更新了～(不用做HMR功能)</p>
<p><strong>解决</strong>：修改entry入口，将html文件引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entry：[<span class="string">&#x27;src/index.js&#x27;</span>, <span class="string">&#x27;public/index.html&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h5 id="source-map">source-map</h5>
<p>作用：一种提供源代码到构建后代码映射技术（如果构建后代码出错了，通过映射可以追踪源代码错误)</p>
<p>参数：<code>[inline-|hidden-|eva1-][nosources-][cheap-[module-]]source-map</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">source-map: 外部</span><br><span class="line">显示错误代码准确信息 和 源代码的错误位置</span><br><span class="line"></span><br><span class="line">inline-source-map：内联（只生成一个内联source-map）</span><br><span class="line">显示错误代码准确信息 和 源代码的错误位置</span><br><span class="line"></span><br><span class="line">hidden-source-map：外部（每一个文件都生成对应的source-map 都在eval中）</span><br><span class="line">显示错误代码错误原因 但是没有错误位置 不能追踪源代码错误位置 只能提示到构建后代码的错误位置</span><br><span class="line"></span><br><span class="line">eval-source-map：内联</span><br><span class="line">显示错误代码准确信息 和 源代码的错误位置</span><br><span class="line"></span><br><span class="line">nosources-source-map：外部</span><br><span class="line">显示错误代码准确信息 但是没有任何源代码的信息</span><br><span class="line"></span><br><span class="line">cheap-source-map：外部</span><br><span class="line">显示错误代码准确信息 和 源代码的错误位置 只能精确到错误行不能精确到错误列</span><br><span class="line"></span><br><span class="line">cheap-module-source-map：外部</span><br><span class="line">显示错误代码准确信息 和 源代码的错误位置 module会将loader的source-map也加入进来</span><br><span class="line"></span><br><span class="line">内联和外部的区别：</span><br><span class="line">1．外部生成了文件，内联没有</span><br><span class="line">2．内联构建速度更快</span><br></pre></td></tr></table></figure>
<p>如何决定使用哪个呢？</p>
<p>开发环境：</p>
<p>速度快：（eval&gt;inline&gt;cheap…）=&gt;  eval-cheap-source-map || eval-source-map</p>
<p>调试更友好： source-map || cheap-module-source-map || cheap-source-map</p>
<p>结论： 推荐 eval-source-map / eval-cheap-module-source-map</p>
<p>生成环境：</p>
<p>注：内联会让生产环境变的特别大 所以在生产环境下不推荐这种方式</p>
<p>源码要不要隐藏：nosources-source-map || hidden-source-map</p>
<p>调试要不要更友好：source-map || cheap-module-source-map</p>
<p>结论：推荐 source-map</p>
<h5 id="oneOf">oneOf</h5>
<p>oneof是提供优化生产环境打包配置的，正常来讲，一个文件只能被一个loader处理。<br>
比如：同时同时处理css文件和less文件，都需要css-loader，会让css-loader重复的执行，而oneof则会优化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下 loader只会匹配一个</span></span><br><span class="line"><span class="comment">//注意：不能有两个配置处理同一种类型文件</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">//只需要将配置文件放入oneof中即可</span></span><br><span class="line">        <span class="attr">oneof</span>:[]</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>注意：两个loader处理一个时，则需要放在外面</strong></p>
<p>比如：js文件需要eslint-loader处理和babel-loader处理。这个时候我们就需要单独提取出。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">module</span>:&#123;</span><br><span class="line">    <span class="attr">rules</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">//这里放单独提取出的loader处理,只需要放一个  </span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//只需要将配置文件放入oneof中即可</span></span><br><span class="line">            <span class="attr">oneof</span>:[]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="缓存">缓存</h5>
<p>生产环境</p>
<p>当我们的js代码有很多时，我们修改其中的一个，并不希望所有的js代码都重新被打包。此时我们就要用到生产环境的缓存处理</p>
<p><strong>babel缓存</strong></p>
<p><strong>让第二次打包构建速度更快</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel-loader配置项中开启babel缓存，第二次构建的时候就会读取缓存</span></span><br><span class="line"><span class="attr">cacheDirectory</span>:<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>此时，用户第一次打开就会生成缓存，后面打开的话就会很快。</p>
<p>但是，如果你的js css代码修改的话，重新打包，页面将不会有任何反应，因为他们用的都是第一次留下的缓存，那我们怎么让他正常的处理呢？ 我们对文件名加入hash值即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在webpack.config.js中，所有的filename中加入hash值即可,比如下述代码</span></span><br><span class="line"><span class="attr">filename</span>:<span class="string">&#x27;index[hash:10].js&#x27;</span></span><br></pre></td></tr></table></figure>
<p>造成的问题：因为css和js同时使用一个hash值。</p>
<p>如果重新打包，会导致所有的缓存失效。（我们只想改变其中的一个文件）</p>
<p>chunkhash：不行，因为所引入的js，css等文件都是源自一个chunk，所以他们生成的哈希值也一样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">filename</span>:<span class="string">&#x27;index[chunkhash:10].js&#x27;</span></span><br></pre></td></tr></table></figure>
<p>contenthash：不同文件会生成不同的哈希值，可以</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">filename</span>:<span class="string">&#x27;index[contenthash:10].js&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="tree-shaking">tree shaking</h5>
<p>作用：去除无用代码，让代码体积变小</p>
<p>前提：</p>
<p>1、必须使用模块化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;increment, decrement&#125; <span class="keyword">from</span> <span class="string">&#x27;utils&#x27;</span></span><br><span class="line"><span class="title function_">increment</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>2、开启production环境</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br></pre></td></tr></table></figure>
<p>在package.json中配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;sideEffects&quot;</span>:<span class="literal">false</span>  <span class="comment">//所有代码都没有副作用,即可以进行tree shaking</span></span><br><span class="line">问题:可能会把css / @babel/polyfill (副作用)等文件干掉 ,此时我们要再加</span><br><span class="line"><span class="string">&quot;sideEffects&quot;</span>:[<span class="string">&quot;*.css&quot;</span>]  <span class="comment">//这样即可</span></span><br></pre></td></tr></table></figure>
<h5 id="code-split">code split</h5>
<p>code split 就是解决防止打包后一个文件过大，而请求缓慢.</p>
<p>code split 就是生成多个chunk，即把代码分成很多块</p>
<p>作用：</p>
<p>1、可以将node_modules中代码单独打包一个chunk</p>
<p>2、自动分析多入口chunk中，有没有公共的文件，如果有则会打包成一个chunk</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>  <span class="comment">//单入口</span></span><br><span class="line"><span class="attr">entry</span>:&#123;  <span class="comment">//多入口有几个文件就会输出几个文件，不同配置下面代码也可以</span></span><br><span class="line">    <span class="attr">index</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">test</span>:<span class="string">&#x27;./src/test.js&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在后面加入下述代码即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">optimization</span>:&#123;</span><br><span class="line">    <span class="attr">splitChunks</span>:&#123;</span><br><span class="line">        <span class="attr">chunks</span>:<span class="string">&#x27;all&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其次，我们还可以通过写js代码方式进行单独打包，首先要配置optimization和单入口</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是在index.js中引入。假设有test.js和index.js在同一层级</span></span><br><span class="line"><span class="title function_">import</span>(<span class="comment">/*webpackChunkname:&#x27;test&#x27;*/</span><span class="string">&#x27;./test&#x27;</span>)  <span class="comment">//在/**/中可以指定生成对应名字</span></span><br><span class="line">.<span class="title function_">then</span>(()=&#123;</span><br><span class="line">    <span class="comment">//文件调用成功</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//文件加载失败</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>总结三种方法</strong></p>
<ul>
<li>使用多入口文件进行单独打包</li>
<li>引入optimization相关配置，会根据单入口，多入口进行打包</li>
<li>引入optimization相关配置，在js中写入对应js代码，进行单独打包</li>
</ul>
<h5 id="懒加载和预加载">懒加载和预加载</h5>
<p>不是图片的懒加载，这里指的是js代码的懒加载</p>
<p>懒加载：当文件使用的时候加载</p>
<p>预加载 prefetch ：等其他资源加载完，再加载… 兼容性较差，一般都是用懒加载就够了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里比如当点击btn时，加载test.js文件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>).<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">import</span>(<span class="comment">/*webpackChunkName:&#x27;test&#x27;,webpackPrefetch:true*/</span><span class="string">&#x27;./test.js&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="PWA">PWA</h5>
<p>pwa即离线可访问技术</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WorkboxWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;workbox-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="comment">//再通过plugins  中new调用</span></span><br><span class="line"><span class="attr">plugins</span>:[</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">WorkboxWebpackPlugin</span>.<span class="title class_">GenerateSW</span>(&#123;</span><br><span class="line">        <span class="comment">//会生成serviceworker配置文件</span></span><br><span class="line">        <span class="comment">//1.帮助serviceworker快速启动</span></span><br><span class="line">        <span class="comment">//2.删除旧的servicewoker</span></span><br><span class="line">        <span class="attr">clientsClaim</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">skipWaiting</span>:<span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>然后还要去index.js中输入相应js代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;serviceWorker&#x27;</span> <span class="keyword">in</span> navigator)&#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>,()=&#123;</span><br><span class="line">        navigator.<span class="property">serviceWorker</span></span><br><span class="line">        .<span class="title function_">register</span>(<span class="string">&#x27;/service-worker.js&#x27;</span>)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;注册成功&#x27;</span>)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;注册失败&#x27;</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到这里，再打包eslint则会报错，不认识navigator等关键字，故我们要修改eslint中的配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在package.json中eslintConfig中添加下面代码</span></span><br><span class="line"><span class="string">&quot;env&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;browser&quot;</span>:<span class="literal">true</span>    <span class="comment">//支持浏览器全局变量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>serviceWorker必须运行在服务器上</strong></p>
<h5 id="多进程打包">多进程打包</h5>
<p>多进程打包主要用来优化打包速度。用的是thread-loader</p>
<p>在哪里用，在那里加就可以，基本是给js文件处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">use</span>:[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">loader</span>:<span class="string">&#x27;thread-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>:&#123;</span><br><span class="line">            <span class="attr">workers</span>:<span class="number">2</span>  <span class="comment">//z</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">loader</span>:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>:&#123;</span><br><span class="line">            <span class="comment">//...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>开启多线程打包，只有工作消耗时间比较长，我们才开启多线程打包，否则会适得其反，多线程启动大概600ms</p>
<h5 id="externals">externals</h5>
<p>可以禁止打包一些从cdn中可以获取到库，从而达到代码量少,在webpack.config.js中配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">externals</span>:&#123;</span><br><span class="line">    <span class="comment">//比如，拒绝vue被打包进来</span></span><br><span class="line">    <span class="attr">vue</span>:<span class="string">&#x27;Vue&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在html中通过script标签引入cdn链接</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="dll">dll</h5>
<p>dll和上面的externals相似。dll是需要打包一次。而externals是不打包</p>
<p>我们要新建webpack.dll.js文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>:&#123;</span><br><span class="line">        <span class="comment">//例如打包jquery. [name]--&gt; jquery   [&#x27;jquery&#x27;]--&gt;代表要打包的库是jquery</span></span><br><span class="line">        <span class="attr">jquery</span>:[<span class="string">&#x27;jquery&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;dll&#x27;</span>),</span><br><span class="line">        <span class="comment">//打包的库向外暴露出去的名字</span></span><br><span class="line">        <span class="attr">library</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="comment">//打包生成一个manifest.json 和jquery提供映射</span></span><br><span class="line">        <span class="keyword">new</span> webpack.<span class="title class_">DllPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>:<span class="string">&#x27;[name]_[hash]&#x27;</span> <span class="comment">//暴露出去的名称</span></span><br><span class="line">            <span class="attr">path</span>:<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;dll/mainfest.json&#x27;</span>)<span class="comment">//输出文件路径</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">     <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在config.js配置如下即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="comment">//webpack默认打包是config.js文件。可以通过引入然后调用改变默认打包文件</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AddAssetHtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;add-asset-html-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exprots</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>:<span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>:&#123;</span><br><span class="line">        <span class="attr">filename</span>:<span class="string">&#x27;built.js&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>:<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>:[</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filename</span>:<span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">//告诉webpack哪些库不需要打包,也就是通过json文件映射到相应库，告诉webpack不参与打包</span></span><br><span class="line">        <span class="keyword">new</span> webpack.<span class="title class_">DllReferencePlugin</span>(&#123;</span><br><span class="line">            <span class="attr">mainfest</span>:<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;dll/manifest.json&#x27;</span>)</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">//将文件打包输出出去，并在html中自动引入资源</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AddAssetHtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">filepath</span>:<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;dll/jquery.js&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更详细配置待更新 …</p>

    </div>

    
    
    

     <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px; padding-top: 10px;"> <i class="fa fa-heart"></i>--------------------------------------- The End ---------------------------------------<i class="fa fa-heart"></i>  </div>
    
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>老许
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://github.com/xuwanghui/blog.git/2024/11/27/webpack/" title="webpack 学习">https://github.com/xuwanghui/blog.git/2024/11/27/webpack/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/webpack/" rel="tag"><i class="fa fa-tag"></i> webpack</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/11/27/vue3%E9%A1%B9%E7%9B%AE/" rel="prev" title="vue3项目">
      <i class="fa fa-chevron-left"></i> vue3项目
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/11/27/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="next" title="小程序 学习">
      小程序 学习 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#npm%E7%9B%B8%E5%85%B3"><span class="nav-number">1.</span> <span class="nav-text">npm相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-number">2.</span> <span class="nav-text">什么是构建工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E7%9A%84%E5%8F%91%E5%B1%95"><span class="nav-number">3.</span> <span class="nav-text">构建工具的发展</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="nav-number">4.</span> <span class="nav-text">构建工具介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E9%80%82%E5%90%88%E7%9A%84%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%EF%BC%9F"><span class="nav-number">5.</span> <span class="nav-text">如何选择适合的构建工具？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwebpack"><span class="nav-number">6.</span> <span class="nav-text">什么是webpack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%90%86%E8%A7%A3module%E3%80%81chunk%E3%80%81bundle"><span class="nav-number">7.</span> <span class="nav-text">理解module、chunk、bundle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E4%BA%94%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="nav-number">8.</span> <span class="nav-text">webpack五个核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Entry"><span class="nav-number">8.1.</span> <span class="nav-text">Entry</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Output"><span class="nav-number">8.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Loader"><span class="nav-number">8.3.</span> <span class="nav-text">Loader</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Plugins"><span class="nav-number">8.4.</span> <span class="nav-text">Plugins</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mode"><span class="nav-number">8.5.</span> <span class="nav-text">mode</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E4%BD%BF%E7%94%A8%E5%89%8D%E6%8F%90"><span class="nav-number">9.</span> <span class="nav-text">webpack使用前提</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E5%AE%89%E8%A3%85"><span class="nav-number">10.</span> <span class="nav-text">webpack安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E7%9A%84%E9%BB%98%E8%AE%A4%E6%89%93%E5%8C%85"><span class="nav-number">11.</span> <span class="nav-text">webpack的默认打包</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEscript%E8%84%9A%E6%9C%AC"><span class="nav-number">11.1.</span> <span class="nav-text">配置script脚本</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="nav-number">12.</span> <span class="nav-text">webpack开发环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">12.1.</span> <span class="nav-text">创建配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%A0%B7%E5%BC%8F%E8%B5%84%E6%BA%90"><span class="nav-number">12.2.</span> <span class="nav-text">打包样式资源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#style-loader"><span class="nav-number">12.3.</span> <span class="nav-text">style-loader</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#less-loader"><span class="nav-number">12.4.</span> <span class="nav-text">less-loader</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#PostCss"><span class="nav-number">12.5.</span> <span class="nav-text">PostCss</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#autoprefixer"><span class="nav-number">12.5.1.</span> <span class="nav-text">autoprefixer</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#postcss-loader"><span class="nav-number">12.5.2.</span> <span class="nav-text">postcss-loader</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#postcss-preset-env"><span class="nav-number">12.5.3.</span> <span class="nav-text">postcss-preset-env</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%93%E5%8C%85HTML%E8%B5%84%E6%BA%90"><span class="nav-number">12.6.</span> <span class="nav-text">打包HTML资源</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#HtmlWebpackPlugin"><span class="nav-number">12.6.1.</span> <span class="nav-text">HtmlWebpackPlugin</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="nav-number">12.7.</span> <span class="nav-text">打包图片资源</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#file-loader"><span class="nav-number">12.7.1.</span> <span class="nav-text">file-loader</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#url-loader"><span class="nav-number">12.7.2.</span> <span class="nav-text">url-loader</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#html-loader"><span class="nav-number">12.7.3.</span> <span class="nav-text">html-loader</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E5%85%B6%E5%AE%83%E8%B5%84%E6%BA%90"><span class="nav-number">12.8.</span> <span class="nav-text">打包其它资源</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#asset-module-type"><span class="nav-number">13.</span> <span class="nav-text">asset module type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Plugins-2"><span class="nav-number">14.</span> <span class="nav-text">Plugins</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#CleanWebpackPlugin"><span class="nav-number">14.1.</span> <span class="nav-text">CleanWebpackPlugin</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HtmlWebpackPlugin-2"><span class="nav-number">14.2.</span> <span class="nav-text">HtmlWebpackPlugin</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DefinePlugin"><span class="nav-number">14.3.</span> <span class="nav-text">DefinePlugin</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CopyWebpackPlugin"><span class="nav-number">14.4.</span> <span class="nav-text">CopyWebpackPlugin</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Babel%E7%9B%B8%E5%85%B3"><span class="nav-number">15.</span> <span class="nav-text">Babel相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#babel-preset-env"><span class="nav-number">15.1.</span> <span class="nav-text">babel&#x2F;preset-env</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#babel%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">15.2.</span> <span class="nav-text">babel配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#corejs"><span class="nav-number">15.3.</span> <span class="nav-text">corejs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#eslint-3"><span class="nav-number">15.4.</span> <span class="nav-text">eslint</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Vue%E6%BA%90%E7%A0%81%E6%89%93%E5%8C%85"><span class="nav-number">16.</span> <span class="nav-text">Vue源码打包</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Vue%E6%89%93%E5%8C%85%E5%90%8E%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E8%A7%A3%E6%9E%90"><span class="nav-number">16.1.</span> <span class="nav-text">Vue打包后不同版本解析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6-%E7%BC%96%E8%AF%91%E5%99%A8-vs-%E4%BB%85%E8%BF%90%E8%A1%8C%E6%97%B6"><span class="nav-number">16.2.</span> <span class="nav-text">运行时+编译器 vs 仅运行时</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E6%A0%87%E8%AF%86%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">16.3.</span> <span class="nav-text">全局标识的配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VSCode%E5%AF%B9SFC%E6%96%87%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81"><span class="nav-number">16.4.</span> <span class="nav-text">VSCode对SFC文件的支持</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%96%E5%86%99App-vue%E4%BB%A3%E7%A0%81"><span class="nav-number">16.5.</span> <span class="nav-text">编写App.vue代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#App-vue%E7%9A%84%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B"><span class="nav-number">16.6.</span> <span class="nav-text">App.vue的打包过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#vue-compiler-sfc"><span class="nav-number">16.7.</span> <span class="nav-text">@vue&#x2F;compiler-sfc</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">17.</span> <span class="nav-text">搭建本地服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Webpack-watch"><span class="nav-number">17.1.</span> <span class="nav-text">Webpack watch</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#webpack-dev-server"><span class="nav-number">17.2.</span> <span class="nav-text">webpack-dev-server</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%BF%E6%8D%A2%EF%BC%88HMR%EF%BC%89"><span class="nav-number">17.3.</span> <span class="nav-text">认识模块热替换（HMR）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%80%E5%90%AFHMR"><span class="nav-number">17.4.</span> <span class="nav-text">开启HMR</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A1%86%E6%9E%B6%E7%9A%84HMR"><span class="nav-number">17.5.</span> <span class="nav-text">框架的HMR</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HRM%E5%8E%9F%E7%90%86"><span class="nav-number">17.6.</span> <span class="nav-text">HRM原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hotOnly%E3%80%81host%E9%85%8D%E7%BD%AE"><span class="nav-number">17.7.</span> <span class="nav-text">hotOnly、host配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#port%E3%80%81open%E3%80%81compress"><span class="nav-number">17.8.</span> <span class="nav-text">port、open、compress</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Proxy-2"><span class="nav-number">17.9.</span> <span class="nav-text">Proxy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#changeOrigin"><span class="nav-number">17.10.</span> <span class="nav-text">changeOrigin</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#historyApiFallback"><span class="nav-number">17.11.</span> <span class="nav-text">historyApiFallback</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#resolve%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90"><span class="nav-number">17.12.</span> <span class="nav-text">resolve模块解析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#extensions%E5%92%8Calias%E9%85%8D%E7%BD%AE"><span class="nav-number">17.13.</span> <span class="nav-text">extensions和alias配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="nav-number">18.</span> <span class="nav-text">webpack生产环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#css%E6%8F%90%E5%8F%96"><span class="nav-number">18.1.</span> <span class="nav-text">css提取</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#css%E5%85%BC%E5%AE%B9"><span class="nav-number">18.2.</span> <span class="nav-text">css兼容</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#css%E5%8E%8B%E7%BC%A9"><span class="nav-number">18.3.</span> <span class="nav-text">css压缩</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#js%E8%AF%AD%E6%B3%95%E6%A3%80%E6%9F%A5"><span class="nav-number">18.4.</span> <span class="nav-text">js语法检查</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#js%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86"><span class="nav-number">18.5.</span> <span class="nav-text">js兼容处理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#js%E5%8E%8B%E7%BC%A9"><span class="nav-number">18.6.</span> <span class="nav-text">js压缩</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTML%E5%8E%8B%E7%BC%A9"><span class="nav-number">18.7.</span> <span class="nav-text">HTML压缩</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-number">19.</span> <span class="nav-text">性能优化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#HMR"><span class="nav-number">19.1.</span> <span class="nav-text">HMR</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#source-map"><span class="nav-number">19.2.</span> <span class="nav-text">source-map</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#oneOf"><span class="nav-number">19.3.</span> <span class="nav-text">oneOf</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%93%E5%AD%98"><span class="nav-number">19.4.</span> <span class="nav-text">缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#tree-shaking"><span class="nav-number">19.5.</span> <span class="nav-text">tree shaking</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#code-split"><span class="nav-number">19.6.</span> <span class="nav-text">code split</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD"><span class="nav-number">19.7.</span> <span class="nav-text">懒加载和预加载</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#PWA"><span class="nav-number">19.8.</span> <span class="nav-text">PWA</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%89%93%E5%8C%85"><span class="nav-number">19.9.</span> <span class="nav-text">多进程打包</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#externals"><span class="nav-number">19.10.</span> <span class="nav-text">externals</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dll"><span class="nav-number">19.11.</span> <span class="nav-text">dll</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="老许"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">老许</p>
  <div class="site-description" itemprop="description">当学习成为了习惯<br/>知识也就变成了常识</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xuwanghui" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xuwanghui"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/xu_wang_hui@163.com" title="E-Mail → xu_wang_hui@163.com"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yourname" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=7515636986&auto=1&height=90"></iframe>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer" style="text-align:center">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">老许</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">995k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:05</span>
</div>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("03/12/2022 17:00:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        <a href="https://beian.miit.gov.cn/" target="_blank" style='color: #999999;text-decoration: none;'>京ICP备2021019190号-1</a>
      </div>
    </footer>
  </div>

  
  
  <script color='51,51,51' opacity='0.5' zIndex='-1' count='66' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '6mmQGNuthx4k1dsbW9UKhHGT-gzGzoHsz',
      appKey     : 'gXfUEGyEXIARBJjK2K53R51P',
      placeholder: "填写正确的邮箱可及时收到回复提醒哈 ~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

    </div>

</body>
</html>
<script type="text/javascript" src="/js/clicklove.js"></script>
