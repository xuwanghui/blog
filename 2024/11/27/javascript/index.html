<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.font.im/css?family=HarmonyOS_Regular:300,300italic,400,400italic,700,700italic|JetBrains Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"github.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="基础 数据类型 基本数据类型 js有五种基本数据类型： Undefined、Null、Boolean、Number、String es6新增了一种基本数据类型：Symbol es11新增了一种基本数据类型：bigInt">
<meta property="og:type" content="article">
<meta property="og:title" content="javascript">
<meta property="og:url" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/index.html">
<meta property="og:site_name" content="老许的欢乐世界">
<meta property="og:description" content="基础 数据类型 基本数据类型 js有五种基本数据类型： Undefined、Null、Boolean、Number、String es6新增了一种基本数据类型：Symbol es11新增了一种基本数据类型：bigInt">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230711145722189.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230712172247421.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230713103712327.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230713103807409.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230713153153974.png">
<meta property="og:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230713110817598.png">
<meta property="article:published_time" content="2024-11-27T09:08:01.465Z">
<meta property="article:modified_time" content="2023-07-24T15:43:10.406Z">
<meta property="article:author" content="老许">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/image-20230711145722189.png">

<link rel="canonical" href="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<link rel="preconnect" href="https://s1.hdslb.com/" />
<link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/regular.css" media="all" onload="this.media='all'" />
<link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/medium.css" media="all" onload="this.media='all'" />

  <title>javascript | 老许的欢乐世界</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="老许的欢乐世界" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a href="https://github.com/xuwanghui" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">老许的欢乐世界</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">愿与上善 唯望君安</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">13</span></a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">15</span></a>

  </li>
        <li class="menu-item menu-item-comments">

    <a href="/comments/" rel="section"><i class="fa fa-comments fa-fw"></i>留言板</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    <!--看板娘-->
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
    <script src="/live2d-widget/autoload.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/gh/xuwanghui/live2d-widget/autoload.js"></script>-->

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="老许">
      <meta itemprop="description" content="当学习成为了习惯<br/>知识也就变成了常识">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老许的欢乐世界">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          javascript
        </h1>

        <div class="post-meta">
        
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-11-27 17:08:01" itemprop="dateCreated datePublished" datetime="2024-11-27T17:08:01+08:00">2024-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-24 23:43:10" itemprop="dateModified" datetime="2023-07-24T23:43:10+08:00">2023-07-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index"><span itemprop="name">javascript</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/11/27/javascript/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/11/27/javascript/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>99k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:30</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="基础">基础</h3>
<h4 id="数据类型">数据类型</h4>
<h5 id="基本数据类型">基本数据类型</h5>
<p>js有<strong>五种</strong>基本数据类型： <strong>Undefined、Null、Boolean、Number、String</strong></p>
<p>es6新增了<strong>一种</strong>基本数据类型：<strong>Symbol</strong></p>
<p>es11新增了<strong>一种</strong>基本数据类型：<strong>bigInt</strong></p>
<span id="more"></span>
<h6 id="Number-2">Number</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">NaN</span>是number的特殊类型</span><br><span class="line"><span class="title class_">NaN</span> =&gt; not a number =&gt; 不是一个数字</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">NaN</span>)</span><br><span class="line"></span><br><span class="line">* <span class="title class_">NaN</span>和任何数都不相等包括它本身</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> == <span class="title class_">NaN</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> == <span class="literal">undefined</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> == <span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<h6 id="bigInt">bigInt</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">bigInt表示一个任意精度的整数，可以表示超长数据，可以超出<span class="number">2</span>的<span class="number">53</span>次方。</span><br><span class="line"><span class="title class_">Js</span> 中 <span class="title class_">Number</span>类型只能安全的表示-(<span class="number">2</span>^<span class="number">53</span>-<span class="number">1</span>)至 <span class="number">2</span>^<span class="number">53</span>-<span class="number">1</span> 范的值</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>**<span class="number">53</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span>) <span class="comment">// 最大值-1</span></span><br><span class="line"></span><br><span class="line">- 使用 <span class="title class_">BigInt</span> 有两种方式</span><br><span class="line">方式一: 数字后面增加n</span><br><span class="line"><span class="keyword">const</span> bigInt = <span class="number">9007199254740993n</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bigInt)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> bigInt) <span class="comment">// bigint</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1n</span> == <span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1n</span> === <span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">方式二: 使用 <span class="title class_">BigInt</span> 函数</span><br><span class="line"><span class="keyword">const</span> bigIntNum = <span class="title class_">BigInt</span>(<span class="number">9007199254740993</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bigIntNum)</span><br></pre></td></tr></table></figure>
<h6 id="undefined">undefined</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">出现<span class="literal">undefined</span>的情况</span><br><span class="line">- 已声明但未被初始化的变量默认赋值<span class="literal">undefined</span></span><br><span class="line"><span class="keyword">let</span> a; <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">- 未被声明的变量使用<span class="keyword">typeof</span>操作符检测数据类型时返回<span class="literal">undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> a)</span><br><span class="line">- 当函数没有明确指定返回值时，默认返回<span class="literal">undefined</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)&#125;; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fn</span>())</span><br><span class="line">- 调用函数时，应该提供的参数没有提供，该参数等于<span class="literal">undefined</span>。</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">x</span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(x)&#125;; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fn</span>())</span><br><span class="line">- 对象没有赋值的属性，该属性的值为<span class="literal">undefined</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;; obj.<span class="property">sex</span></span><br><span class="line"></span><br><span class="line">* <span class="literal">undefined</span>和<span class="literal">null</span>相等 除了这种情况以外 剩下的<span class="literal">null</span>/<span class="literal">undefined</span>和其它任何数据类型都不相等 除了它本身</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">undefined</span> == <span class="literal">null</span>)</span><br><span class="line">比较数据类型 两边类型不一致</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> === <span class="literal">undefined</span>)</span><br></pre></td></tr></table></figure>
<h6 id="null">null</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span>是js的关键字,表示空值</span><br><span class="line"><span class="literal">null</span>是<span class="title class_">Object</span>的一个特殊值,本质上是一个空的对象</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>); <span class="comment">// =&gt; &#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line">产生<span class="literal">null</span>的情况</span><br><span class="line"><span class="number">1</span>、访问不存在的dom元素</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;app&#x27;</span>))</span><br><span class="line"><span class="number">2</span>、<span class="title class_">Object</span>的原型链终点</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>)</span><br><span class="line"></span><br><span class="line">- 小知识: 为什么是typoef <span class="literal">null</span>为object？</span><br><span class="line">原理是这样的: 不同的对象在底层都表示为二进制,在 <span class="title class_">JavaScript</span> 中二进制前三位都为 <span class="number">0</span> 的话会被判断为 object 类型, <span class="literal">null</span>的二进制表示是全<span class="number">0</span>,自然前三位也是<span class="number">0</span>,所以执行 <span class="keyword">typeof</span> 时会返回<span class="string">&quot;object&quot;</span>。</span><br><span class="line">所以这是早期<span class="variable constant_">JS</span>实现中的一个错误, 其实从<span class="title class_">ES5</span>制定开始就有动议将<span class="keyword">typeof</span> <span class="literal">null</span>改为返回<span class="string">&quot;null&quot;</span>,只是因为要保持语言的兼容性而维持至今。</span><br><span class="line"></span><br><span class="line">- <span class="literal">null</span>应用场景</span><br><span class="line">当需要释放一个对象的时候可以将该对象赋值为<span class="literal">null</span>，进而来释放对象</span><br><span class="line">堆内存没有被外界引用的时候 就会被释放</span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;; obj = <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p><strong>如何判断变量是否为null？</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、<span class="keyword">var</span> exp = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (!exp &amp;&amp; <span class="keyword">typeof</span> exp != <span class="string">&quot;undefined&quot;</span> &amp;&amp; exp != <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;is null&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">其中 <span class="keyword">typeof</span> exp != <span class="string">&quot;undefined&quot;</span> 排除了 <span class="literal">undefined</span></span><br><span class="line">exp != <span class="number">0</span> 排除了数字零</span><br><span class="line">!exp 排除了 <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、<span class="keyword">var</span> exp = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (exp === <span class="literal">null</span>)&#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;is null&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>面试题</strong></p>
<p>如何检测一个对象是空对象？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- <span class="number">1</span>、使用<span class="title class_">JSON</span>.<span class="title function_">stringify</span>()将对象转换为json字符串；</span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj) === <span class="string">&#x27;&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">- <span class="number">2</span>、使用<span class="keyword">for</span>...<span class="keyword">in</span>循环遍历对象除<span class="title class_">Symbol</span>以外的所有可枚举属性, 当对象有属性存在返回<span class="literal">false</span>， 否则返回<span class="literal">true</span>。</span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isObjectEmpty</span>(<span class="params">obj</span>)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isObjectEmpty</span>(obj))</span><br><span class="line"></span><br><span class="line">- <span class="number">3</span>、<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>() 方法会返回该对象所有可枚举和不可枚举属性的属性名（不含<span class="title class_">Symbol</span>属性）组成的数组。然后再通过判断返回的数组长度是否为零，如果为零的话就是空对象。</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(obj).<span class="property">length</span> === <span class="number">0</span></span><br><span class="line"></span><br><span class="line">- <span class="number">4</span>、<span class="title class_">Object</span>.<span class="title function_">keys</span>() 是 <span class="title class_">ES5</span> 新增的一个对象方法，该方法返回一个数组，包含指定对象自有的可枚举属性（不含继承的和<span class="title class_">Symbol</span>属性）。用此方法只需要判断返回的数组长度是否为零，如果为零的话就是空对象。</span><br></pre></td></tr></table></figure>
<p><strong>null和undefined的区别？</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">相同点</span><br><span class="line"><span class="number">1.</span> 都只有一个值</span><br><span class="line"><span class="number">2.</span> 都没有方法，准确的说都不能调用方法</span><br><span class="line"><span class="number">3.</span> 都表示<span class="string">&quot;无&quot;</span></span><br><span class="line"></span><br><span class="line">不同点</span><br><span class="line"><span class="number">1.</span> <span class="literal">null</span>是一个关键字，<span class="literal">undefined</span>不是关键字。</span><br><span class="line"><span class="keyword">var</span> <span class="literal">null</span> = <span class="number">2</span>; <span class="comment">// 报错  </span></span><br><span class="line"><span class="keyword">var</span> <span class="literal">undefined</span> = <span class="number">2</span>; <span class="comment">// 不报错</span></span><br><span class="line"><span class="number">2.</span> <span class="literal">null</span>本质上是一个空的对象; <span class="literal">undefined</span>是<span class="variable language_">window</span>的一个属性。</span><br><span class="line"><span class="literal">null</span>表示<span class="string">&quot;没有对象&quot;</span>,即此处不应该有值。</span><br><span class="line">	- 作为函数的参数，表示该函数的参数不是对象。</span><br><span class="line">    - 作为对象原型链的终点。</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>) <span class="comment">// null</span></span><br><span class="line"><span class="literal">undefined</span>表示<span class="string">&quot;缺少值&quot;</span>,即此处应该有一个值，但是还没有定义。</span><br><span class="line">	- 变量被声明了，但没有赋值时，就等于<span class="literal">undefined</span>。</span><br><span class="line"> 		<span class="keyword">var</span> a;</span><br><span class="line">		a  <span class="comment">// undefined</span></span><br><span class="line">其余情况查看上面<span class="literal">undefined</span>章节</span><br></pre></td></tr></table></figure>
<h6 id="Boolean">Boolean</h6>
<p>bool 是表示 true 或 false 的基础数据类型。<br>
Boolean 是表示 true 或 false 的对象数据类型，可以把其他类型转换为 Boolean 类型</p>
<p><strong>bool 与 Boolean 区别</strong><br>
bool 是基础类型，Boolean 是对象类型；<br>
bool 使用场景：所有需要做 true 或 false 判断的地方，优先使用 bool 类型；<br>
Boolean 使用场景：无法直接判断 true 或 false 的类型，可转换为 Boolean 类型后，再做 true 或 false 判断。</p>
<h6 id="String">String</h6>
<p>字符串类型，说明：字符串，用一对单引号（’ '）或双引号（“ ”）及引号内的字符构成，引号中间的部分可以任意多个，也可以是没有字符的空字符串。字符串中如果字符包含了双引号，则其外部应该由单引号标示，反之相同（外单内双，外双内单）</p>
<h6 id="Symbol-2">Symbol</h6>
<p>ES6 引入了一种新的基本数据类型 <code>Symbol</code> ，表示独一无二的值。具体看ES6章节…</p>
<h5 id="引用数据类型">引用数据类型</h5>
<p>引用数据类型（复杂数据类型）指的是 Object类型，所有其他的如 Array、Date、Math、RegExp等数据类型都可以理解为Object类型的子类。</p>
<p><strong>其中Function比较特殊，它既是函数，也是对象。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实例化Function</span></span><br><span class="line"><span class="keyword">var</span> fn = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;return x + y&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fn</span>(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数身上有属性和方法 =&gt; 也能证明它是对象</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(fn)</span><br></pre></td></tr></table></figure>
<p>关于其它引用数据类型后续再单独展开讲</p>
<p><strong>基本数据类型和引用数据类型的区别？</strong></p>
<p>两种类型的区别是：<strong>存储位置不同</strong>。基本（原始）数据类型直接存储在栈（stack）中的简单数据段，<strong>占据空间小、大小固定</strong>，属于被频繁使用数据，所以放入栈中存储。引用数据类型存储在堆（heap）中的对象，<strong>占据空间大、大小不固定</strong>。如果存储在栈中，将会影响程序运行的性能；引用数据类型在栈中存储了指针，该指针指向堆中该实体的起始地址。当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获得实体。</p>
<h5 id="数据类型转换">数据类型转换</h5>
<p>概念：把一种数据类型的变量转换为另外一种数据类型。</p>
<p>数字类型转换（调用Number()，parseInt()，parseFloat()方法））</p>
<p>字符串类型转换（调用.toString()或String()方法）</p>
<p>布尔类型转换（调用Boolean()方法）</p>
<h6 id="Number-3">Number()</h6>
<p><strong>将参数对象的值转为数值</strong></p>
<p>遇到非数字字符则返回NaN</p>
<p>遇到第二个小数点返回NaN</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="number">1</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="number">1.2</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;1.2&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;1.2.3&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;1x&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;x1&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="literal">undefined</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="title class_">NaN</span>))</span><br><span class="line"></span><br><span class="line">* 特殊情况</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="literal">true</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="literal">false</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="literal">null</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">** 特殊情况: 转换对象时先调用对象的toString方法</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>([]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>([<span class="number">1</span>]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>([<span class="number">1</span>, <span class="number">2</span>]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(&#123;&#125;))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(&#123;<span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;))</span><br></pre></td></tr></table></figure>
<h6 id="isNaN">isNaN()</h6>
<p><strong>判断是否是一个&quot;非数字&quot;</strong></p>
<blockquote>
<p>在判断之前 底层调用Number()方法对数据进行转换</p>
<p>然后再对返回的结果进行 =&gt; 是否是一个 “非数字”</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="number">1</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="number">1.2</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;1.2&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;1.2.3&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;1x&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;x1&#x27;</span>))</span><br><span class="line"></span><br><span class="line">特殊</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="literal">true</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="literal">false</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="literal">undefined</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="title class_">NaN</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="literal">null</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>([]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">特特殊</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>([<span class="number">1</span>]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>([<span class="number">1</span>, <span class="number">2</span>]))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(&#123;&#125;))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">isNaN</span>(&#123;<span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;))</span><br></pre></td></tr></table></figure>
<h6 id="parseInt">parseInt()</h6>
<blockquote>
<p>解析一个字符串并返回指定基数的十进制整数，它没有Number严格</p>
<p>1、如果第一个字符是数字会开始解析 直到遇到非数字才会停止解析</p>
<p>2、如果第一个数字是非数字字符 直接返回NaN</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一般都是用来取整</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="number">1.2</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;1.2.3&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;1x&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;x1&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h6 id="parseFloat">parseFloat()</h6>
<blockquote>
<p>可以把任意类型转成浮点数</p>
<p>parseFloat会解析第一个小数点 遇到第二个小数点 或者是非数字停止解析</p>
<p>parseFloat如果第一个是非数字 则返回NaN</p>
<p>如果解析的内容中只有整数 解析成整数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseFloat</span>(<span class="string">&#x27;1.23&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseFloat</span>(<span class="string">&#x27;1.2.3&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseFloat</span>(<span class="string">&#x27;1&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p><strong>小练习</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="built_in">parseFloat</span>(<span class="string">&#x27;top:10px&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span>(result == <span class="number">200</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">200</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(result == <span class="title class_">NaN</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NaN&#x27;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> result == <span class="string">&#x27;number&#x27;</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;number&#x27;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;other&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="built_in">parseFloat</span>(<span class="string">&#x27;1.6px&#x27;</span>) + <span class="built_in">parseInt</span>(<span class="string">&#x27;1.2px&#x27;</span>) + <span class="keyword">typeof</span> <span class="built_in">parseInt</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result) </span><br></pre></td></tr></table></figure>
<h6 id="toString-String">toString() &amp;&amp; String()</h6>
<blockquote>
<p>把指定参数对象转成字符串</p>
<p>注意：null，undefined不能调用toString()</p>
</blockquote>
<p><strong>情况一</strong>：对象.toString() =&gt; Object.prototype.toString() =&gt; 并不是用来转成字符串的 =&gt; 而是用来检测数据类型的 =&gt; [object 所属类信息]</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">注: 在控制台发现&#123;&#125;会被当作一个代码块而不是一个对象</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125; + <span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((&#123;&#125;) + <span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((&#123;&#125; + <span class="number">0</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> + &#123;&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> + [])</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> + [<span class="number">1</span>])</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> + [<span class="number">1</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<p><strong>情况二</strong>：数组.toString() =&gt; 数组也是对象，所以应该调用Object.prototype.toString()</p>
<p>但是因为数组对toString()方法进行了重写自身原型上有toString()方法</p>
<p>所以根据原型链的查找规则，先用自身的 =&gt; Array.prototype.toString() =&gt; 转字符串</p>
<p>如果数组需要使用Object的toString()来检测其数据类型 可以使用call方法</p>
<p>这种检测数据类型的方式 也是开发中用的最多的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object.prototype.toString.call([]) =&gt; [object Array]</span><br></pre></td></tr></table></figure>
<p><strong>情况三</strong>：除了对象和数组以外，其它数据类型.toString()都是直接加上&quot;&quot;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="number">1</span>).<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((<span class="literal">false</span>).<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span>.<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">undefined</span>.<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">String</span>(<span class="literal">null</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">String</span>(<span class="literal">undefined</span>))</span><br></pre></td></tr></table></figure>
<p>注：对象转数字 需要先调用toString() 转成字符串 再去转数字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">66</span>] == <span class="number">66</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">66</span>] === <span class="number">66</span>)</span><br></pre></td></tr></table></figure>
<p><strong>小练习</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="built_in">isNaN</span>(!!<span class="title class_">Number</span>(<span class="built_in">parseInt</span>(<span class="string">&quot;0.1&quot;</span>)))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="keyword">typeof</span> !<span class="built_in">parseInt</span>(<span class="literal">null</span>) + !<span class="built_in">isNaN</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="number">10</span> + <span class="literal">false</span> + <span class="literal">undefined</span> + [] + <span class="string">&#x27;Tencent&#x27;</span> + <span class="literal">null</span> + <span class="literal">true</span> + &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="number">10</span> + <span class="literal">false</span> + <span class="literal">undefined</span> + [] + +<span class="string">&#x27;Tencent&#x27;</span> + <span class="literal">null</span> + <span class="literal">true</span> + &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure>
<h6 id="Boolean-2">Boolean</h6>
<p>除了undefined、null、0、‘’、NaN转为false以外，其它的都为true</p>
<p>将一个数据转成boolean类型的两种方式:  Boolean(数据) 或者 !!数据</p>
<h5 id="隐式类型转换">隐式类型转换</h5>
<h6 id="转换为String">转换为String</h6>
<p>算法运算符（+）， 任何值和字符串做 + 时，都会先转换为字符串，然后再和字符串做拼串操作；多个值 + 时 ，从左向右运算，注意数值类型；</p>
<p>可以利用这一特点，来将任意数据类型转换为String，只需（任意字符串 + “”）即可转换为String；这是一种隐式类型转换，由浏览器自动完成，实际上也是调用了String()函数；</p>
<h6 id="转换为Number">转换为Number</h6>
<p>算法运算符（- * / %），任何值做 - * /，都会将其转换为Number，再做运算；可以利用这一特点，来将任意数据类型转换为Number，只需（任意字符串 - 0）（任意字符串 * 1）（任意字符串 / 1）即可转换为Number，这是一种隐式类型转换，由浏览器自动完成，实际上也是调用了Number()函数；</p>
<p>一元运算符（+(正号) ），对于非Number类型的值，它会先转换为Number，然后再运算；可以对一个其他数据类型使用+，来将其转换为number，隐式类型转换，它的原理和Number()函数一样；</p>
<h6 id="转换为Boolean">转换为Boolean</h6>
<p>逻辑计算符（!非），! 对一个布尔值做取反运算；如果对非布尔值取反，则会将其转换为布尔值，再取反；可以利用其特点，将其他数据类型取两次反，转换为布尔值；原理和Boolean()一样；</p>
<h6 id="字符串和数字">字符串和数字</h6>
<p>字符串加数字，数字就会转成字符串。</p>
<p>数字减字符串，字符串转成数字。</p>
<p>如果字符串不是纯数字就会转成NaN。字符串减数字也一样。两个字符串相减也先转成数字。</p>
<p>乘，除，大于，小于跟减的转换也是一样。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>+<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>-<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span>-<span class="string">&#x27;kkb&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span>-<span class="string">&#x27;10a&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span>*<span class="string">&#x27;20&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;10&#x27;</span>*<span class="string">&#x27;20&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>/<span class="string">&#x27;1&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>/<span class="string">&#x27;1&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>/<span class="string">&#x27;kkb&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h6 id="隐式转换规则">== 隐式转换规则</h6>
<p>【类型一致】</p>
<p>{} == {}: false =&gt; 比较的是堆内存中的地址值</p>
<p>[] == []: false =&gt; 比较的是堆内存中的地址值</p>
<p>NaN == NaN: false =&gt; NaN和任何数据类型都不相等包括它本身</p>
<p>undefined == undefined: true</p>
<p>null == null: true</p>
<p>【类型不一致】</p>
<p>1、null == undefined: true, 如果换成 === 结果就是false (因为类型不一致)</p>
<p>剩下的null/undefined和其它任何数据类型都不相等 除了它本身</p>
<p>2、字符串 == 对象 要将对象转成字符串</p>
<p>3、剩下的情况：如果 == 两遍类型不一致 都需要转成数字进行比较</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;0&#x27;</span> == <span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;0&#x27;</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">undefined</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([] == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(![] == <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>注：在循环或者条件判断中，条件处理的结果就是布尔类型值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span>(flag)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)&#125;</span><br></pre></td></tr></table></figure>
<h5 id="数据类型检测">数据类型检测</h5>
<h6 id="typeof">typeof</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">作用：<span class="keyword">typeof</span>校验数据类型 返回一个字符串</span><br><span class="line">基本数据类型</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="number">1</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">NaN</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="string">&#x27;1&#x27;</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">true</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">undefined</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="number">123n</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Symbol</span>(<span class="number">1</span>)) </span><br><span class="line">引用数据类型</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> []) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> &#123;&#125;) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> /[a-z]/) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Date</span>()) </span><br><span class="line">特殊</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> fn) </span><br><span class="line">[总结]</span><br><span class="line"><span class="keyword">typeof</span> 的返回类型为字符串，值有：number、boolean、string、object、<span class="keyword">function</span>、<span class="literal">undefined</span>、symbol、bigint</span><br><span class="line">[局限性]:<span class="keyword">typeof</span> 判断引用数据类型时 除了判断函数会输出<span class="string">&quot;function&quot;</span> 其它都是输出<span class="string">&quot;object&quot;</span> 所以一般只用来判断基本数据类型 判断引用数据类型的结果只作参考</span><br></pre></td></tr></table></figure>
<h6 id="instanceof">instanceof</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">作用: 用于检测构造函数中的原型(prototype)属性是否出现在某个实例对象的原型链上</span><br><span class="line">【局限性】</span><br><span class="line"><span class="number">1</span>、原型的指向可以任意更改 所以这种方式的返回结果不一定准确 实际开发中也可以参考</span><br><span class="line"><span class="number">2</span>、无法检测基本数据类型 因为基本数据连对象都不是 所以不存在__proto__ 也没有原型链 </span><br><span class="line">   - 如果非要检测 就将基本数据类型包装下</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([] <span class="keyword">instanceof</span> <span class="title class_">Array</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Array</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Object</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([] <span class="keyword">instanceof</span> <span class="title class_">Object</span>) </span><br><span class="line"></span><br><span class="line">[局限性<span class="number">1</span>]</span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">__proto__</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Object</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Array</span>) </span><br><span class="line"><span class="comment">// 更改原型指向</span></span><br><span class="line">obj.<span class="property">__proto__</span> = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">__proto__</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Array</span>)</span><br><span class="line"></span><br><span class="line">[局限性<span class="number">2</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span> <span class="keyword">instanceof</span> <span class="title class_">Number</span>)</span><br><span class="line">包装</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">1</span>) <span class="keyword">instanceof</span> <span class="title class_">Object</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">1</span>) <span class="keyword">instanceof</span> <span class="title class_">Number</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">1</span>) <span class="keyword">instanceof</span> <span class="title class_">String</span>)</span><br><span class="line"></span><br><span class="line">[注意]</span><br><span class="line"><span class="keyword">instanceof</span> 用来判断对象，代码形式为 【obj1 <span class="keyword">instanceof</span> obj2】（obj2 必须为对象，否则会报错！）</span><br><span class="line"><span class="keyword">instanceof</span>只能用来判断两个对象是否属于实例关系， 而不能判断一个对象实例具体属于哪种类型</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">9</span> <span class="keyword">instanceof</span> <span class="title class_">Number</span>);                </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">true</span> <span class="keyword">instanceof</span> <span class="title class_">Boolean</span>);                </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;libo&#x27;</span> <span class="keyword">instanceof</span> <span class="title class_">String</span>);              </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([] <span class="keyword">instanceof</span> <span class="title class_">Array</span>);                   </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Function</span>);      </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Object</span>);                  </span><br><span class="line"><span class="comment">// 注意以下两组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>);                   </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> <span class="keyword">instanceof</span> <span class="title class_">Object</span>);                 </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">NaN</span>);                            </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> <span class="keyword">instanceof</span> <span class="title class_">Number</span>);     </span><br></pre></td></tr></table></figure>
<h6 id="constructor">constructor</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">作用: 用于检测实例对象是否是由某个构造函数实例化出来的</span><br><span class="line">【局限性】</span><br><span class="line"><span class="number">1</span>、构造器的指向可以任意更改 所以这种方式的返回结果不一定准确 实际开发中也可以参考</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">__proto__</span>.<span class="property">constructor</span> == <span class="title class_">Object</span>) </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">__proto__</span>.<span class="property">constructor</span> == <span class="title class_">Array</span>)</span><br><span class="line">修改构造器的指向</span><br><span class="line">obj.<span class="property">__proto__</span>.<span class="property">constructor</span> = <span class="literal">null</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">__proto__</span>.<span class="property">constructor</span> == <span class="title class_">Object</span>) </span><br></pre></td></tr></table></figure>
<h6 id="Object-prototype-toString-call">Object.prototype.toString.call()</h6>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分三种情况:</span></span><br><span class="line"><span class="comment">// 1、检测Object =&gt; 格式: [object 所属类的信息(大写)] =&gt; [object Object]</span></span><br><span class="line"><span class="comment">// 2、检测其它引用类型 .call</span></span><br><span class="line"><span class="comment">// 3、基本数据类型 =&gt; 转字符串</span></span><br><span class="line"><span class="comment">// var obj = &#123;name: &#x27;zs&#x27;&#125;</span></span><br><span class="line"><span class="comment">// console.log(Object.prototype.toString(obj)) // [object Object]</span></span><br><span class="line"><span class="comment">// var arr = [1,2,3]</span></span><br><span class="line"><span class="comment">// console.log(Object.prototype.toString(arr)) // [object Object]</span></span><br><span class="line"><span class="comment">// 其它引用类型记得.call</span></span><br><span class="line"><span class="comment">// console.log(Object.prototype.toString.call(arr)) // [object Array]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 特殊情况 =&gt; 数组调用的不是Object原型上的toString 而是自身重写了toString方法</span></span><br><span class="line"><span class="comment">// 数组toString方法的实现</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// var str = &#x27;&#x27;</span></span><br><span class="line">  <span class="comment">// for (var i = 0; i &lt; this.length - 1; i++) &#123;</span></span><br><span class="line">  <span class="comment">//   str += this[i] + &#x27;,&#x27;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// // 拼接最后一项</span></span><br><span class="line">  <span class="comment">// str += this[this.length - 1]</span></span><br><span class="line">  <span class="comment">// return str</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> arr.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure>
<h4 id="堆栈内存"><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/27534451">堆栈内存</a></h4>
<p>栈： 是一种连续储存的数据结构，具有<strong>先进后出</strong>、<strong>后进先出</strong>的性质。<br>
栈内的元素只能通过列表的一端访问，这一端称为栈顶。由于栈具有先进后出的特点，所有任何不在栈顶的元素都无法访问。</p>
<p>堆： 是一种非连续的树形储存的数据结构，具有<strong>队列优先</strong>，<strong>先进先出</strong>的性质。<br>
  每个节点有一个值，整棵树是经过排序的。特点是根结点的值最小（或最大），且根结点的两个子树也是一个堆。常用来实现优先队列，存取随意。</p>
<p><strong>优点：</strong></p>
<p>​	动态分配内存大小，&quot; 按需分配 &quot;</p>
<p><strong>缺点：</strong></p>
<p>​	由于要在运行时才动态分配内存，相比于栈内存，它的存取速度较慢。</p>
<p><img data-src="image-20230711145722189.png" alt=""></p>
<ul>
<li>GO：全局对象（Global Object）</li>
<li>ECStack：执行环境栈（Excution Context Stack）</li>
<li>EC：执行环境（Excution Context）又称：执行上下文
<ul>
<li>VO：Varibale Object 变量对象</li>
<li>AO：Active Object 活动对象</li>
</ul>
</li>
<li>Scope：作用域，创建函数时就确定的</li>
<li>ScopeChain：作用域链</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基础</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">let</span> b = a;</span><br><span class="line">b = <span class="number">13</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// 12</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = &#123; <span class="attr">n</span>: <span class="number">12</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> b = a;</span><br><span class="line">b[<span class="string">&#x27;n&#x27;</span>] = <span class="number">13</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">n</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = &#123; <span class="attr">n</span>: <span class="number">12</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> b = a;</span><br><span class="line">b = &#123; <span class="attr">n</span>: <span class="number">13</span> &#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">n</span>);</span><br></pre></td></tr></table></figure>
<p><img data-src="image-20230712172247421.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params">y</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">2</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">B</span>(<span class="params">z</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y + z)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> B</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> c = <span class="title function_">A</span>(<span class="number">2</span>)</span><br><span class="line"><span class="title function_">c</span>(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><img data-src="image-20230713103712327.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 阿里面试题</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line"> <span class="attr">n</span>: <span class="number">10</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> b = a;</span><br><span class="line">a.<span class="property">m</span> = a = &#123;</span><br><span class="line"> <span class="attr">n</span>: <span class="number">20</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">m</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br></pre></td></tr></table></figure>
<p><img data-src="image-20230713103807409.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 360面试题</span></span><br><span class="line"><span class="keyword">let</span> x = [<span class="number">12</span>, <span class="number">23</span>];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">y</span>) &#123;</span><br><span class="line">  y[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">  y = [<span class="number">100</span>];</span><br><span class="line">  y[<span class="number">1</span>] = <span class="number">200</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>(x);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br></pre></td></tr></table></figure>
<p><img data-src="image-20230713153153974.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 高德面试题</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">10</span></span><br><span class="line">~<span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  x = x || <span class="number">20</span> &amp;&amp; <span class="number">30</span> || <span class="number">40</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">&#125;()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 腾讯面试题</span></span><br><span class="line"><span class="keyword">let</span> x = [<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">  y = [<span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">~<span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">  x.<span class="title function_">push</span>(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">  x = x.<span class="title function_">slice</span>(<span class="number">0</span>);</span><br><span class="line">  x.<span class="title function_">push</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">  x = y;</span><br><span class="line">  x.<span class="title function_">push</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y)</span><br><span class="line">&#125;(x)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x, y)</span><br></pre></td></tr></table></figure>
<p><img data-src="image-20230713110817598.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;&#125;, </span><br><span class="line">b = <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">c = <span class="number">0</span>;</span><br><span class="line">a[b] = <span class="string">&#x27;JavaScript&#x27;</span>;</span><br><span class="line">a[c] = <span class="string">&#x27;HTML+CSS&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a[b]);</span><br><span class="line">====================</span><br><span class="line"><span class="keyword">let</span> a = &#123;&#125;,</span><br><span class="line">b = &#123; <span class="attr">n</span>: <span class="string">&#x27;1&#x27;</span> &#125;,</span><br><span class="line">c = &#123; <span class="attr">m</span>: <span class="string">&#x27;2&#x27;</span> &#125;</span><br><span class="line">a[b] = <span class="string">&#x27;JavaScript&#x27;</span>;</span><br><span class="line">a[c] = <span class="string">&#x27;HTML+CSS&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a[c]); </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a[b]); </span><br></pre></td></tr></table></figure>
<p><strong>拓展</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 严格模式下形参和实参不会建立映射关系</span></span><br><span class="line"><span class="comment">// 非严格模式下会建立 一旦建立arguments中的元素和形参</span></span><br><span class="line"><span class="comment">// 如果有一方改变 会影响另外一方</span></span><br><span class="line"><span class="comment">// function fn(x, y) &#123;</span></span><br><span class="line"><span class="comment">//   console.log(x, y, arguments)</span></span><br><span class="line"><span class="comment">//   arguments[0] = 666</span></span><br><span class="line"><span class="comment">//   console.log(x, y)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn(100, 200)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y, <span class="variable language_">arguments</span>)</span><br><span class="line">  <span class="variable language_">arguments</span>[<span class="number">0</span>] = <span class="number">666</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">100</span>, <span class="number">200</span>)</span><br></pre></td></tr></table></figure>
<h4 id="操作符">操作符</h4>
<p>运算符  operator</p>
<p>5 + 6</p>
<p>表达式  组成 操作数和操作符，会有一个结果</p>
<h5 id="算术运算符">算术运算符</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ - * / %  </span><br></pre></td></tr></table></figure>
<h5 id="一元运算符">一元运算符</h5>
<p>一元运算符：只有一个操作数的运算符</p>
<p>前置++</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="number">5</span>;</span><br><span class="line">++ num1; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num2 = <span class="number">6</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num1 + ++ num2);</span><br></pre></td></tr></table></figure>
<p>后置++</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="number">5</span>;</span><br><span class="line">num1 ++;    </span><br><span class="line"><span class="keyword">var</span> num2 = <span class="number">6</span> </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num1 + num2 ++);</span><br></pre></td></tr></table></figure>
<p>猜猜看</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>; <span class="keyword">var</span> b = ++a + ++a; <span class="variable language_">console</span>.<span class="title function_">log</span>(b);    </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>; <span class="keyword">var</span> b = a++ + ++a; <span class="variable language_">console</span>.<span class="title function_">log</span>(b);    </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>; <span class="keyword">var</span> b = a++ + a++; <span class="variable language_">console</span>.<span class="title function_">log</span>(b);    </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>; <span class="keyword">var</span> b = ++a + a++; <span class="variable language_">console</span>.<span class="title function_">log</span>(b);  </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">4</span>; <span class="keyword">var</span> b = (a++)+(++a)+(a*<span class="number">10</span>); <span class="variable language_">console</span>.<span class="title function_">log</span>(a,b);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;<span class="keyword">var</span> b= <span class="number">10</span>; <span class="keyword">var</span> c= <span class="number">10</span>;a = b++;c = --a;b = ++a;a = c-- ;<span class="variable language_">console</span>.<span class="title function_">log</span>(a,b,c);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>前置++：先加1，后参与运算<br>
后置++：先参与运算，后加1</p>
</blockquote>
<h5 id="逻辑运算符-布尔运算符">逻辑运算符(布尔运算符)</h5>
<pre><code>&amp;&amp; 与 两个操作数同时为true，结果为true，否则都是false
|| 或 两个操作数有一个为true，结果为true，否则为false
!  非  取反
</code></pre>
<h5 id="关系运算符-比较运算符">关系运算符(比较运算符)</h5>
<pre><code>&lt;  &gt;  &gt;=  &lt;= == != === !==
</code></pre>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">==与===的区别：==只进行值得比较，===类型和值同时相等，则相等</span><br><span class="line"><span class="keyword">var</span> result = <span class="string">&#x27;55&#x27;</span> == <span class="number">55</span>;  	<span class="comment">// true</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="string">&#x27;55&#x27;</span> === <span class="number">55</span>; 	<span class="comment">// false 值相等，类型不相等</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="number">55</span> === <span class="number">55</span>; 	<span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h5 id="赋值运算符">赋值运算符</h5>
<p>=   +=   -=   *=   /=   %=</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line"><span class="keyword">var</span> num = <span class="number">0</span>;</span><br><span class="line">num += <span class="number">5</span>;	<span class="comment">//相当于  num = num + 5;</span></span><br></pre></td></tr></table></figure>
<h5 id="运算符的优先级">运算符的优先级</h5>
<pre><code>优先级从高到底
	1. ()  优先级最高
	2. 一元运算符  ++   --   !
	3. 算数运算符  先*  /  %   后 +   -
	4. 关系运算符  &gt;   &gt;=   &lt;   &lt;=
	5. 相等运算符   ==   !=    ===    !==
	6. 逻辑运算符  先&amp;&amp;   后||
	7. 赋值运算符  = 
</code></pre>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 练习1：</span></span><br><span class="line"><span class="number">4</span> &gt;= <span class="number">6</span> || <span class="string">&#x27;人&#x27;</span> != <span class="string">&#x27;阿凡达&#x27;</span> &amp;&amp; !(<span class="number">12</span> * <span class="number">2</span> == <span class="number">144</span>) &amp;&amp; <span class="literal">true</span></span><br><span class="line"><span class="comment">// 练习2：</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line"><span class="number">5</span> == num / <span class="number">2</span> &amp;&amp; (<span class="number">2</span> + <span class="number">2</span> * num).<span class="title function_">toString</span>() === <span class="string">&#x27;22&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="作用域-2">作用域</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js的执行流程分为三个阶段</span></span><br><span class="line"><span class="comment">// 1、语法分析阶段</span></span><br><span class="line"><span class="comment">// =&gt; 基本的语法校验 如果校验到错误抛出 SyntaxError 程序停止执行</span></span><br><span class="line"><span class="comment">// 2、预解析阶段</span></span><br><span class="line"><span class="comment">// =&gt; 进入该阶段就相当于进入了全局执行环境</span></span><br><span class="line"><span class="comment">// =&gt; 每次调用函数就相当于进入了函数执行环境</span></span><br><span class="line"><span class="comment">// 执行环境定义了变量和函数有权访问的其他数据。</span></span><br><span class="line"><span class="comment">// 3、执行阶段</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 作用域: 作用域是可操作变量或函数的有效范围</span></span><br><span class="line"><span class="comment">// 全局作用域: 全局作用域的变量任何地方都可以访问 页面关闭变量才会销毁</span></span><br><span class="line"><span class="comment">// 局部(函数)作用域: 当前作用域内才能访问 函数执行完毕会被释放 内部的变量也会随之销毁</span></span><br><span class="line"><span class="comment">// 局部作用域可以访问全局作用域 反之不行</span></span><br><span class="line"><span class="comment">// 全局变量: 在函数外部定义的变量或在函数内部没有使用var声明的变量。</span></span><br><span class="line"><span class="comment">// 局部变量: 在函数内部定义的变量。</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   var a = 3;</span></span><br><span class="line"><span class="comment">//   a = a * 100;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"><span class="comment">// console.log(a); // ReferenceError: a is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   var a = 3;</span></span><br><span class="line"><span class="comment">//   a = a * 100;</span></span><br><span class="line"><span class="comment">//   console.log(a); // 300</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function f2() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a); // ReferenceError: a is not defined</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"><span class="comment">// f2();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   var local = 100;</span></span><br><span class="line"><span class="comment">//   local++;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;local= &quot; + local); // 101</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function f2() &#123;</span></span><br><span class="line"><span class="comment">//   local++;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"><span class="comment">// f2(); // local is not defined</span></span><br><span class="line"><span class="comment">// console.log(&quot;local= &quot; + local);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// var global = 100;</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   global++;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function f2() &#123;</span></span><br><span class="line"><span class="comment">//   global++;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"><span class="comment">// f2();</span></span><br><span class="line"><span class="comment">// console.log(global)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// var blogName = &quot;梦想天空&quot;;</span></span><br><span class="line"><span class="comment">// function doSomething() &#123;</span></span><br><span class="line"><span class="comment">//   var authorName = &quot;山边小溪&quot;;</span></span><br><span class="line"><span class="comment">//   // 隐式全局变量 =&gt; 作用域是全局的</span></span><br><span class="line"><span class="comment">//   blogName = &quot;梦想天空&quot;;</span></span><br><span class="line"><span class="comment">//   console.log(authorName);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// doSomething();</span></span><br><span class="line"><span class="comment">// console.log(blogName);</span></span><br><span class="line"><span class="comment">// console.log(authorName);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// var a = 3;</span></span><br><span class="line"><span class="comment">// b = 5,</span></span><br><span class="line"><span class="comment">// s = 10;</span></span><br><span class="line"><span class="comment">// function f(a, b) &#123;</span></span><br><span class="line"><span class="comment">//   // 声明形参a,b相当于在当前作用域下声明了a,b变量</span></span><br><span class="line"><span class="comment">//   // var a; var b;</span></span><br><span class="line"><span class="comment">//   a = a * 10; // 30</span></span><br><span class="line"><span class="comment">//   b = b * 10; // 50</span></span><br><span class="line"><span class="comment">//   var c = a + b; // 80</span></span><br><span class="line"><span class="comment">//   v = s * c; // 800</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f(a, b);</span></span><br><span class="line"><span class="comment">// console.log(&quot; v = &quot; + v); // 800</span></span><br><span class="line"><span class="comment">// console.log(&quot; a = &quot; + a); // 3</span></span><br><span class="line"><span class="comment">// console.log(&quot; b = &quot; + b); // 5</span></span><br><span class="line"><span class="comment">// console.log(&quot; c = &quot; + c); // c is not defiend</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// &#123;&#125;表示块级作用域 块级作用域中声明的变量无法被外界访问</span></span><br><span class="line"><span class="comment">// es5中并没有块级作用域的概念 但是函数除外</span></span><br><span class="line"><span class="comment">// es6有块级作用域的概念 通过let声明的变量有自己的独立作用域</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   var v = 100;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(&quot;v = &quot; + v);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// if (true) &#123;</span></span><br><span class="line"><span class="comment">//   var v = 100;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(&quot;v = &quot; + v);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// for (let i = 1; i &lt; 10; i++) &#123;&#125;</span></span><br><span class="line"><span class="comment">// console.log(&quot;i=&quot;+ i );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// function f1()&#123;</span></span><br><span class="line"><span class="comment">//   function f2()&#123;</span></span><br><span class="line"><span class="comment">//     console.dir(f2)</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   f2()</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// f1()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===========================</span></span><br><span class="line"><span class="comment">// 作用域链的查找规则: 就近原则 自己有的就用自己的 如果没有就沿着作用域链往父级作用域查找 直到找到全局作用域为止</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var i = 1;</span></span><br><span class="line"><span class="comment">// function fn1() &#123;</span></span><br><span class="line"><span class="comment">//   var i = 5;</span></span><br><span class="line"><span class="comment">//   var j = 20</span></span><br><span class="line"><span class="comment">//   function fn2() &#123;</span></span><br><span class="line"><span class="comment">//     var i = 10;</span></span><br><span class="line"><span class="comment">//     function fn3() &#123;</span></span><br><span class="line"><span class="comment">//       var j = 15;</span></span><br><span class="line"><span class="comment">//       console.log(i)</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     fn3();</span></span><br><span class="line"><span class="comment">//     console.log(i);</span></span><br><span class="line"><span class="comment">//     console.log(j);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   fn2();</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn1();</span></span><br><span class="line"><span class="comment">// console.log(i);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==========================</span></span><br><span class="line"><span class="comment">// 作用域的作用</span></span><br><span class="line"><span class="comment">// 限定变量或函数的可用性</span></span><br><span class="line"><span class="comment">// 提高了程序逻辑的局部性</span></span><br><span class="line"><span class="comment">// 减少名字冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// function fun() &#123;</span></span><br><span class="line"><span class="comment">//   var a = b = 100;</span></span><br><span class="line"><span class="comment">//   // b = 100 =&gt; 隐式全局变量</span></span><br><span class="line"><span class="comment">//   // var a = 100</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fun(); </span></span><br><span class="line"><span class="comment">// console.log(&quot;b = &quot; + b); // 100</span></span><br><span class="line"><span class="comment">// console.log(&quot;a = &quot; + a); // a is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==========================</span></span><br><span class="line"><span class="comment">// var a = 123;</span></span><br><span class="line"><span class="comment">// function fun(a) &#123;</span></span><br><span class="line"><span class="comment">//   // var a;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   a = 456;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fun(a);</span></span><br><span class="line"><span class="comment">// console.log(a); </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==========================</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">30</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  a = <span class="number">300</span>;</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="title function_">f2</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a); </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>
<h4 id="函数">函数</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// function getMax(x, y) &#123;</span></span><br><span class="line"><span class="comment">//   var max = Math.max(x, y)</span></span><br><span class="line"><span class="comment">//   console.log(max)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面这种写法和下面写法等价 上面更便捷</span></span><br><span class="line"><span class="comment">// let fn = new Function(&#x27;x&#x27;, &#x27;y&#x27;, &#x27;console.log(x+y)&#x27;)</span></span><br><span class="line"><span class="comment">// fn(1, 2)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">x, y</span>)&#123;&#125; <span class="comment">// fn</span></span><br><span class="line"><span class="comment">// let fn = function()&#123;&#125; // fn</span></span><br><span class="line"><span class="comment">// new Function() // anonymous</span></span><br><span class="line"><span class="comment">// fn = fn.bind() // bound fn</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(fn)</span><br><span class="line"><span class="comment">// 【arguments】: 实参列表 =&gt; 伪数组</span></span><br><span class="line"><span class="comment">// 【caller】: caller返回一个函数的引用，这个函数调用了当前的函数。</span></span><br><span class="line"><span class="comment">// 如果函数是由顶层调用的，则返回null</span></span><br><span class="line"><span class="comment">// 【callee】: callee返回正在执行的函数本身的引用 它是arguments的一个属性 可以用来递归匿名函数 </span></span><br><span class="line"><span class="comment">// name: 函数名</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// caller</span></span><br><span class="line"><span class="comment">// var a = function () &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a.caller);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var b = function () &#123;</span></span><br><span class="line"><span class="comment">//   console.log(b.caller)</span></span><br><span class="line"><span class="comment">//   a();</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// b();</span></span><br></pre></td></tr></table></figure>
<h4 id="柯里化">柯里化</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="递归">递归</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="闭包">闭包</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="预解析">预解析</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 预解析做了哪些事?</span></span><br><span class="line"><span class="comment">// 1、变量提升 将变量的声明提升到当前作用域的最顶端 赋值不提升</span></span><br><span class="line"><span class="comment">// 2、函数提升 将函数的声明提升到当前作用域的最顶端 调用不提升</span></span><br><span class="line"><span class="comment">// 3、...</span></span><br><span class="line"><span class="comment">// 函数提升优先于变量提升</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==== 变量提升 ==== </span></span><br><span class="line"><span class="comment">// var user = &#x27;zs&#x27;</span></span><br><span class="line"><span class="comment">// console.log(user) // &#x27;zs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(user) // undefined</span></span><br><span class="line"><span class="comment">// var user = &#x27;zs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// var user</span></span><br><span class="line"><span class="comment">// console.log(user) // undefined</span></span><br><span class="line"><span class="comment">// user = &#x27;zs&#x27;</span></span><br><span class="line"><span class="comment">// console.log(user) // &#x27;zs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==== 函数提升 ====</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数提升的顺序和原来的顺序保持一致</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;111&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;222&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;111&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;222&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========================</span></span><br><span class="line"><span class="comment">// 函数表达式的写法</span></span><br><span class="line"><span class="comment">// fn(); // fn is not a function</span></span><br><span class="line"><span class="comment">// var fn = function () &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// var fn</span></span><br><span class="line"><span class="comment">// fn(); // undefined()</span></span><br><span class="line"><span class="comment">// fn = function () &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======================</span></span><br><span class="line"><span class="comment">// var num = 10;</span></span><br><span class="line"><span class="comment">// console.log(user)</span></span><br><span class="line"><span class="comment">// var user = &#x27;张三&#x27;;</span></span><br><span class="line"><span class="comment">// console.log(num);</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// var num</span></span><br><span class="line"><span class="comment">// num = 10</span></span><br><span class="line"><span class="comment">// var user</span></span><br><span class="line"><span class="comment">// console.log(user)</span></span><br><span class="line"><span class="comment">// user = &#x27;张三&#x27;</span></span><br><span class="line"><span class="comment">// console.log(num)</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;您好!&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===================</span></span><br><span class="line"><span class="comment">// var fn = function fn() &#123;</span></span><br><span class="line"><span class="comment">//   var user = &#x27;张三&#x27;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;user&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(fn);</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   var user = &#x27;张三&#x27;</span></span><br><span class="line"><span class="comment">//   console.log(user);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// 函数先提升</span></span><br><span class="line"><span class="comment">// var fn</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   var user = &#x27;张三&#x27;</span></span><br><span class="line"><span class="comment">//   console.log(user);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn = function fn() &#123;</span></span><br><span class="line"><span class="comment">//   var user = &#x27;张三&#x27;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;user&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(fn);</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ========================</span></span><br><span class="line"><span class="comment">// var a = 100;</span></span><br><span class="line"><span class="comment">// function test() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   a = 10 // 隐式全局会将全局作用域下的同名变量覆盖</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// test();</span></span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// var a</span></span><br><span class="line"><span class="comment">// function test() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a); // 100</span></span><br><span class="line"><span class="comment">//   a = 10 // 隐式全局会将全局作用域下的同名变量覆盖</span></span><br><span class="line"><span class="comment">//   console.log(a); // 10</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// a = 100;</span></span><br><span class="line"><span class="comment">// test();</span></span><br><span class="line"><span class="comment">// console.log(a); // 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var a = 100;</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   var a = 5;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// a();</span></span><br><span class="line"><span class="comment">// var a = 300;</span></span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   var a = 50;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   var a = 5;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   var a = 50;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var a</span></span><br><span class="line"><span class="comment">// a = 100;</span></span><br><span class="line"><span class="comment">// // a(); // 100() =&gt; 报错</span></span><br><span class="line"><span class="comment">// a = 300; </span></span><br><span class="line"><span class="comment">// console.log(a); // 300</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(fn)</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;f1函数&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;f2函数&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;f1函数&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function fn() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&quot;f2函数&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(fn)</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"><span class="comment">// fn();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// function b() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   var a = 10;</span></span><br><span class="line"><span class="comment">//   function a() &#123; &#125;;</span></span><br><span class="line"><span class="comment">//   a = 100;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// b();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function b() &#123;</span></span><br><span class="line"><span class="comment">//   function a() &#123; &#125;;</span></span><br><span class="line"><span class="comment">//   var a</span></span><br><span class="line"><span class="comment">//   console.log(a); // 函数a</span></span><br><span class="line"><span class="comment">//   a = 10;</span></span><br><span class="line"><span class="comment">//   a = 100;</span></span><br><span class="line"><span class="comment">//   console.log(a); // 100</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// b();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var foo = 1;</span></span><br><span class="line"><span class="comment">// function bar() &#123;</span></span><br><span class="line"><span class="comment">//   if (!foo) &#123;</span></span><br><span class="line"><span class="comment">//     var foo = 10;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   console.log(foo);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// bar();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function bar() &#123;</span></span><br><span class="line"><span class="comment">//   var foo</span></span><br><span class="line"><span class="comment">//   if (!foo) &#123;</span></span><br><span class="line"><span class="comment">//     foo = 10;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   console.log(foo); // 10</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var foo</span></span><br><span class="line"><span class="comment">// foo = 1;</span></span><br><span class="line"><span class="comment">// bar();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"><span class="comment">// var a = 3;</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;f1&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;f2&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// a();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 报错 ==</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;f1&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// function a() &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;f2&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var a</span></span><br><span class="line"><span class="comment">// console.log(a); // a函数 =&gt; &#x27;f2&#x27;</span></span><br><span class="line"><span class="comment">// a = 3;</span></span><br><span class="line"><span class="comment">// console.log(a); // 3</span></span><br><span class="line"><span class="comment">// a(); // 报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// function test(a, b) &#123;</span></span><br><span class="line"><span class="comment">//   console.log(a); </span></span><br><span class="line"><span class="comment">//   console.log(b); </span></span><br><span class="line"><span class="comment">//   var b = 234; </span></span><br><span class="line"><span class="comment">//   console.log(b);</span></span><br><span class="line"><span class="comment">//   a = 123; </span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   function a() &#123; &#125; </span></span><br><span class="line"><span class="comment">//   var a; b = 234; </span></span><br><span class="line"><span class="comment">//   var b = function () &#123; &#125;</span></span><br><span class="line"><span class="comment">//   console.log(a); </span></span><br><span class="line"><span class="comment">//   console.log(b);</span></span><br><span class="line"><span class="comment">// &#125; </span></span><br><span class="line"><span class="comment">// test(1);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function test(a, b) &#123;</span></span><br><span class="line"><span class="comment">//   // var a =&gt; 1</span></span><br><span class="line"><span class="comment">//   // var b</span></span><br><span class="line"><span class="comment">//   function a() &#123; &#125;  </span></span><br><span class="line"><span class="comment">//   console.log(a); // 1</span></span><br><span class="line"><span class="comment">//   console.log(b); // undefined</span></span><br><span class="line"><span class="comment">//   b = 234; </span></span><br><span class="line"><span class="comment">//   console.log(b); // 234</span></span><br><span class="line"><span class="comment">//   a = 123; </span></span><br><span class="line"><span class="comment">//   console.log(a); // 123</span></span><br><span class="line"><span class="comment">//   b = 234; </span></span><br><span class="line"><span class="comment">//   b = function () &#123; &#125;</span></span><br><span class="line"><span class="comment">//   console.log(a); // 123</span></span><br><span class="line"><span class="comment">//   console.log(b); // 函数b</span></span><br><span class="line"><span class="comment">// &#125; </span></span><br><span class="line"><span class="comment">// test(1);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var a = 18;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   var b = 9;</span></span><br><span class="line"><span class="comment">//   console.log(a);</span></span><br><span class="line"><span class="comment">//   console.log(b);</span></span><br><span class="line"><span class="comment">//   var a = &#x27;123&#x27;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// == 转换 ==</span></span><br><span class="line"><span class="comment">// function f1() &#123;</span></span><br><span class="line"><span class="comment">//   var b</span></span><br><span class="line"><span class="comment">//   b = 9;</span></span><br><span class="line"><span class="comment">//   var a;</span></span><br><span class="line"><span class="comment">//   console.log(a); // undefined</span></span><br><span class="line"><span class="comment">//   console.log(b); // 9</span></span><br><span class="line"><span class="comment">//   a = &#x27;123&#x27;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var a</span></span><br><span class="line"><span class="comment">// a = 18;</span></span><br><span class="line"><span class="comment">// f1();</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">f1</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = b = c = <span class="number">9</span>;</span><br><span class="line">  <span class="comment">// var a = 9</span></span><br><span class="line">  <span class="comment">// b = 9</span></span><br><span class="line">  <span class="comment">// c = 9</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="String-2"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String">String</a></h4>
<p><strong>练习</strong></p>
<p>1、&quot;abcoefoxyozzopp&quot;查找字符串中所有o出现的位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;abcoefoxyozzopp&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> array = [];</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> index = s.<span class="title function_">indexOf</span>(<span class="string">&#x27;o&#x27;</span>, index + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">    array.<span class="title function_">push</span>(index);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (index &gt; -<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(array);</span><br></pre></td></tr></table></figure>
<p>2、把字符串中所有的o替换成!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;abcoefoxyozzopp&#x27;</span>;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  s = s.<span class="title function_">replace</span>(<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (s.<span class="title function_">indexOf</span>(<span class="string">&#x27;o&#x27;</span>) &gt; -<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="title function_">replace</span>(<span class="regexp">/o/ig</span>, <span class="string">&#x27;&#x27;</span>));</span><br></pre></td></tr></table></figure>
<p>3、判断一个字符串中出现次数最多的字符，统计这个次数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;abcoefoxyozzopp&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; s.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">var</span> item = s.<span class="title function_">charAt</span>(i);</span><br><span class="line">  <span class="keyword">if</span> (o[item]) &#123;</span><br><span class="line">    o[item] ++;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    o[item] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> char ;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> o) &#123;</span><br><span class="line">  <span class="keyword">if</span> (max &lt; o[key]) &#123;</span><br><span class="line">    max = o[key];</span><br><span class="line">    char = key;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(max);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(char);</span><br></pre></td></tr></table></figure>
<p>4、声明：var str= “<a target="_blank" rel="noopener" href="http://localhost/mylive.php?id=99&amp;key=%E5%8F%8C11%E7%89%B9%E6%83%A0&amp;age=20">http://localhost/mylive.php?id=99&amp;key=双11特惠&amp;age=20</a>”;<br>
要求返回结果是：<br>
1）数组 [“99”,“双11特惠”,“20”]<br>
2）对象 {id: “99”, key: “双11特惠”, age: “20”}</p>
<p>5、写一段程序,实现将字符串反转。<br>
如 var str = ”I love Javascript”; 反转后的字符串为 “Javascript love I”</p>
<p>6、将get-element-by-id 转成 getElementById</p>
<h4 id="Array-2"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></h4>
<h4 id="Object-2"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></h4>
<h4 id="this指向">this指向</h4>
<p><strong>函数的上下文</strong>(this关键字) 由调用函数的方式决定</p>
<p>函数如果不调用 就不能确定函数的上下文</p>
<hr>
<p>规则1: 对象打点调用它的方法函数 则函数上下文是这个打点的对象<br>
语法: 对象.方法()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.<span class="title function_">fn</span>()</span><br></pre></td></tr></table></figure>
<p>函数的this指向不是由定义在哪决定的 而是由谁调用决定的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>) </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">fn</span>: obj1.<span class="property">fn</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj2.<span class="title function_">fn</span>()</span><br><span class="line"></span><br><span class="line">=============</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">2</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>) </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>().<span class="title function_">foo</span>()</span><br><span class="line"></span><br><span class="line">=============</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">a</span>: <span class="number">3</span>,</span><br><span class="line">      <span class="attr">b</span>: <span class="number">4</span>,</span><br><span class="line">      <span class="attr">c</span>: fn</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">5</span></span><br><span class="line">obj.<span class="property">c</span>[<span class="number">0</span>].<span class="title function_">c</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>规则2: 圆括号直接调用函数 则函数的上下文是window对象</p>
<p>通过var声明的变量会挂载到window上</p>
<p>开启严格模式 =&gt; this =&gt; undefined</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">20</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>()</span><br><span class="line"></span><br><span class="line">=============</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) </span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// var声明的变量会挂载到window上</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="title function_">fn</span>(), </span><br><span class="line">  <span class="attr">c</span>: fn</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> res = obj.<span class="title function_">c</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(res) </span><br></pre></td></tr></table></figure>
<p>规则3: <strong>数组</strong>(类数组对象)遍历出函数进行调用 <strong>this指向就是该数组</strong>(类数组对象)</p>
<p>数组【下标】</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[<span class="number">3</span>]())</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>[<span class="number">0</span>])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>规则4: IIFE函数(自执行函数) this指向是window对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">============</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fun</span>: (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">a</span> </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a + <span class="variable language_">this</span>.<span class="property">a</span>) </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)()</span><br><span class="line">&#125;</span><br><span class="line">obj.<span class="title function_">fun</span>()    </span><br></pre></td></tr></table></figure>
<p>规则5: 定时器调用函数 this指向是window</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timeId = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"><span class="built_in">clearTimeout</span>(timeId)</span><br><span class="line"></span><br><span class="line">==============</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fun</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">3</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">4</span></span><br><span class="line"><span class="built_in">setTimeout</span>(obj.<span class="property">fun</span>, <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">==============</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fun</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">3</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">4</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) </span><br><span class="line">  obj.<span class="title function_">fun</span>() </span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br></pre></td></tr></table></figure>
<p>规则6: 事件处理函数的this指向是绑定事件的dom元素</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dom元素.事件 = 事件处理函数</span><br><span class="line">实现效果: 三个div, 点击哪个哪个变红, 要求使用同一个事件处理函数实现</span><br></pre></td></tr></table></figure>
<p>规则7: 类(构造函数)里面的this指向通过该类(构造函数)创建的实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;zs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">  	<span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;zs&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>规则8：箭头函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 箭头函数中的this指向的是定义时的this，而不是执行时的this</span></span><br><span class="line"><span class="comment">// 箭头函数中不绑定this，箭头函数中的this指向是它所定义的位置，可以简单理解成，定义箭头函数中的作用域的this指向谁，它就指向谁</span></span><br><span class="line"><span class="comment">// 箭头函数的优点在于解决了this执行环境所造成的一些问题。比如：解决了匿名函数this指向的问题（匿名函数的执行环境具有全局性），包括setTimeout和setInterval中使用this所造成的问题</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;lisi&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">      <span class="attr">fn</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>) </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">obj.<span class="title function_">fn</span>()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;lisi&#x27;</span></span><br><span class="line">   <span class="keyword">var</span> obj = &#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">     <span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) </span><br><span class="line">       <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>) </span><br><span class="line">       &#125;</span><br><span class="line">       <span class="title function_">add</span>()</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">obj.<span class="title function_">fn</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = obj.<span class="property">fn</span></span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure>
<h4 id="源码分析">源码分析</h4>
<h5 id="new">new</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new关键字做了哪些事</span></span><br><span class="line"><span class="comment">// 1、申请一块空间 =&gt; 创建一个新对象</span></span><br><span class="line"><span class="comment">// 2、让新对象的__proto__指向构造函数的原型对象</span></span><br><span class="line"><span class="comment">// 3、确认this指向</span></span><br><span class="line"><span class="comment">// 4、调用构造函数初始化属性</span></span><br><span class="line"><span class="comment">// 5、返回新对象</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="comment">// return &#123;name: &#x27;ls&#x27;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hi&#x27;</span>)&#125;</span><br><span class="line"><span class="comment">// let p = new Person(&#x27;zs&#x27;)</span></span><br><span class="line"><span class="comment">// console.log(p)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mockNew</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 1、创建新对象</span></span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line">  <span class="comment">// 2、让新对象的__proto__指向构造函数的原型对象</span></span><br><span class="line">  <span class="comment">// 获取第一个参数作为构造函数</span></span><br><span class="line">  <span class="keyword">let</span> constructor = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">shift</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>)</span><br><span class="line">  <span class="comment">// 继承原型上的成员</span></span><br><span class="line">  obj.<span class="property">__proto__</span> = constructor.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line">  <span class="comment">// 3、确认this指向 (构造函数中的this指向实例对象)</span></span><br><span class="line">  <span class="comment">// 4、调用构造函数初始化属性</span></span><br><span class="line">  <span class="keyword">let</span> res = constructor.<span class="title function_">apply</span>(obj, <span class="variable language_">arguments</span>)</span><br><span class="line">  <span class="comment">// 5、返回新对象</span></span><br><span class="line">  <span class="keyword">return</span> res <span class="keyword">instanceof</span> <span class="title class_">Object</span> ? res : obj</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="title function_">mockNew</span>(<span class="title class_">Person</span>, <span class="string">&#x27;zs&#x27;</span>, <span class="number">18</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">name</span>)</span><br><span class="line">p.<span class="title function_">sayHi</span>()</span><br></pre></td></tr></table></figure>
<h5 id="call">call</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// call(this, arg1, arg2 ...)</span></span><br><span class="line"><span class="comment">// 改变this指向 立即执行函数</span></span><br><span class="line"><span class="comment">// 如果第一个参数没传 || 传的是null || 传的是undefined =&gt; this指向都是window</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// context: 需要被修改的this指向</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">call</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="comment">// this指向的判断</span></span><br><span class="line">  <span class="comment">// context = String &#123;&#x27;1&#x27;&#125;</span></span><br><span class="line">  context = context ? <span class="title class_">Object</span>(context) : <span class="variable language_">window</span></span><br><span class="line">  <span class="comment">// 更改this指向</span></span><br><span class="line">  <span class="comment">// String &#123;&#x27;1&#x27;&#125;.fn = fn1</span></span><br><span class="line">  context.<span class="property">fn</span> = <span class="variable language_">this</span></span><br><span class="line">  <span class="keyword">let</span> arr = []</span><br><span class="line">  <span class="variable language_">arguments</span> = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>).<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(<span class="string">&#x27;arguments[&#x27;</span> + i + <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="built_in">eval</span>(<span class="string">&#x27;context.fn(&#x27;</span> + arr + <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">  <span class="keyword">delete</span> context.<span class="property">fn</span></span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// fn1.call(null, 1, 2)</span></span><br><span class="line"><span class="comment">// fn1.call(&#x27;1&#x27;, 1, 2)</span></span><br><span class="line"><span class="comment">// fn1.call(fn2, 1, 2)</span></span><br><span class="line"><span class="comment">// fn1.call.call(fn2) </span></span><br><span class="line"><span class="comment">// fn1.call.call.call(fn2) // window arguments[]</span></span><br><span class="line"><span class="comment">// fn1.call.call.call(fn2, 1) // Number &#123;1&#125; arguments[]</span></span><br><span class="line"><span class="comment">// fn1.call.call.call(fn2, 1, 2) // Number &#123;1&#125; arguments[2]</span></span><br><span class="line"><span class="comment">// fn1.call.call.call 并没有调用, 只是链式获取对象的call属性, 所以这一串的结果是Function.call 属性。</span></span><br><span class="line"><span class="comment">// 所以那一串就是 Function.call.call(fn2) 可以解理为 fn3(假设).call(fn2)。</span></span><br><span class="line"><span class="comment">// 根据call的原理（可参考上面的call模拟），在fn3执行call，其实际是fn2.fn3()。</span></span><br><span class="line"><span class="comment">// 由于 fn3实际上就是 call 函数，所以, fn2.fn3() 等价于 fn2.call()。</span></span><br><span class="line"><span class="comment">// 所以最终结果, 就是调用 fn2.call() =&gt;　所以结果输出 this =&gt; window</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// call的应用场景</span></span><br><span class="line"><span class="comment">// 伪数组</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="number">0</span>: <span class="number">111</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="number">222</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="number">333</span>,</span><br><span class="line">  <span class="attr">length</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// obj[obj.length] = 444</span></span><br><span class="line"><span class="comment">// obj.length ++</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// call借用数组的push方法</span></span><br><span class="line"><span class="comment">// Array.prototype.push.call(obj, 444)</span></span><br><span class="line"><span class="comment">// console.log(obj)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数列表的个数和类型取决于借用的方法的参数</span></span><br><span class="line"><span class="comment">// console.log(Object.prototype.toString.call([]))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// es5继承中 子级借用父级构造函数初始化自身的属性</span></span><br></pre></td></tr></table></figure>
<h5 id="apply-2">apply</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// apply(this, [arg1, arg2...])</span></span><br><span class="line"><span class="comment">// 改变this指向 立即执行函数</span></span><br><span class="line"><span class="comment">// 如果第一个参数没传 || 传的是null || 传的是undefined =&gt; this指向都是window</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span> = <span class="keyword">function</span> (<span class="params">context, args</span>) &#123;</span><br><span class="line">  <span class="comment">// this指向的判断</span></span><br><span class="line">  context = context ? <span class="title class_">Object</span>(context) : <span class="variable language_">window</span></span><br><span class="line">  <span class="comment">// 更改this指向</span></span><br><span class="line">  context.<span class="property">fn</span> = <span class="variable language_">this</span></span><br><span class="line">  <span class="comment">// 如果没有传入第二个参数</span></span><br><span class="line">  <span class="keyword">if</span>(!args) &#123;</span><br><span class="line">    <span class="comment">// 直接执行函数</span></span><br><span class="line">    context.<span class="title function_">fn</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="built_in">eval</span>(<span class="string">&#x27;context.fn(&#x27;</span> + args + <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">  <span class="keyword">delete</span> context.<span class="property">fn</span></span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line">fn1.<span class="title function_">apply</span>(<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// apply的应用场景</span></span><br><span class="line"><span class="comment">// let max = Math.max(1, 345, 212, 23, 234, 34)</span></span><br><span class="line"><span class="comment">// let max = Math.max(...[1, 345, 212, 23, 234, 34])</span></span><br><span class="line"><span class="keyword">let</span> max = <span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">1</span>, <span class="number">345</span>, <span class="number">212</span>, <span class="number">23</span>, <span class="number">234</span>, <span class="number">34</span>])</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(max)</span><br></pre></td></tr></table></figure>
<h5 id="bind">bind</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bind(this, arg1, arg2)</span></span><br><span class="line"><span class="comment">// 返回值是一个改变this上下文的函数 不会立即执行</span></span><br><span class="line"><span class="comment">// 返回的函数在调用时也可以传参 最终参数会合并</span></span><br><span class="line"><span class="comment">// 如果第一个参数没传 || 传的是null || 传的是undefined =&gt; this指向都是window</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">xx</span> = <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">  <span class="comment">// return 111</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  context = context ? <span class="title class_">Object</span>(context) : <span class="variable language_">window</span></span><br><span class="line">  <span class="keyword">let</span> that = <span class="variable language_">this</span> <span class="comment">// fn1</span></span><br><span class="line">  <span class="keyword">let</span> bindArgs = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>).<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">FBound</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> that.<span class="title function_">apply</span>(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">FBound</span> ? <span class="variable language_">this</span> : context, bindArgs.<span class="title function_">concat</span>(...<span class="variable language_">arguments</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 这种方式会直接改变FBound的原型</span></span><br><span class="line">  <span class="comment">// FBound.prototype = this.prototype</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">Fn</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="title class_">Fn</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="variable language_">this</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line">  <span class="title class_">FBound</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Fn</span>()</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">FBound</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let fn = fn1.bind(fn2, 2, 3)</span></span><br><span class="line"><span class="comment">// let res = fn(4, 5)</span></span><br><span class="line"><span class="comment">// console.log(res)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let fn = fn1.bind(obj, 1, 2)</span></span><br><span class="line"><span class="comment">// // fn()</span></span><br><span class="line"><span class="comment">// // 此时fn1中的this指向的是fn1的实例对象</span></span><br><span class="line"><span class="comment">// let res = new fn()</span></span><br><span class="line"><span class="comment">// console.log(res)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// fn1原型上添加的属性丢失问题</span></span><br><span class="line">fn1.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">age</span> = <span class="number">18</span></span><br><span class="line"><span class="keyword">let</span> fn = fn1.<span class="title function_">bind</span>(obj, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> res = <span class="keyword">new</span> <span class="title function_">fn</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">age</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// bind的应用</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// obj</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>) <span class="comment">// &#x27;&#x27;</span></span><br><span class="line">    &#125;.<span class="title function_">bind</span>(obj), <span class="number">2000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.<span class="title function_">fn</span>()</span><br></pre></td></tr></table></figure>
<h4 id="对象"><strong>对象</strong></h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">用js描述生活中的汽车</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;布加迪&#x27;</span></span><br><span class="line"><span class="keyword">var</span> price = <span class="number">999</span></span><br><span class="line"><span class="keyword">var</span> color = <span class="string">&#x27;black&#x27;</span></span><br><span class="line">如果使用基本数据类型描述对象 它所创建的变量都是独立 不能成为一个整体</span><br><span class="line"></span><br><span class="line">所以考虑用对象来描述</span><br><span class="line">对象是一种复合数据类型 在对象里面可以保存多个不同数据类型属性</span><br><span class="line">在对象中创建的变量都是从属于一个整体</span><br></pre></td></tr></table></figure>
<h5 id="对象的分类">对象的分类</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、内建(内置)对象</span><br><span class="line">   - 由<span class="variable constant_">JS</span>标准中定义的对象</span><br><span class="line">   - 比如: <span class="title class_">Math</span>、<span class="title class_">Date</span>、<span class="title class_">String</span>、<span class="title class_">Function</span>、<span class="title class_">Object</span>、<span class="title class_">Array</span>...</span><br><span class="line"><span class="number">2</span>、宿主对象</span><br><span class="line">   - 由<span class="variable constant_">JS</span>的运行环境提供的 (由浏览器提供的)</span><br><span class="line">   - <span class="variable constant_">DOM</span>、<span class="variable constant_">BOM</span>、<span class="title class_">Console</span></span><br><span class="line"><span class="number">3</span>、自定义对象</span><br><span class="line">   - 开发人员自己创建的对象</span><br></pre></td></tr></table></figure>
<h5 id="创建对象方式1">创建对象方式1</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不成文的规定</span><br><span class="line">首字母大写的函数是构造函数 =&gt; 用来配合<span class="keyword">new</span>关键字进行实例化对象的 =&gt; <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line">首字母小写的函数是普通函数 =&gt; 用来调用的 =&gt; <span class="title function_">sayHi</span>()</span><br><span class="line"><span class="number">1</span>、通过<span class="keyword">new</span>关键字调用js提供的<span class="title class_">Object</span>函数(构造函数)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Object</span>(<span class="params"></span>)&#123;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="new-关键字做了哪些事">new 关键字做了哪些事</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、在堆内存中申请一块空间 创建一个新对象&#123;&#125;</span><br><span class="line"><span class="number">2</span>、新对象的__proto__指向构造函数中的原型对象prototype</span><br><span class="line"><span class="number">3</span>、确认<span class="variable language_">this</span>指向 让上下文中<span class="variable language_">this</span>指向这个新对象</span><br><span class="line"><span class="number">4</span>、执行构造函数中的代码 初始化新对象</span><br><span class="line"><span class="number">5</span>、返回新对象 返回的是新对象的地址值 即便没有<span class="keyword">return</span> 构造函数也会默认返回<span class="variable language_">this</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line"><span class="comment">// 添加属性 =&gt; 语法: 对象.属性 = 属性值</span></span><br><span class="line">car.<span class="property">name</span> = <span class="string">&#x27;布加迪&#x27;</span></span><br><span class="line">car.<span class="property">price</span> = <span class="number">999</span></span><br><span class="line">car.<span class="property">color</span> = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line"><span class="comment">// 获取属性 =&gt; 语法: 对象.属性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">name</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">price</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">color</span>)</span><br><span class="line"><span class="comment">// 修改属性 =&gt; 语法: 对象.属性 = 新值</span></span><br><span class="line">car.<span class="property">name</span> = <span class="string">&#x27;劳斯莱斯&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">name</span>)</span><br><span class="line"><span class="comment">// 删除属性 =&gt; delete 对象.属性名</span></span><br><span class="line"><span class="keyword">delete</span> car.<span class="property">name</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">name</span>)</span><br><span class="line"><span class="comment">// 添加方法 =&gt; 对象.方法名 = 函数</span></span><br><span class="line">car.<span class="property">run</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;run ~&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用方法 =&gt; 对象.方法名()</span></span><br><span class="line">car.<span class="title function_">run</span>()</span><br><span class="line"><span class="comment">// 修改方法 =&gt; 对象.方法名 = 新函数</span></span><br><span class="line">car.<span class="property">run</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;new run ~&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">car.<span class="title function_">run</span>()</span><br><span class="line"><span class="comment">// 删除方法</span></span><br><span class="line"><span class="keyword">delete</span> car.<span class="property">run</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">run</span>) <span class="comment">// undefined</span></span><br><span class="line">car.<span class="title function_">run</span>() <span class="comment">// TypeError: car.run is not a function</span></span><br></pre></td></tr></table></figure>
<h5 id="工厂函数">工厂函数</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> car1 = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">car1.<span class="property">name</span> = <span class="string">&#x27;布加迪&#x27;</span></span><br><span class="line">car1.<span class="property">price</span> = <span class="number">999</span></span><br><span class="line">car1.<span class="property">color</span> = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> car2 = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">car2.<span class="property">name</span> = <span class="string">&#x27;布加迪&#x27;</span></span><br><span class="line">car2.<span class="property">price</span> = <span class="number">999</span></span><br><span class="line">car2.<span class="property">color</span> = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> car3 = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">car3.<span class="property">name</span> = <span class="string">&#x27;布加迪&#x27;</span></span><br><span class="line">car3.<span class="property">price</span> = <span class="number">999</span></span><br><span class="line">car3.<span class="property">color</span> = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 代码的重复度过高、复用性差 =&gt; 考虑封装 =&gt; 工厂函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createCar</span>(<span class="params">name, price, color</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> car = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line">  car.<span class="property">name</span> = name</span><br><span class="line">  car.<span class="property">price</span> = price</span><br><span class="line">  car.<span class="property">color</span> = color</span><br><span class="line">  car.<span class="property">run</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;run ~&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> car</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 发现问题 所以返回的对象属性值都是一样的</span></span><br><span class="line"><span class="comment">// 所以我们将工厂函数中的固定的属性值提取到函数的形参上</span></span><br><span class="line"><span class="comment">// 让调用者自行传递</span></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="title function_">createCar</span>(<span class="string">&#x27;布加迪&#x27;</span>, <span class="number">999</span>, <span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> c2 = <span class="title function_">createCar</span>(<span class="string">&#x27;劳斯莱斯&#x27;</span>, <span class="number">888</span>, <span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> c3 = <span class="title function_">createCar</span>(<span class="string">&#x27;宝马&#x27;</span>, <span class="number">777</span>, <span class="string">&#x27;white&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h5 id="创建对象方式2">创建对象方式2</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一种方式 new Object() 缺点: </span></span><br><span class="line"><span class="comment">// 1、代码复用性较差 =&gt; 工厂函数</span></span><br><span class="line"><span class="comment">// 2、无法判断实例化的对象具体属于什么类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> obj) <span class="comment">// object</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Object</span>) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toString</span>(obj)) <span class="comment">// [object Object]</span></span><br></pre></td></tr></table></figure>
<p><strong>自定义构造函数的方式创建对象</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3、自定义构造函数的方式创建对象</span></span><br><span class="line"><span class="comment">// 构造函数的声明也要遵循驼峰命名法</span></span><br><span class="line"><span class="comment">// 缺点: 构造函数中定义函数，那么每次创建对象，都会重新创建该函数,这样会导致全局变量增多,造成污染, 浪费内存</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">  <span class="comment">// 指向当前实例化对象</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age,</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">say</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sayHi ~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;zs&quot;</span>, <span class="number">18</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>)</span><br><span class="line">p1.<span class="title function_">say</span>()</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;ls&quot;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p2.<span class="property">age</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1 <span class="keyword">instanceof</span> <span class="title class_">Person</span>) <span class="comment">// true</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1 <span class="keyword">instanceof</span> <span class="title class_">Animal</span>) <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toString</span>(p1)) <span class="comment">// [object Object]</span></span><br></pre></td></tr></table></figure>
<h5 id="创建对象方式3">创建对象方式3</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">字面量的方式: 创建出来的对象是一次性的 复用性差 如果要创建多个对象，代码冗余度太高</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello ~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;ls&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br><span class="line">obj.<span class="title function_">fn</span>()</span><br></pre></td></tr></table></figure>
<h5 id="遍历对象">遍历对象</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello ~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// 使用对象[属性] 属性要写成字符串而不是变量</span></span><br><span class="line"><span class="comment">// 如果是变量则会到当前作用域中查找有没有该变量而不是对象中 没找到就报错</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"><span class="comment">// obj =&gt; 需要遍历的对象</span></span><br><span class="line"><span class="comment">// key =&gt; 键 =&gt; 对象的属性名</span></span><br><span class="line"><span class="comment">// obj[key] =&gt; 值 =&gt; 对象属性对应的值</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="comment">// console.log(key) // name age fn</span></span><br><span class="line">  <span class="comment">// 如果使用.拼接 会到obj对象中去查找key属性 找不到则报undefined</span></span><br><span class="line">  <span class="comment">// console.log(obj.key)</span></span><br><span class="line">  <span class="comment">// 如果涉及到变量的拼接 不要使用.语法 要使用[]</span></span><br><span class="line">  <span class="comment">// []能做到的.不一定能做到 .能做到的[]一定能做到的</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(obj[key])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="构造函数">构造函数</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 1、构造函数就是一个普通的函数 创建方式和普通函数没什么区别</span></span><br><span class="line"><span class="comment"> * 唯一不同的就是构造函数首字母大写 多个单词遵循驼峰命名法</span></span><br><span class="line"><span class="comment"> * 2、构造函数和普通的调用方式的不同</span></span><br><span class="line"><span class="comment"> *    - 构造函数配合new关键是调用 =&gt; 创建对象的</span></span><br><span class="line"><span class="comment"> *    - 普通函数直接调用 =&gt; 执行函数中的代码</span></span><br><span class="line"><span class="comment"> * 3、new 关键字做了哪些事情 ?</span></span><br><span class="line"><span class="comment"> *    - 在堆内存中申请一块空间 创建一个新对象&#123;&#125;</span></span><br><span class="line"><span class="comment"> *    - 新对象的__proto__指向构造函数中的原型对象prototype</span></span><br><span class="line"><span class="comment"> *    - 确认this指向 让上下文中this指向这个新对象</span></span><br><span class="line"><span class="comment"> *    - 执行构造函数中的代码 初始化新对象</span></span><br><span class="line"><span class="comment"> *    - 返回新对象 返回的是新对象的地址值 即便没有return 构造函数也会默认返回this</span></span><br><span class="line"><span class="comment"> * 4、使用同一个构造函数创建的对象 我们称之为同一类对象 也会将构造函数称之为类</span></span><br><span class="line"><span class="comment"> *    - 通过构造函数创建的对象 我们称之为类的实例</span></span><br><span class="line"><span class="comment"> *    - 实例对象是由构造函数创建出来 这个创建的过程我们称之为实例化</span></span><br><span class="line"><span class="comment"> * 5、构造函数中的this指向当前实例化的对象</span></span><br><span class="line"><span class="comment"> * 6、instanceof用来检测一个对象是否某个类的实例</span></span><br><span class="line"><span class="comment"> *    - 对象 instanceof 构造函数名</span></span><br><span class="line"><span class="comment"> *    - 对象.__proto__.constructor == 构造函数名</span></span><br><span class="line"><span class="comment"> *    - 不管用什么构造函数 只要是实例化出来的对象 instanceof检测结果都为true</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(p) <span class="comment">// =&gt; constructor =&gt; ƒ Person()</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">__proto__</span>.<span class="property">constructor</span> == <span class="title class_">Person</span>) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">constructor</span> == <span class="title class_">Person</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p><strong>构造函数创建对象存在的问题</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var study = new Function(&#x27;console.log(&quot;good good study, day day up&quot;)&#x27;)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;good good study, day day up&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果将fn函数定义在全局的作用域下 则会污染全局作用域的命名空间</span></span><br><span class="line"><span class="comment">// 如果声明了和它一样名字的变量或者方法 则会将其覆盖</span></span><br><span class="line"><span class="comment">// 存在命名冲突的问题</span></span><br><span class="line"><span class="keyword">var</span> fn = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在Student中为每个实例化对象添加了一个study方法</span></span><br><span class="line"><span class="comment">// 每次实例化对象都会执行构造函数中的代码 创建一个函数对象</span></span><br><span class="line"><span class="comment">// 每个函数对象地址值都不一样(唯一的)</span></span><br><span class="line"><span class="comment">// 执行100次就创建100个函数对象、但函数中的内容又是一模一样的</span></span><br><span class="line"><span class="comment">// 我们能不能让所有实例共享同一个函数呢? =&gt; 将函数提取到构造函数外面</span></span><br><span class="line"><span class="comment">// 每次执行构造函数的代码都是将外面的fn函数赋值给this.study</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, age, sex</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sex</span> = sex</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">study</span> = fn</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stu1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;zs&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;man&#x27;</span>)</span><br><span class="line">stu1.<span class="title function_">study</span>()</span><br><span class="line"><span class="keyword">var</span> stu2 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;ls&#x27;</span>, <span class="number">16</span>, <span class="string">&#x27;woman&#x27;</span>)</span><br><span class="line">stu2.<span class="title function_">study</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu1.<span class="property">study</span> == stu2.<span class="property">study</span>) <span class="comment">// false =&gt; true</span></span><br></pre></td></tr></table></figure>
<h4 id="原型">原型</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原型 prototype</span></span><br><span class="line"><span class="comment">// 作用: </span></span><br><span class="line"><span class="comment">// 1、数据共享 节省了内存空间 避免了全局污染</span></span><br><span class="line"><span class="comment">// 2、模拟了类与类之间的关系</span></span><br><span class="line"><span class="comment">// 3、继承的前提</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型分类</span></span><br><span class="line"><span class="comment">// 1、我们所创建出来的每一个函数 js引擎都会向函数中添加一个属性 prototype</span></span><br><span class="line"><span class="comment">// 它对应的值就是一个对象 也就是我们说的原型对象 这个对象是标准的 给程序员使用的 显示原型</span></span><br><span class="line"><span class="comment">// 2、通过构造函数实例化的对象中也有一个属性 __proto__</span></span><br><span class="line"><span class="comment">// 它也是原型 它是不标准的 是给浏览器使用的 隐式原型 =&gt; 原型链的查找就是通过它</span></span><br><span class="line"><span class="comment">// 隐式原型指向显示原型的 =&gt; 所以所有实例化对象都能够直接访问到显示原型中的属性和方法</span></span><br><span class="line"><span class="comment">// 显示原型对象上有一个constructor属性 它指向的是该原型对象所在的构造函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型其实一个公共的对象 所有同一个类的实例都可以访问到这个原型对象</span></span><br><span class="line"><span class="comment">// 只要是需要共享的属性和方法 我们都统一设置到原型上</span></span><br><span class="line"><span class="comment">// 不需要为每一个实例化对象分别添加属性和方法 也不会影响到全局作用域 就可以使每个对象都具备原型上的属性和方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型对象、实例对象、构造函数三者之间的关系</span></span><br><span class="line"><span class="comment">// 1、实例对象是由构造函数实例化出来的</span></span><br><span class="line"><span class="comment">// 2、构造函数中有一个prototype属性 指向的是prototype原型对象 </span></span><br><span class="line"><span class="comment">// 在原型对象上有一个constructor属性 它指向是构造器 该构造器表示的是原型所在的构造函数</span></span><br><span class="line"><span class="comment">// 3、实例对象中有一个__proto__属性 指向的是实例化该对象的构造函数中的prototype原型对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果看到某个变量中有__proto__属性 那么它一定是一个对象</span></span><br><span class="line"><span class="comment">// 所有实例化对象都直接或者间接的继承了原型上的属性和方法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">say</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;听大家说高考数学卷很难 昨晚试了一下 两个小时后才发现试卷拿反了&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型上添加属性</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">score</span> = <span class="number">88</span></span><br><span class="line"><span class="comment">// 原型上添加方法</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;哥们你这睡眠质量不行 我一般都8小时后才发现&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;zs&#x27;</span>, <span class="number">18</span>)</span><br><span class="line"><span class="comment">// 访问私有的属性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu.<span class="property">name</span>)</span><br><span class="line"><span class="comment">// 访问私有的方法</span></span><br><span class="line">stu.<span class="title function_">say</span>()</span><br><span class="line"><span class="comment">// 访问原型上的属性</span></span><br><span class="line"><span class="comment">// console.log(stu.__proto__.score)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu.<span class="property">score</span>)</span><br><span class="line"><span class="comment">// 访问原型上的方法</span></span><br><span class="line"><span class="comment">// stu.__proto__.sayHi()</span></span><br><span class="line"><span class="comment">// 开发过程中__proto__可以省略不写</span></span><br><span class="line">stu.<span class="title function_">sayHi</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu2 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;ls&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="comment">// 两个实例访问的是同一个原型 所以使用的是同一个方法</span></span><br><span class="line"><span class="comment">// 比较私有的方法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu.<span class="property">say</span> == stu2.<span class="property">say</span>) <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 比较公有的方法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu.<span class="property">sayHi</span> == stu2.<span class="property">sayHi</span>) <span class="comment">// true</span></span><br><span class="line"><span class="comment">// 比较原型指向</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stu2.<span class="property">__proto__</span> == <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var obj1 = &#123;</span></span><br><span class="line"><span class="comment">//   name : &#x27;zs&#x27;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// var obj2 = obj1</span></span><br><span class="line"><span class="comment">// console.log(obj2.name)</span></span><br></pre></td></tr></table></figure>
<h5 id="Array原型">Array原型</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var arr1 = [1, 2, 3]</span></span><br><span class="line"><span class="comment">// var arr2 = [4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// var arr1 = new Array(1, 2, 3)</span></span><br><span class="line"><span class="comment">// var arr2 = new Array(4, 5, 6)</span></span><br><span class="line"><span class="comment">// 通过查看控制台发现 数组实例上只有元素和length属性</span></span><br><span class="line"><span class="comment">// 为什么能访问到push方法呢 ?</span></span><br><span class="line"><span class="comment">// console.log(arr1)</span></span><br><span class="line"><span class="comment">// 通过__proto__找到Array构造函数原型上的push方法 =&gt; 继承</span></span><br><span class="line"><span class="comment">// console.log(arr1.__proto__.push == arr2.__proto__.push) // true</span></span><br><span class="line"><span class="comment">// 查看push方法是否在Array原型上</span></span><br><span class="line"><span class="comment">// console.log(Array.prototype)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 需求: 我们希望数组能提供一个求和的方法</span></span><br><span class="line"><span class="comment">// 相当于在修改数组的源码 添加自定义方法</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getSum</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line">  <span class="comment">// 谁调用getSum this就代表谁</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    sum += <span class="variable language_">this</span>[i]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建实例对象</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment">// 调用原型上自定义的方法</span></span><br><span class="line"><span class="keyword">var</span> res = arr.<span class="title function_">getSum</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">23</span>,<span class="number">432</span>,<span class="number">35</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr2.<span class="title function_">getSum</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">getSum</span> == arr2.<span class="property">getSum</span>) <span class="comment">// true </span></span><br></pre></td></tr></table></figure>
<h5 id="原型的简单写法">原型的简单写法</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Cat</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">zhua</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;猫抓老鼠狗吃肉 凹凸曼打小怪兽&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Cat.prototype.leg = 4</span></span><br><span class="line"><span class="comment">// Cat.prototype.color = &#x27;yellow&#x27;</span></span><br><span class="line"><span class="comment">// Cat.prototype.height = 30</span></span><br><span class="line"><span class="comment">// Cat.prototype.run = function()&#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;run run ~&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// Cat.prototype.eat = function()&#123;</span></span><br><span class="line"><span class="comment">//   // Cat.prototype.run()</span></span><br><span class="line"><span class="comment">//   // 此时的this指向调用者c1</span></span><br><span class="line"><span class="comment">//   this.run()</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;吃猫粮 ~&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型的简单写法</span></span><br><span class="line"><span class="title class_">Cat</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="comment">// 构造器的指向需要手动指定</span></span><br><span class="line">  <span class="attr">constructor</span>: <span class="title class_">Cat</span>,</span><br><span class="line">  <span class="attr">leg</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span><br><span class="line">  <span class="attr">height</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">run</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;run run ~&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">eat</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">run</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;吃猫粮 ~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c1 = <span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;布偶&quot;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c1.<span class="property">name</span>)</span><br><span class="line">c1.<span class="title function_">zhua</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c1.<span class="property">leg</span>)</span><br><span class="line">c1.<span class="title function_">eat</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Cat</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c1.<span class="property">__proto__</span>)</span><br></pre></td></tr></table></figure>
<h5 id="原型的查找规则">原型的查找规则</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">zhua</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;猫抓老鼠狗吃肉 凹凸曼打小怪兽&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sex</span> = <span class="string">&#x27;man&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&#x27;大金毛&#x27;</span>, <span class="number">5</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog)</span><br><span class="line"><span class="comment">// 对象.hasOwnProperty(&#x27;属性名&#x27;) =&gt; 检测对象自身是否有该属性</span></span><br><span class="line"><span class="comment">// 只有当对象自身有该属性时 才会返回true</span></span><br><span class="line"><span class="comment">// 即便原型上有该属性 也返回false</span></span><br><span class="line"><span class="comment">// 检测自身</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;age&#x27;</span>)) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;weight&#x27;</span>)) <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 检测原型</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;sex&#x27;</span>)) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// in 使用in检测对象中是否有某个属性 如果对象自身有 返回true</span></span><br><span class="line"><span class="comment">// 如果对象自身没有 原型有 也返回true</span></span><br><span class="line"><span class="comment">// 检测自身</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> dog) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;height&#x27;</span> <span class="keyword">in</span> dog) <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 检测原型</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sex&#x27;</span> <span class="keyword">in</span> dog) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;hasOwnProperty&#x27;</span>)) <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hasOwnProperty&#x27;</span> <span class="keyword">in</span> dog) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// dog.aaa is not a function</span></span><br><span class="line"><span class="comment">// dog.aaa()</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="property">aaa</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型的查找规则 =&gt; 就近原则 =&gt; 先找自身 =&gt; 沿着原型链往上找 =&gt; Objcet.prototype</span></span><br><span class="line"><span class="comment">// 当我们的对象在调用属性或方法时 </span></span><br><span class="line"><span class="comment">// 1、在对象自身上查找是否有该属性和方法</span></span><br><span class="line"><span class="comment">// 2、如果自身没有 则沿着原型链去原型上找 如果原型上有 则直接使用</span></span><br><span class="line"><span class="comment">// 3、如果原型没有 则继续往原型的原型上找 直到找到Object的原型对象为止 (null)</span></span><br><span class="line"><span class="comment">// 4、如果Object原型上也没有 属性找不到 则返回undefined 方法找不到就报错</span></span><br></pre></td></tr></table></figure>
<h5 id="原型的终点">原型的终点</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">zhua</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;猫抓老鼠狗吃肉 凹凸曼打小怪兽&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// Dog构造函数中的原型对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>) <span class="comment">// Dog构造函数中的原型对象的原型 =&gt; Object.prorotype</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>.<span class="property">__proto__</span>) <span class="comment">// Object原型的原型 =&gt; null</span></span><br></pre></td></tr></table></figure>
<h5 id="改变原型指向">改变原型指向</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 改变原型指向注意的问题</span></span><br><span class="line"><span class="comment">// Animal类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params">name, age, sex</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sex</span> = sex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">weight</span> = <span class="number">18</span></span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sleep</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;睡觉咯 ~&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ErHa类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ErHa</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">zhua</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;猫抓老鼠狗吃肉 凹凸曼打小怪兽&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变原型指向之前添加方法和属性</span></span><br><span class="line"><span class="comment">// ErHa.prototype.color = &#x27;black and white&#x27;</span></span><br><span class="line"><span class="comment">// ErHa.prototype.run = function()&#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;跑起来疯疯癫癫&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变 ErHa 的原型指向</span></span><br><span class="line"><span class="comment">// 让 ErHa 的原型指向 指向了Animal的实例</span></span><br><span class="line"><span class="comment">// ErHa.prototype = new Animal(&quot;小狗&quot;, 5, &#x27;man&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变原型指向之后添加方法和属性</span></span><br><span class="line"><span class="comment">// ErHa.prototype.color = &#x27;black and white&#x27;</span></span><br><span class="line"><span class="comment">// ErHa.prototype.run = function () &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;跑起来疯疯癫癫&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(<span class="title class_">ErHa</span>.<span class="property"><span class="keyword">prototype</span></span>, <span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> erha = <span class="keyword">new</span> <span class="title class_">ErHa</span>(<span class="string">&#x27;二哈&#x27;</span>, <span class="number">3</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(erha.<span class="property">name</span>)</span><br><span class="line"><span class="comment">// console.log(erha.color)</span></span><br><span class="line">erha.<span class="title function_">zhua</span>()</span><br><span class="line"><span class="comment">// erha.__proto__.run()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(erha.__proto__) // 是Animal实例对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(erha.<span class="property">weight</span>)</span><br><span class="line"><span class="comment">// erha.sleep()</span></span><br></pre></td></tr></table></figure>
<h4 id="继承-2">继承</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Ajax">Ajax</h4>
<h5 id="初体验">初体验</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、创建ajax核心对象</span></span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"><span class="comment">// 2、建立连接</span></span><br><span class="line"><span class="comment">//    - 参数1: 请求方式 常用的有: get(获取) post(提交) delete(删除) put(修改) patch(打补丁的修改)</span></span><br><span class="line"><span class="comment">//    - 参数2: 请求路径 url</span></span><br><span class="line"><span class="comment">//    - 参数3: boolean类型 默认为true </span></span><br><span class="line"><span class="comment">//    同步(false) 或 异步(true)</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;https://api.it120.cc/fyy/shop/goods/list&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line"><span class="comment">// 3、发送请求</span></span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="comment">// 4、监听服务端响应</span></span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>)&#123;</span><br><span class="line">    <span class="comment">// JSON.parse: 反序列化 将满足JSON格式的字符串转成对象</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="ajax核心对象">ajax核心对象</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- 如果是表单提交的方式 一定要加上name属性 --&gt;</span><br><span class="line">  &lt;!-- 数据提交时会将name属性的值作为键 用户输入的数据作为值 --&gt;</span><br><span class="line">  &lt;!-- 拼接成一个对象 放到请求体中提交给后端 --&gt;</span><br><span class="line">  &lt;!-- &lt;form action=&quot;/add&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">    密码: &lt;input type=&quot;text&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;button type=&quot;submit&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">  &lt;/form&gt;  --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // 1、创建xhr核心对象 =&gt; 兼容写法</span><br><span class="line">    var xhr = null</span><br><span class="line">    // 判断当前浏览器是否支持 XMLHttpRequest</span><br><span class="line">    if (XMLHttpRequest) &#123;</span><br><span class="line">      // IE以外的浏览器使用</span><br><span class="line">      xhr = new XMLHttpRequest()</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // IE浏览器使用</span><br><span class="line">      xhr = new ActiveXObject(&#x27;Microsoft.XMLHttp&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="get请求方式">get请求方式</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var xhr = new XMLHttpRequest()</span></span><br><span class="line"><span class="comment">// // localhost: 127.0.0.1 本机回环地址</span></span><br><span class="line"><span class="comment">// xhr.open(&#x27;get&#x27;, &#x27;http://localhost:3000/getUserList&#x27;, true)</span></span><br><span class="line"><span class="comment">// xhr.send(null)</span></span><br><span class="line"><span class="comment">// xhr.onload = function()&#123;</span></span><br><span class="line"><span class="comment">//   if(xhr.readyState == 4 &amp;&amp; xhr.status == 200)&#123;</span></span><br><span class="line"><span class="comment">//     console.log(JSON.parse(xhr.responseText))</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过get方式提交数据 =&gt; 需要拼接在url地址栏?后面</span></span><br><span class="line"><span class="keyword">let</span> userInfo = <span class="string">&#x27;name=张三&amp;age=22&#x27;</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://localhost:3000/addUser?&#x27;</span>+ <span class="built_in">encodeURI</span>(userInfo), <span class="literal">true</span>)</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>作业</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>获取数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>添加数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  &lt;!-- 提示信息 --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">  &lt;!-- 准备一个容器 --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;uu&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 通过get方式获取数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> xhr;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(<span class="title class_">XMLHttpRequest</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;<span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&#x27;Microsoft.XMLHttp&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// btn1.onclick = function () &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   xhr.open(&#x27;get&#x27;, &#x27;http://localhost:3000/getUserList&#x27;, true)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   xhr.send(null)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   xhr.onload = function () &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//     if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       // 将json字符串转成对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       let data = JSON.parse(xhr.responseText)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       // 拼接数据和标签</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       let str = &#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       data.forEach(item =&gt; &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//         str += `&lt;li&gt;$&#123;item.name&#125;--$&#123;item.age&#125;&lt;/li&gt;`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       // 将拼接好的标签追加到页面上</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//       uu.innerHTML = str</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//     &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 添加数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn2.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> userInfo = <span class="string">&#x27;name=李四&amp;age=22&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// encodeURI: 把字符串作为 URI 进行编码</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// get方式如果提交的数据中有中文 一定要进行乱码处理</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://localhost:3000/addUser?&#x27;</span> + <span class="built_in">encodeURI</span>(userInfo), <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="title function_">alert</span>(xhr.<span class="property">responseText</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// let data = JSON.parse(xhr.responseText)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// if(data.code == 1)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">//   info.innerHTML = data.msg</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>服务端</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"><span class="comment">// 处理表单类型的数据 application/x-www-form-urlencoded</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>())</span><br><span class="line"><span class="comment">// 处理json类型的数据 application/json</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户列表</span></span><br><span class="line"><span class="keyword">let</span> userList = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ls&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/getUserList&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 响应用户一些数据</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(userList))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/addUser&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1111</span>)</span><br><span class="line">  <span class="comment">// 获取用户get方式提交的数据</span></span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">query</span>.<span class="property">name</span>)</span><br><span class="line">  <span class="comment">// 判断用户名是否重复</span></span><br><span class="line">  <span class="comment">// 遍历数组取出每一项 判断每一项的name属性值和用户提交的name属性值是否一样</span></span><br><span class="line">  <span class="comment">// let result = userList.find(item =&gt; item.name == req.query.name)</span></span><br><span class="line">  <span class="comment">// if (result) &#123;</span></span><br><span class="line">  <span class="comment">//   res.send(&#123;</span></span><br><span class="line">  <span class="comment">//     code: 1,</span></span><br><span class="line">  <span class="comment">//     msg: &#x27;用户名已存在&#x27;</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125; else &#123;</span></span><br><span class="line">  <span class="comment">//   // 将数据保存到数组中</span></span><br><span class="line">  <span class="comment">//   userList.push(req.query)</span></span><br><span class="line">  <span class="comment">//   res.send(&#123;</span></span><br><span class="line">  <span class="comment">//     code: 0,</span></span><br><span class="line">  <span class="comment">//     msg: &#x27;添加成功&#x27;</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/addUser&#x27;</span>, <span class="function">(<span class="params">req, res</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">  <span class="comment">// 响应数据</span></span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">body</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server is running at port 3000 ~&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="post请求方式">post请求方式</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>发送表单数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>发送Json数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// post提交数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn1.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 准备提交的数据 =&gt; 表单数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> userInfo = <span class="string">&quot;name=李四&amp;age=22&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://localhost:3000/addUser&#x27;</span>, <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1、post请求方式提交数据需要设置请求头</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1.1 提交表单类型数据的请求头设置</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 2、post提交数据需要通过send(数据)方法</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 3、post提交的数据是通过请求提提交给后端 所以无需url编码处理</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">send</span>(userInfo)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn2.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 准备提交的数据 =&gt; json数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> userInfo = &#123;<span class="attr">name</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="attr">age</span>: <span class="number">24</span>&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://localhost:3000/addUser&#x27;</span>, <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1、post请求方式提交数据需要设置请求头</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1.1 提交json类型数据的请求头设置</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1.2 Json数据需要通过JSON.stringify处理</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(userInfo))</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>作业</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h5</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line">  用户名: &lt;input type=&quot;text&quot; id=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">  密码: &lt;input type=&quot;text&quot; id=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">  &lt;button id=&quot;btn1&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    btn1.onclick = function () &#123;</span><br><span class="line">      // 获取用户输入的用户名</span><br><span class="line">      var uname = username.value</span><br><span class="line">      // 获取用户输入的密码</span><br><span class="line">      var pwd = password.value</span><br><span class="line">      if (!uname || !pwd) &#123;</span><br><span class="line">        info.innerHTML = &#x27;输入框不能为空&#x27;</span><br><span class="line">        // 停止后面代码执行</span><br><span class="line">        return</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 能够进到这里证明用户输入了用户名和密码</span><br><span class="line">        // 拿着用户输入的用户名和密码发起请求</span><br><span class="line">        var xhr = new XMLHttpRequest()</span><br><span class="line">        var userInfo = `name=$&#123;uname&#125;&amp;pwd=$&#123;pwd&#125;`</span><br><span class="line">        xhr.open(&#x27;get&#x27;, &#x27;http://localhost:3000/addUser?&#x27; + encodeURI(userInfo), true)</span><br><span class="line">        xhr.send(null)</span><br><span class="line">        xhr.onreadystatechange = function () &#123;</span><br><span class="line">          if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) &#123;</span><br><span class="line">            console.log(xhr.responseText)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="onreadystatechange"><strong>onreadystatechange</strong></h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">   <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">readyState</span>) <span class="comment">// 0</span></span><br><span class="line">   <span class="keyword">var</span> userInfo = <span class="string">`name=zs&amp;pwd=123`</span></span><br><span class="line">   xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;http://localhost:3000/addUser?&#x27;</span> + <span class="built_in">encodeURI</span>(userInfo), <span class="literal">true</span>)</span><br><span class="line">   xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">readyState</span>) <span class="comment">// 1</span></span><br><span class="line">   <span class="comment">// 准备回调函数 接收服务端响应</span></span><br><span class="line">   <span class="comment">// 当服务端有数据响应过来的时候 会调用函数</span></span><br><span class="line">   <span class="comment">// 我们只是声明了函数 并没有调用 谁调用的? =&gt; 浏览器</span></span><br><span class="line">   <span class="comment">// 浏览器根据readyState的变化来调用这个函数</span></span><br><span class="line">   <span class="comment">// 函数中的readyState(2 3 4)变了三次 函数一共调用了三次 </span></span><br><span class="line">   xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">readyState</span>) <span class="comment">// 2 =&gt; 3 =&gt; 4</span></span><br><span class="line">     <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//0: 请求未初始化, xhr对象创建完毕(此时还没有调用open)</span></span><br><span class="line">   <span class="comment">//1: 服务器连接已建立(三次握手), 已经发送请求开始监听</span></span><br><span class="line">   <span class="comment">//2: 请求已接收, 已经收到服务器返回的内容 数据还无法使用</span></span><br><span class="line">   <span class="comment">//3: 请求处理中, 解析服务器响应内容 数据还无法使用</span></span><br><span class="line">   <span class="comment">//4: 请求已完成, 且响应就绪, 数据解析完毕 数据可以使用</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// status: http状态码</span></span><br><span class="line">   <span class="comment">// 200 OK 请求成功 一切ok</span></span><br><span class="line">   <span class="comment">// 302 Found 重定向 redirect</span></span><br><span class="line">   <span class="comment">// 304 Not Modified 缓存</span></span><br><span class="line">   <span class="comment">// 403 Forbidden 没有权限</span></span><br><span class="line">   <span class="comment">// 404 Not Found 资源路径不存在</span></span><br><span class="line">   <span class="comment">// 500 Internal Server Error 服务器错误</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 晚上作业</span></span><br><span class="line">   <span class="comment">// 1、注册页 获取用户输入的数据 提交数据为表单数据类型 后端保存数据 用户名重复则注册失败</span></span><br><span class="line">   <span class="comment">// 2、登录页 获取用户输入的数据 提交数据为json数据类型 后端验证用户名和密码是否正确 都正确则跳转到首页(自己随便写个页面显示欢迎您xxx)</span></span><br><span class="line">   </span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="onload">onload</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> xhr=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    <span class="keyword">let</span> params = <span class="string">&#x27;name=zs&amp;age=18&#x27;</span></span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;http://localhost:3000/addUser&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">    xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class="line">    xhr.<span class="title function_">send</span>(params)</span><br><span class="line">    xhr.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">      <span class="comment">// if(xhr.readyState==4&amp;&amp;xhr.status==200)</span></span><br><span class="line">      <span class="comment">// console.log(xhr.responseText)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// onload   onreadyStateChange</span></span><br><span class="line">    <span class="comment">// 兼容性:   不兼容IE      兼容</span></span><br><span class="line">    <span class="comment">// 判断:     不需要        需要 </span></span><br><span class="line">    <span class="comment">// 调用次数:  调用一次      调用三次</span></span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>练习</strong></p>
<p>登录页</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>登陆页<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">  密 码: &lt;input type=&quot;text&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">  &lt;button id=&quot;btn&quot;&gt;登录&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    btn.onclick = function () &#123;</span><br><span class="line">      // 获取用户输入的内容</span><br><span class="line">      var uname = username.value</span><br><span class="line">      var pwd = password.value</span><br><span class="line">      if (!uname) &#123;</span><br><span class="line">        info.innerHTML = &#x27;用户名不能为空&#x27;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if (!pwd) &#123;</span><br><span class="line">        info.innerHTML = &#x27;密码不能为空&#x27;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      let params = `uname=$&#123;uname&#125;&amp;pwd=$&#123;pwd&#125;`</span><br><span class="line">      var xhr = new XMLHttpRequest()</span><br><span class="line">      xhr.open(&#x27;post&#x27;, &#x27;http://localhost:3000/login&#x27;, true)</span><br><span class="line">      xhr.setRequestHeader(&#x27;Content-Type&#x27;, &#x27;application/x-www-form-urlencoded&#x27;)</span><br><span class="line">      xhr.send(params)</span><br><span class="line">      xhr.onload = function () &#123;</span><br><span class="line">        var data = JSON.parse(xhr.responseText)</span><br><span class="line">        if(data.code == 1)&#123;</span><br><span class="line">          info.innerHTML = data.msg</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">          alert(&#x27;登录成功 即将跳转到首页&#x27;)</span><br><span class="line">          // location.href = `./02-首页.html#name=$&#123;uname&#125;`</span><br><span class="line">          // file:///D:/Education/2108A/js/day13/code/02.html#name=zs</span><br><span class="line"></span><br><span class="line">          location.href = `./02-首页.html`</span><br><span class="line">          sessionStorage.setItem(&#x27;userInfo&#x27;, uname)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      xhr.onerror = function()&#123;</span><br><span class="line">        console.log(&#x27;网络错误 ~&#x27;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>首页</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// var hash = location.hash</span></span><br><span class="line">    <span class="comment">// if (hash) &#123;</span></span><br><span class="line">    <span class="comment">//   hash = hash.substring(1)</span></span><br><span class="line">    <span class="comment">//   var arr = hash.split(&#x27;=&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//   // 字符串的方式</span></span><br><span class="line">    <span class="comment">//   // var h3 = `&lt;h3&gt;欢迎你 $&#123;arr[1]&#125;&lt;/h3&gt;`</span></span><br><span class="line">    <span class="comment">//   // document.body.innerHTML = h3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//   // 节点的方式</span></span><br><span class="line">    <span class="comment">//   // var h3 = document.createElement(`h3`)</span></span><br><span class="line">    <span class="comment">//   // h3.innerHTML = `欢迎你 $&#123;arr[1]&#125;`</span></span><br><span class="line">    <span class="comment">//   // document.body.appendChild(h3)</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// var uname = localStorage.getItem(&#x27;userInfo&#x27;)</span></span><br><span class="line">    <span class="keyword">var</span> uname = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line">    <span class="keyword">var</span> h3 = <span class="string">`&lt;h3&gt;欢迎你 <span class="subst">$&#123;uname&#125;</span>&lt;/h3&gt;`</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = h3</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>注册页</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>注册页<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">  密 码: &lt;input type=&quot;text&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">  &lt;button id=&quot;btn&quot;&gt;注册&lt;/button&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    btn.onclick = function () &#123;</span><br><span class="line">      // 获取用户输入的内容</span><br><span class="line">      var uname = username.value</span><br><span class="line">      var pwd = password.value</span><br><span class="line">      if (!uname) &#123;</span><br><span class="line">        info.innerHTML = &#x27;用户名不能为空&#x27;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if (!pwd) &#123;</span><br><span class="line">        info.innerHTML = &#x27;密码不能为空&#x27;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      var xhr = new XMLHttpRequest()</span><br><span class="line">      xhr.open(&#x27;post&#x27;, &#x27;http://localhost:3000/register&#x27;, true)</span><br><span class="line">      xhr.setRequestHeader(&#x27;Content-Type&#x27;, &#x27;application/json&#x27;)</span><br><span class="line">      xhr.send(JSON.stringify(&#123; uname, pwd &#125;))</span><br><span class="line">      xhr.onload = function () &#123;</span><br><span class="line">        var data = JSON.parse(xhr.responseText)</span><br><span class="line">        if(data.code == 1)&#123;</span><br><span class="line">          info.innerHTML = data.msg</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">          alert(&#x27;注册成功 即将跳转到登陆页&#x27;)</span><br><span class="line">          location.href = &#x27;./02-登陆页.html&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="缓存问题">缓存问题</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">      xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://localhost:3000/cache?cache=&#x27;</span>+<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>(), <span class="literal">true</span>)</span><br><span class="line">      xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line">      xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> data = xhr.<span class="property">responseText</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">      &#125;</span><br><span class="line"><span class="comment">// 因为每次请求的url都是一样的 所以IE低版本没有重新对服务器发起请求</span></span><br><span class="line"><span class="comment">// 而是从缓存中读取上一次请求的结果 怎么解决 ?</span></span><br><span class="line"><span class="comment">// 保证每次请求的url都是不一致的 在url上添加随机数 当前时间毫秒数</span></span><br></pre></td></tr></table></figure>
<h5 id="ajax封装">ajax封装</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax初步封装</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 确定功能 =&gt; ajax封装</span></span><br><span class="line"><span class="comment">// 确定参数 =&gt; method、url</span></span><br><span class="line"><span class="comment">// 确定返回值 =&gt; 没有</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">&#123; method = <span class="string">&#x27;get&#x27;</span>, url, callback &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> xhr</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">XMLHttpRequest</span>) &#123;</span><br><span class="line">    xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    xhr = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&#x27;Micrsoft.XMLHTTP&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  xhr.<span class="title function_">open</span>(method, url, <span class="literal">true</span>)</span><br><span class="line">  xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line">  <span class="comment">// var data</span></span><br><span class="line">  xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 不要对数据做统一的处理 而是交给调用者来决定具体的业务逻辑</span></span><br><span class="line">    <span class="comment">// console.log(xhr.responseText)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处返回返回给了onload指定的匿名函数</span></span><br><span class="line">    <span class="comment">// return xhr.responseText</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这是在异步函数中 同步先执行return data 再执行下面的赋值代码</span></span><br><span class="line">    <span class="comment">// data = xhr.responseText</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用回调函数来返回数据</span></span><br><span class="line">    <span class="title function_">callback</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 此处返回 xhr.responseText 结果为 &#x27;&#x27;</span></span><br><span class="line">  <span class="comment">// return xhr.responseText</span></span><br><span class="line">  <span class="comment">// return data</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>get请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>post请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn1.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1、传参顺序有限制 不能随意调换参数的顺序 =&gt; 对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 2、如果不传参 没有默认值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/getBookList&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">callback</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn2.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/getBookList&#x27;</span>, </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">callback</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="ajax封装-2">ajax封装</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax初步封装</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 确定功能 =&gt; ajax封装</span></span><br><span class="line"><span class="comment">// 确定参数 =&gt; method、url</span></span><br><span class="line"><span class="comment">// 确定返回值 =&gt; 没有</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@params</span></span></span><br><span class="line"><span class="comment"> *  method: 传参方式</span></span><br><span class="line"><span class="comment"> *  url: 请求路径</span></span><br><span class="line"><span class="comment"> *  dataType: 数据类型</span></span><br><span class="line"><span class="comment"> *  data: 提交的数据</span></span><br><span class="line"><span class="comment"> *  callback: 回调</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> <span class="variable">void</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">&#123; method = <span class="string">&#x27;get&#x27;</span>, url, dataType, data, callback &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> xhr</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">XMLHttpRequest</span>) &#123;</span><br><span class="line">    xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    xhr = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&#x27;Micrsoft.XMLHTTP&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果是get请求方式</span></span><br><span class="line">  <span class="keyword">if</span> (data &amp;&amp; method == <span class="string">&#x27;get&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> data == <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// name=《聊斋志异》&amp;auth=蒲松龄&amp;desc=跨越生死的爱情故事</span></span><br><span class="line">      url += <span class="string">&#x27;?&#x27;</span> + <span class="built_in">encodeURI</span>(data)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> data == <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// 对象: &#123;name: &#x27;《聊斋志异》&#x27;,auth: &#x27;蒲松龄&#x27;,desc: &#x27;跨越生死的爱情故事&#x27;&#125;,</span></span><br><span class="line">      <span class="comment">// 目标: http://localhost:3000/getBookList?name=&#x27;《聊斋志异》&#x27;&amp;auth=&#x27;xx&#x27;&amp;desc=&#x27;xx&#x27;</span></span><br><span class="line">      url = url + <span class="string">&#x27;?&#x27;</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="comment">// key =&gt; name、auth、desc</span></span><br><span class="line">        <span class="comment">// data[key] =&gt; &#x27;《聊斋志异》&#x27;、&#x27;蒲松龄&#x27;、&#x27;跨越生死的爱情故事&#x27;</span></span><br><span class="line">        url += key + <span class="string">&#x27;=&#x27;</span> + data[key] + <span class="string">&#x27;&amp;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 将最后的&amp;截取掉 并进行编码处理</span></span><br><span class="line">      url = <span class="built_in">encodeURI</span>(url.<span class="title function_">substring</span>(<span class="number">0</span>, url.<span class="property">length</span> - <span class="number">1</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  xhr.<span class="title function_">open</span>(method, url, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> params = <span class="literal">null</span></span><br><span class="line">  <span class="comment">// 如果是post请求方式</span></span><br><span class="line">  <span class="keyword">if</span> (data &amp;&amp; method == <span class="string">&#x27;post&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> data == <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// 设置请求头</span></span><br><span class="line">      xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class="line">      params = data</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> data == <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>)</span><br><span class="line">      <span class="comment">// 将数据转成json格式</span></span><br><span class="line">      params = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  xhr.<span class="title function_">send</span>(params)</span><br><span class="line">  </span><br><span class="line">  xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 接收服务端响应的数据</span></span><br><span class="line">    <span class="keyword">let</span> data = xhr.<span class="property">responseText</span></span><br><span class="line">    <span class="comment">// 如果用户传入了json参数</span></span><br><span class="line">    <span class="keyword">if</span> (dataType) &#123;</span><br><span class="line">      <span class="comment">// 将数据转成json格式</span></span><br><span class="line">      data = data.<span class="title function_">includes</span>(<span class="string">&#x27;[&#x27;</span>) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data) : data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 使用回调函数来返回数据</span></span><br><span class="line">    <span class="title function_">callback</span>(data)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>get请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>post请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn1.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 1、传参顺序有限制 不能随意调换参数的顺序 =&gt; 对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 2、如果不传参 没有默认值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/getBookList&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// data: &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   name: &#x27;《聊斋志异》&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   auth: &#x27;蒲松龄&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   desc: &#x27;跨越生死的爱情故事&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">data</span>: <span class="string">&#x27;name=《聊斋志异》&amp;auth=蒲松龄&amp;desc=跨越生死的爱情故事&#x27;</span> ,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">callback</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    btn2.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/getBookList&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// data: &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   name: &#x27;《山海经》&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   auth: &#x27;未知&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//   desc: &#x27;远古时期神话故事&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">data</span>: <span class="string">&#x27;name=《聊斋志异》&amp;auth=蒲松龄&amp;desc=跨越生死的爱情故事&#x27;</span> ,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">callback</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="图书案例"><strong>图书案例</strong></h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    .dv &#123;</span><br><span class="line">      width: 400px;</span><br><span class="line">      height: 300px;</span><br><span class="line">      background-color: skyblue;</span><br><span class="line">      margin: 100px auto;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ul &#123;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 20px 35px;</span><br><span class="line">      text-align: left;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      list-style: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;script src=&quot;./01-ajax.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;dv&quot;&gt;</span><br><span class="line">    &lt;!-- 搜索框 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;keywords&quot;&gt; &lt;button id=&quot;search&quot;&gt;搜索&lt;/button&gt;</span><br><span class="line">    &lt;!-- 展示图书信息 --&gt;</span><br><span class="line">    &lt;ul id=&quot;uu&quot;&gt;&lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    search.onclick = function () &#123;</span><br><span class="line">      // 如果用户什么都没有输入</span><br><span class="line">      if (keywords.value == &#x27;&#x27;) &#123;</span><br><span class="line">        // 默认获取所有的数据</span><br><span class="line">        ajax(&#123;</span><br><span class="line">          method: &#x27;get&#x27;,</span><br><span class="line">          url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">          dataType: &#x27;json&#x27;,</span><br><span class="line">          callback: function (data) &#123;</span><br><span class="line">            let lis = &#x27;&#x27;</span><br><span class="line">            data.forEach((item, index) =&gt; &#123;</span><br><span class="line">              lis += `&lt;li&gt;$&#123;index + 1&#125;.$&#123;item.name&#125;- $&#123;item.auth&#125;- $&#123;item.desc&#125;&lt;/li&gt;`</span><br><span class="line">            &#125;)</span><br><span class="line">            uu.innerHTML = lis</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 根据用户输入的内容查询对应的书籍</span><br><span class="line">        ajax(&#123;</span><br><span class="line">          method: &#x27;get&#x27;,</span><br><span class="line">          url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">          dataType: &#x27;json&#x27;,</span><br><span class="line">          data: `keywords=$&#123;keywords.value&#125;`,</span><br><span class="line">          callback: function (data) &#123;</span><br><span class="line">            if (typeof data == &#x27;string&#x27;) &#123;</span><br><span class="line">              uu.innerHTML = data</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              let lis = &#x27;&#x27;</span><br><span class="line">              data.forEach((item, index) =&gt; &#123;</span><br><span class="line">                lis += `&lt;li&gt;$&#123;index + 1&#125;.$&#123;item.name&#125;- $&#123;item.auth&#125;- $&#123;item.desc&#125;&lt;/li&gt;`</span><br><span class="line">              &#125;)</span><br><span class="line">              uu.innerHTML = lis</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h5 id="jquery实现">jquery实现</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    .dv &#123;</span><br><span class="line">      width: 400px;</span><br><span class="line">      height: 300px;</span><br><span class="line">      background-color: skyblue;</span><br><span class="line">      margin: 100px auto;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ul &#123;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 20px 35px;</span><br><span class="line">      text-align: left;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      list-style: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .mask &#123;</span><br><span class="line">      display: none;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 100%;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      background: rgba(0, 0, 0, .5);</span><br><span class="line">      text-align: center;</span><br><span class="line">      font-weight: bold;</span><br><span class="line">      line-height: 150px;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script src=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;mask&quot;&gt;玩命加载中 ~ &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;dv&quot;&gt;</span><br><span class="line">    &lt;!-- 搜索框 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;keywords&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;search&quot;&gt;搜索&lt;/button&gt;</span><br><span class="line">    &lt;!-- &lt;button id=&quot;search2&quot;&gt;搜索&lt;/button&gt; --&gt;</span><br><span class="line">    &lt;!-- 展示图书信息 --&gt;</span><br><span class="line">    &lt;ul id=&quot;uu&quot;&gt;&lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // 全局事件 只要当前页面有ajax请求发起就会执行回调函数中的代码</span><br><span class="line">    $(document).ajaxStart(() =&gt; &#123;</span><br><span class="line">      // $(&#x27;.mask&#x27;).fadeIn()</span><br><span class="line">      NProgress.start()</span><br><span class="line">    &#125;)</span><br><span class="line">    // 全局事件 只要当前页面有ajax请求完成就会执行回调函数中的代码</span><br><span class="line">    $(document).ajaxComplete(() =&gt; &#123;</span><br><span class="line">      // $(&#x27;.mask&#x27;).fadeOut()</span><br><span class="line">      NProgress.done()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    $(&#x27;#search&#x27;).click(() =&gt; &#123;</span><br><span class="line">      let keywords = $(&#x27;#keywords&#x27;).val()</span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        method: &#x27;get&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">        data: &#123; keywords &#125;,</span><br><span class="line">        dataType: &#x27;json&#x27;,</span><br><span class="line">        success: (data) =&gt; &#123;</span><br><span class="line">          let lis = &#x27;&#x27;</span><br><span class="line">          data.forEach((item, index) =&gt; &#123;</span><br><span class="line">            lis += `&lt;li&gt;$&#123;index + 1&#125;.$&#123;item.name&#125;- $&#123;item.auth&#125;- $&#123;item.desc&#125;&lt;/li&gt;`</span><br><span class="line">          &#125;)</span><br><span class="line">          $(&#x27;#uu&#x27;).html(lis)</span><br><span class="line">        &#125;,</span><br><span class="line">        // 在发送请求之前调用</span><br><span class="line">        // beforeSend()&#123;</span><br><span class="line">        //   $(&#x27;.mask&#x27;).fadeIn()</span><br><span class="line">        // &#125;,</span><br><span class="line">        // // complete 当请求完成之后调用这个函数，无论成功或失败</span><br><span class="line">        // complete()&#123;</span><br><span class="line">        //   $(&#x27;.mask&#x27;).fadeOut()</span><br><span class="line">        // &#125;,</span><br><span class="line">        // 在请求出错时调用</span><br><span class="line">        error(xhr) &#123;</span><br><span class="line">          console.log(xhr.responseText)</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    $(&#x27;#search2&#x27;).click(() =&gt; &#123;</span><br><span class="line">      let keywords = $(&#x27;#keywords&#x27;).val()</span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        method: &#x27;get&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">        data: &#123; keywords &#125;,</span><br><span class="line">        dataType: &#x27;json&#x27;,</span><br><span class="line">        success: (data) =&gt; &#123;</span><br><span class="line">          let lis = &#x27;&#x27;</span><br><span class="line">          data.forEach((item, index) =&gt; &#123;</span><br><span class="line">            lis += `&lt;li&gt;$&#123;index + 1&#125;.$&#123;item.name&#125;- $&#123;item.auth&#125;- $&#123;item.desc&#125;&lt;/li&gt;`</span><br><span class="line">          &#125;)</span><br><span class="line">          $(&#x27;#uu&#x27;).html(lis)</span><br><span class="line">        &#125;,</span><br><span class="line">        // 在请求出错时调用</span><br><span class="line">        error(xhr) &#123;</span><br><span class="line">          console.log(xhr.responseText)</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h5 id="jquery方法">jquery方法</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // $.get()</span><br><span class="line">    // $.post()</span><br><span class="line">    // $.getJSON()</span><br><span class="line">    // $.getScript()</span><br><span class="line"></span><br><span class="line">    // 同步的写法 =&gt; 不建议使用</span><br><span class="line">    // let data = $.ajax(&#123;</span><br><span class="line">    //     method: &#x27;get&#x27;,</span><br><span class="line">    //     url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">    //     dataType: &#x27;json&#x27;,</span><br><span class="line">    //     // 同步 =&gt; 默认true =&gt; 异步</span><br><span class="line">    //     async: false,</span><br><span class="line">    //     // 缓存 默认true =&gt; 有缓存</span><br><span class="line">    //     cache: false,</span><br><span class="line">    //   &#125;)</span><br><span class="line">    //   console.log(JSON.parse(data.responseText))</span><br><span class="line">    //   console.log(111)</span><br><span class="line"></span><br><span class="line">      let data = $.ajax(&#123;</span><br><span class="line">        method: &#x27;post&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">        // 预期服务器返回的数据类型 默认是纯文本</span><br><span class="line">        dataType: &#x27;text&#x27;,</span><br><span class="line">        // dataType: &#x27;json&#x27;,</span><br><span class="line">        // 同步 =&gt; 默认true =&gt; 异步</span><br><span class="line">        async: false,</span><br><span class="line">        // 缓存 默认true =&gt; 有缓存</span><br><span class="line">        cache: false,</span><br><span class="line">        // 发送信息至服务器时内容编码类型 默认表单数据类型</span><br><span class="line">        // contentType: &#x27;application/x-www-form-urlencoded&#x27;,</span><br><span class="line">        contentType: &#x27;application/json&#x27;,</span><br><span class="line">        // 一个额外的&quot;&#123;键:值&#125;&quot;对映射到请求一起发送 =&gt; 设置自定义请求头</span><br><span class="line">        headers:&#123;</span><br><span class="line">          Authrization: &#x27;Bearer 34859REGFG34523DSDFJHGJUY23&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      console.log(JSON.parse(data.responseText))</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h5 id="图书案例-2">图书案例</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    .dv &#123;</span><br><span class="line">      width: 500px;</span><br><span class="line">      height: 300px;</span><br><span class="line">      background-color: skyblue;</span><br><span class="line">      margin: 100px auto;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    input &#123;</span><br><span class="line">      outline: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ul &#123;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 20px 35px;</span><br><span class="line">      text-align: left;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">      list-style: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .mask &#123;</span><br><span class="line">      display: none;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 100%;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      background: rgba(0, 0, 0, .5);</span><br><span class="line">      text-align: center;</span><br><span class="line">      font-weight: bold;</span><br><span class="line">      line-height: 150px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #del,</span><br><span class="line">    #edit &#123;</span><br><span class="line">      margin-left: 10px;</span><br><span class="line">      width: 42px;</span><br><span class="line">      height: 20px;</span><br><span class="line">      font-size: 13px;</span><br><span class="line">      cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .edit &#123;</span><br><span class="line">      display: none;</span><br><span class="line">      background-color: white;</span><br><span class="line">      width: 251px;</span><br><span class="line">      height: 100px;</span><br><span class="line">      padding: 20px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 35%;</span><br><span class="line">      left: 50%;</span><br><span class="line">      transform: translate(-50%, -50%);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #confirmEdit &#123;</span><br><span class="line">      margin-top: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script src=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/nprogress@0.2.0/nprogress.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;mask&quot;&gt;玩命加载中 ~ &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;edit&quot;&gt;</span><br><span class="line">    书名: &lt;input type=&quot;text&quot; id=&quot;name&quot;&gt;&lt;br&gt;</span><br><span class="line">    作者: &lt;input type=&quot;text&quot; id=&quot;author&quot;&gt;&lt;br&gt;</span><br><span class="line">    描述: &lt;input type=&quot;text&quot; id=&quot;desc&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;button id=&quot;confirmEdit&quot;&gt;确认修改&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;dv&quot;&gt;</span><br><span class="line">    &lt;!-- 添加框 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;bookName&quot; placeholder=&quot;请输入书名&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;authorName&quot; placeholder=&quot;请输入作者名字&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;textarea&quot; id=&quot;bookDesc&quot; placeholder=&quot;请输入相关描述&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;addBook&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">    &lt;!-- 搜索框 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;keywords&quot; placeholder=&quot;请输入搜索的关键字&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;search&quot;&gt;搜索&lt;/button&gt;</span><br><span class="line">    &lt;!-- 展示图书信息 --&gt;</span><br><span class="line">    &lt;ul id=&quot;uu&quot;&gt;&lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // 全局事件 只要当前页面有ajax请求发起就会执行回调函数中的代码</span><br><span class="line">    $(document).ajaxStart(() =&gt; &#123;</span><br><span class="line">      // $(&#x27;.mask&#x27;).fadeIn()</span><br><span class="line">      NProgress.start()</span><br><span class="line">    &#125;)</span><br><span class="line">    // 全局事件 只要当前页面有ajax请求完成就会执行回调函数中的代码</span><br><span class="line">    $(document).ajaxComplete(() =&gt; &#123;</span><br><span class="line">      // $(&#x27;.mask&#x27;).fadeOut()</span><br><span class="line">      NProgress.done()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 搜索</span><br><span class="line">    $(&#x27;#search&#x27;).click(() =&gt; &#123;</span><br><span class="line">      let keywords = $(&#x27;#keywords&#x27;).val()</span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        method: &#x27;get&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/getBookList&#x27;,</span><br><span class="line">        data: &#123; keywords &#125;,</span><br><span class="line">        dataType: &#x27;json&#x27;,</span><br><span class="line">        success: (data) =&gt; &#123;</span><br><span class="line">          let lis = &#x27;&#x27;</span><br><span class="line">          data.forEach((item, index) =&gt; &#123;</span><br><span class="line">            lis += `&lt;li myid=$&#123;item.id&#125;&gt;$&#123;index + 1&#125;.$&#123;item.name&#125;- $&#123;item.auth&#125;- $&#123;item.desc&#125;&lt;button id=&#x27;del&#x27;&gt;删除&lt;/button&gt;&lt;button id=&#x27;edit&#x27;&gt;编辑&lt;/button&gt;&lt;/li&gt;`</span><br><span class="line">          &#125;)</span><br><span class="line">          $(&#x27;#uu&#x27;).html(lis)</span><br><span class="line">        &#125;,</span><br><span class="line">        // 在请求出错时调用</span><br><span class="line">        error(xhr) &#123;</span><br><span class="line">          console.log(xhr.responseText)</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 添加</span><br><span class="line">    $(&#x27;#addBook&#x27;).click(() =&gt; &#123;</span><br><span class="line">      // 获取用户输入的书名</span><br><span class="line">      let name = $(&#x27;#bookName&#x27;).val()</span><br><span class="line">      let auth = $(&#x27;#authorName&#x27;).val()</span><br><span class="line">      let desc = $(&#x27;#bookDesc&#x27;).val()</span><br><span class="line">      // 发起请求提交书名</span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        method: &#x27;post&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/addBook&#x27;,</span><br><span class="line">        data: &#123; name: `《$&#123;name&#125;》`, auth, desc &#125;,</span><br><span class="line">        dataType: &#x27;json&#x27;,</span><br><span class="line">        success: (data) =&gt; &#123;</span><br><span class="line">          console.log(data)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 删除</span><br><span class="line">    $(&#x27;#uu&#x27;).click((e) =&gt; &#123;</span><br><span class="line">      // console.log(e.target.parentNode.getAttribute(&#x27;myid&#x27;))</span><br><span class="line">      if (e.target.getAttribute(&#x27;id&#x27;) == &#x27;del&#x27;) &#123;</span><br><span class="line">        let myid = $(e.target).parent().attr(&#x27;myid&#x27;)</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">          method: &#x27;post&#x27;,</span><br><span class="line">          url: &#x27;http://localhost:3000/delBookById?id=&#x27; + myid,</span><br><span class="line">          success: (data) =&gt; &#123;</span><br><span class="line">            if (data.code == 0) &#123;</span><br><span class="line">              // 触发搜索按钮</span><br><span class="line">              $(&#x27;#search&#x27;).click()</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 编辑</span><br><span class="line">    let myid</span><br><span class="line">    $(&#x27;#uu&#x27;).click((e) =&gt; &#123;</span><br><span class="line">      if (e.target.getAttribute(&#x27;id&#x27;) == &#x27;edit&#x27;) &#123;</span><br><span class="line">        // 获取当前元素的id</span><br><span class="line">        myid = $(e.target).parent().attr(&#x27;myid&#x27;)</span><br><span class="line">        // 显示编辑框</span><br><span class="line">        $(&#x27;.edit&#x27;).css(&#x27;display&#x27;, &#x27;block&#x27;)</span><br><span class="line">        // 发起请求 =&gt; 渲染编辑框</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">          url: &#x27;http://localhost:3000/getBookById?id=&#x27; + myid,</span><br><span class="line">          success: (data) =&gt; &#123;</span><br><span class="line">            if (data.code == 0) &#123;</span><br><span class="line">              $(&#x27;#name&#x27;).val(data.data.name)</span><br><span class="line">              $(&#x27;#author&#x27;).val(data.data.auth)</span><br><span class="line">              $(&#x27;#desc&#x27;).val(data.data.desc)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 确认修改</span><br><span class="line">    $(&#x27;#confirmEdit&#x27;).click(() =&gt; &#123;</span><br><span class="line">      // 获取用户输入的数据</span><br><span class="line">      let name = $(&#x27;#name&#x27;).val()</span><br><span class="line">      let author = $(&#x27;#author&#x27;).val()</span><br><span class="line">      let desc = $(&#x27;#desc&#x27;).val()</span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        method: &#x27;post&#x27;,</span><br><span class="line">        url: &#x27;http://localhost:3000/editBookById&#x27;,</span><br><span class="line">        data: &#123; id: myid, name, author, desc &#125;,</span><br><span class="line">        success: (data) =&gt; &#123;</span><br><span class="line">          if (data.code == 0) &#123;</span><br><span class="line">            // 隐藏编辑框</span><br><span class="line">            $(&#x27;.edit&#x27;).css(&#x27;display&#x27;, &#x27;none&#x27;)</span><br><span class="line">            alert(&#x27;修改成功&#x27;)</span><br><span class="line">            // 触发搜索按钮</span><br><span class="line">            $(&#x27;#search&#x27;).click()</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="跨域">跨域</h4>
<h5 id="跨域初体验">跨域初体验</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>发起请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 同源策略</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 协议 域名 端口号一致</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 以上其中一个不一致就跨域了</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// http://laoxu.fun:3000/admin</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://laoxu.fun/admin  协议不一致</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// http://123.456.78/admin  域名不一致</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// http://laoxu.fun:8080/admin  端口不一致</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 1、访问百度提供的地图api (第三方接口)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 2、同一个项目不同的模块会部署到不同的服务器上</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&#x27;#btn&#x27;</span>).<span class="title function_">click</span>(<span class="function">()=&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000/cors&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">success</span>: <span class="function">(<span class="params">data</span>)=&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="静态script跨域">静态script跨域</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- 利用script标签的src属性发起请求不受同源策略限制特点 --&gt;</span><br><span class="line">  &lt;!-- 有以下缺点 </span><br><span class="line">        <span class="number">1</span>、数据无法使用 =&gt; 后端返回一段js代码 =&gt; 变量/函数声明</span><br><span class="line">        <span class="number">2</span>、无法携带参数 =&gt; 后端无法获取到拼接在?后面的数据</span><br><span class="line">        <span class="number">3</span>、script发起请求响应数据是同步的 第一个script没有请求结束 第二个script的内容无法加载</span><br><span class="line">  --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> num = <span class="number">10</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:3000/cors?number=&quot;</span>+ <span class="attr">num</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 所谓跨域 不是请求未发起 而是请求发起成功 服务器接收成功、</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 并且服务器将数据响应给了浏览器 浏览器对数据做了拦截</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="动态script跨域">动态script跨域</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// jsonp本质</span></span><br><span class="line">    <span class="comment">// 前端发起请求 发起请求之前声明一个函数 </span></span><br><span class="line">    <span class="comment">// 后端返回一个函数调用 这个函数调用的函数名和前端声明的函数名一致</span></span><br><span class="line">    <span class="comment">// 所以返回的函数调用就能调用到该函数 并且通过参数把数据传进去</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">data</span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// fn(111)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 动态创建script标签 设置src属性 将script标签追加到页面上</span></span><br><span class="line">    <span class="comment">// 这种方式是异步的</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1、创建script标签</span></span><br><span class="line">    <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line">    <span class="keyword">let</span> params = <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">    <span class="comment">// 2、设置src属性</span></span><br><span class="line">    <span class="comment">// script.src = &#x27;http://localhost:3000/cors?name=&#x27;+ params</span></span><br><span class="line">    script.<span class="property">src</span> = <span class="string">&#x27;http://localhost:3000/cors&#x27;</span></span><br><span class="line">    <span class="comment">// 3、将script追加到页面上</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script)</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="函数名自定义">函数名自定义</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">data</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// foo([&#123;name: &quot;zs&quot;&#125;])</span></span><br><span class="line"><span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line">script.<span class="property">src</span> = <span class="string">&#x27;http://localhost:3000/cors?cb=foo&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script)</span><br></pre></td></tr></table></figure>
<h5 id="jsonp">jsonp</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// jsonp(面试)、cors(后端)、proxy(前端)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 同源策略: 协议、域名、端口一致就认为是同源 </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 只要有一个不一致就是跨域</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://www.baidu.com:80</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// http://localhost:5500</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 所谓的跨域 不是请求没有发送成功 而是请求发送成功了 后端也接收到了</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 并且后端也响应了 数据返回给前端被浏览器拦截了</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://www.baidu.com/sugrec?prod=pc&amp;wd=a&amp;cb=jQuery1102007891681812805862_1668749789485&amp;_=1668749789486</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://www.baidu.com/sugrec?prod=pc&amp;wd=a&amp;cb=sayHi&amp;_=1668749789486</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 返回一段函数调用 sayHi(&#123;q: &quot;a&quot;, p: false,…&#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 原生ajax发起请求 =&gt; 发现跨域问题</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;https://www.baidu.com/sugrec?prod=pc&amp;wd=a&amp;cb=sayHi&amp;_=1668749789486&#x27;</span>, <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> &gt;= <span class="number">200</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>))</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> --&gt;</span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 如何解决跨域问题 ? =&gt; jsonp</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// jsonp原理 ?</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 动态创建script标签 利用script标签的src属性发起请求不受同源策略限制的特点 后端会返回一段函数调用 前端要声明一个和该函数调用名字一样的函数 通过形参接收函数调用传过来的实参</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  &lt;!-- 以下是通过手动声明函数和script标签实现跨域 --&gt;</span><br><span class="line">  &lt;!-- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params">data</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.baidu.com/sugrec?prod=pc&amp;wd=a&amp;cb=sayHi&amp;_=1668749789486&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 上面这个script标签发起请求得到的结果如下 是一段函数调用 --&gt;</span><br><span class="line">  &lt;!-- <span class="title function_">sayHi</span>(&#123;<span class="attr">q</span>: <span class="string">&quot;a&quot;</span>, <span class="attr">p</span>: <span class="literal">false</span>,…&#125;) --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;!-- 以下是通过jquery的jsonp去处理跨域 --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://www.baidu.com/sugrec&amp;callback=jQuery361022337695995273776_1668753176561&amp;prod=pc&amp;wd=a&amp;_=1668753176562</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// https://www.baidu.com/sugrec?cb=sayHi&amp;prod=pc&amp;wd=a&amp;_=1668753483319</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// $.ajax(&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 请求路径</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   url: &#x27;https://www.baidu.com/sugrec&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 请求参数 =&gt; 最终会以键值对的形式拼接在url上</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   data: &#123; prod: &#x27;pc&#x27;, wd: &#x27;a&#x27; &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 启用jsonp</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   dataType: &#x27;jsonp&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 定义回调函数标识 =&gt;  = 左边的键</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   jsonp: &#x27;cb&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 定义回调函数名字 =&gt;  = 右边的值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   jsonpCallback: &#x27;sayHi&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // 成功的回调</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // success: (data)=&gt; &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   //   console.log(data)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   // &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125;).then((data)=&gt; &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   console.log(data)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  &lt;!-- 以下是模拟jQuery封装jsonp --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">&#123; url, data, dataType, jsonp = <span class="string">&#x27;callback&#x27;</span>, jsonpCallback &#125;</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 不管是否启用jsonp 都要返回一个promise实例</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 处理data数据 </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 现有的data数据: &#123; prod: &#x27;pc&#x27;, wd: &#x27;a&#x27; &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 目标的data数据: prod=pc&amp;wd=a</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> arr = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> data) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// [&#x27;prod=pc&#x27;, &#x27;wd=a&#x27;]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          arr.<span class="title function_">push</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span>=<span class="subst">$&#123;data[key]&#125;</span>`</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// prod=pc&amp;wd=a</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        arr = arr.<span class="title function_">join</span>(<span class="string">&#x27;&amp;&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 如果启用jsonp</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (dataType &amp;&amp; dataType == <span class="string">&#x27;jsonp&#x27;</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 处理函数调用的名字 =&gt; jsonpCallback</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          jsonpCallback = jsonpCallback || <span class="string">&#x27;jQuery&#x27;</span> + (<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">100</span> + <span class="string">&#x27;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;_&#x27;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 动态创建script标签</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 声明一个和函数调用名字一样的函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 为了返回的函数调用能在任何位置调用到该函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 我们选择将其挂载到window身上</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">window</span>[jsonpCallback] = <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">resolve</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// 父级删除</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// document.body.removeChild(script)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// 自己删除</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            script.<span class="title function_">remove</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// sayHi([&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;zs&quot;&#125;,&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;ls&quot;&#125;])</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 设置src属性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// https://www.baidu.com/sugrec?callback=jQuery361022337695995273776_1668753176561&amp;prod=pc&amp;wd=a&amp;_=1668753176562</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?<span class="subst">$&#123;jsonp&#125;</span>=<span class="subst">$&#123;jsonpCallback&#125;</span>&amp;<span class="subst">$&#123;arr&#125;</span>&amp;_<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="comment">// 将script标签追加到页面上</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// sayHi(&#x27;11111&#x27;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 请求百度的接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// ajax(&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   url: &#x27;https://www.baidu.com/sugrec&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   data: &#123; prod: &#x27;pc&#x27;, wd: &#x27;a&#x27; &#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   dataType: &#x27;jsonp&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   jsonp: &#x27;cb&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   jsonpCallback: &#x27;sayHi&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125;).then((data)=&gt; &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//   console.log(data)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 请求自己的接口</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">data</span>: &#123; <span class="attr">prod</span>: <span class="string">&#x27;pc&#x27;</span>, <span class="attr">wd</span>: <span class="string">&#x27;a&#x27;</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">jsonp</span>: <span class="string">&#x27;cb&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">jsonpCallback</span>: <span class="string">&#x27;sayHi&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// jsonp的缺点</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 1、只能发起get请求 </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 2、不安全 =&gt; 后端可能会返回一段攻击脚本</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h5 id="cors">cors</h5>
<p><strong>index.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立连接 http://127.0.0.1:5500/</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;put&#x27;</span>, <span class="string">&quot;http://localhost:3000&quot;</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置自定义头提交给后端</span></span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;myheader&#x27;</span>, <span class="string">&#x27;666&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提交cookie给后端 =&gt; 1、有cookie 自动提交 2、不跨域</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&#x27;mycookie=111&#x27;</span></span><br><span class="line"><span class="comment">// 允许强制携带凭证</span></span><br><span class="line">xhr.<span class="property">withCredentials</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 发起请求</span></span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听回调</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> &gt;= <span class="number">200</span>)&#123;</span><br><span class="line">    <span class="comment">// console.log(xhr.responseText)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取响应头</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="title function_">getResponseHeader</span>(<span class="string">&#x27;serverHeader&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 白名单</span></span><br><span class="line"><span class="keyword">let</span> whiteList = [<span class="string">&#x27;http://127.0.0.1:5500&#x27;</span>, <span class="string">&#x27;27.134.345.12:3000&#x27;</span>]</span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 获取请求源 =&gt; 谁请求我的?</span></span><br><span class="line">  <span class="comment">// console.log(req.headers.origin)</span></span><br><span class="line">  <span class="comment">// let origin = req.headers.origin</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// if (whiteList.includes(origin)) &#123;</span></span><br><span class="line">  <span class="comment">//   res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置允许访问的源</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;http://127.0.0.1:5500&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置允许所有源访问</span></span><br><span class="line">  <span class="comment">// res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, &#x27;*&#x27;)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置允许访问的请求方式 =&gt; 大写</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;PUT,DELETE&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置允许哪个自定义头访问</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;myheader&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取前端提交的请求头</span></span><br><span class="line">  <span class="comment">// console.log(req.headers)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置自定义头返回给前端</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;serverHeader&#x27;</span>, <span class="string">&#x27;999&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 告诉客户端 设置的header是可以使用的 安全的</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Expose-Headers&#x27;</span>, <span class="string">&#x27;serverHeader&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 允许客户端携带凭证</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取前端提交的cookie</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">headers</span>.<span class="property">cookie</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置预检的有效期 =&gt; 单位 s</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Max-Age&#x27;</span>, <span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;over ~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务启动 ~&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="proxy">proxy</h5>
<p><strong>index.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立连接 </span></span><br><span class="line"><span class="comment">// 不能直接请求 https://api.it120.cc/fyy/shop/goods/list =&gt; 跨域</span></span><br><span class="line"><span class="comment">// 要请求本地服务器 http://localhost:3000/fyy/shop/goods/list</span></span><br><span class="line"><span class="comment">// 让代理服务器去帮我们发起请求</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&quot;http://localhost:3000/api/fyy/shop/goods/list&quot;</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发起请求</span></span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听回调</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> &gt;= <span class="number">200</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">url</span>)</span><br><span class="line">  <span class="comment">// cors跨域</span></span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>: <span class="string">&#x27;*&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> apiProxy = <span class="title function_">createProxyMiddleware</span>(<span class="string">&#x27;/api&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">// 前端请求地址: http://localhost:3000/api/fyy/shop/goods/list</span></span><br><span class="line">    <span class="comment">// 目标地址: https://api.it120.cc/fyy/shop/goods/list</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 代理目标</span></span><br><span class="line">    <span class="attr">target</span>: <span class="string">&#x27;https://api.it120.cc&#x27;</span>,</span><br><span class="line">    <span class="comment">// =&gt; https://api.it120.cc/api/fyy/shop/goods/list</span></span><br><span class="line">    <span class="comment">// 路径重写 =&gt; 所有以/api开头的 把它替换成&#x27;&#x27;</span></span><br><span class="line">    <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// https://api.it120.cc/fyy/shop/goods/list</span></span><br><span class="line">    <span class="comment">// 改变源</span></span><br><span class="line">    <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 代理服务器帮我们处理 比如: 响应</span></span><br><span class="line">  <span class="title function_">apiProxy</span>(req, res)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// vue =&gt; webpack =&gt; express =&gt; createProxyMiddleware</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;服务启动 ~&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="postMessage">postMessage</h5>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:4000/b.html&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myframe&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;load()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">load</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> myframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#myframe&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 给b页面发送消息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        myframe.<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(<span class="string">&#x27;你真帅&#x27;</span>, <span class="string">&#x27;http://localhost:4000&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 接受b页面返回的消息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">window</span>.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">data</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>b.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">data</span>);</span><br><span class="line">        <span class="comment">// 给a页面回复消息</span></span><br><span class="line">        e.<span class="property">source</span>.<span class="title function_">postMessage</span>(<span class="string">&#x27;必须滴&#x27;</span>, e.<span class="property">origin</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>a.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<p><strong>b.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">4000</span>)</span><br></pre></td></tr></table></figure>
<h5 id="name">name</h5>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:4000/c.html&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">id</span>=<span class="string">&quot;frame&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;load()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// ab同域 c不同域</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// a页面引用了c页面</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// c页面把值放到了window.name上 a=&gt;c 跨域</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 马上把c页面的地址值修改为b页面的地址值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 此时有一个奇怪的现象 c存储的window.name还在</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> first = <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> frame = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#frame&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">load</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (first) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// src改变会重新加载iframe </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            frame.<span class="property">src</span> = <span class="string">&#x27;http://localhost:3000/b.html&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            first = <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">console</span>.<span class="title function_">log</span>(frame.<span class="property">contentWindow</span>.<span class="property">name</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>b.html</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>c.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">   <span class="variable language_">window</span>.<span class="property">name</span> = <span class="string">&#x27;萨瓦迪卡&#x27;</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="hash">hash</h5>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:4000/c.html#iloveyou&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">id</span>=<span class="string">&quot;frame&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;load()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// ab同域 ac不同域</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// a引入c 给c传一个hash </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// c拿到参数 c把hash传递给b  b将结果再给到a的hash</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">load</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// hash改变但是事件未触发</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// window.onhashchange = function () &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//     console.log(111);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// undefined</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">hash</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>b.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// console.log(location.hash);</span></span><br><span class="line">    <span class="comment">// a=&gt;c c=&gt;b</span></span><br><span class="line">    <span class="comment">// window.parent.parent.location.hash = location.hash</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>c.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">hash</span>);</span><br><span class="line">    <span class="keyword">var</span> frame = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;iframe&#x27;</span>)</span><br><span class="line">    frame.<span class="property">src</span> = <span class="string">&#x27;http://localhost:3000/a.html#metoo&#x27;</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(frame)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="domain">domain</h5>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">aaaaa</span><br><span class="line">&lt;iframe src=<span class="string">&quot;http://c.laoxu.fun:3000/c.html&quot;</span> frameborder=<span class="string">&quot;0&quot;</span> id=<span class="string">&quot;frame&quot;</span> onload=<span class="string">&quot;load()&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;laoxu.fun&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// domain 限制</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 一级域名 www.baidu.com 二级域名 music.baidu.com</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="comment">// 修改host文件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">load</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">var</span> frame = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#frame&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(frame.<span class="property">contentWindow</span>.<span class="property">number</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>b.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;laoxu.fun&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> number = <span class="number">10</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="websocket">websocket</h5>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">// websocket =&gt; 不兼容 =&gt; socket.io =&gt; 双工</span></span><br><span class="line"><span class="comment">// WebSocket 是 HTML5 提供的一种在单个 TCP 连接上进行全双工通讯的协议</span></span><br><span class="line"><span class="comment">// 原生api</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> socket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;ws://localhost:3000&#x27;</span>)</span><br><span class="line"><span class="comment">// onopen是客户端与服务端建立连接后触发</span></span><br><span class="line">socket.<span class="property">onopen</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    socket.<span class="title function_">send</span>(<span class="string">&#x27;iloveyou&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// onmessage是当服务端给客户端发来消息的时候触发，接收数据</span></span><br><span class="line">socket.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">res</span>)&#123;</span><br><span class="line">    <span class="comment">// 打印的res是MessageEvent对象</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>); <span class="comment">// 真正的消息数据是 res.data</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>a.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.listen(3000)</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">Server</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>).<span class="property">Server</span></span><br><span class="line"><span class="keyword">let</span> wss = <span class="keyword">new</span> <span class="title class_">Server</span>(&#123;<span class="attr">port</span>: <span class="number">3000</span>&#125;)</span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span>(<span class="params">ws</span>)&#123;</span><br><span class="line">    ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>,<span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">        ws.<span class="title function_">send</span>(<span class="string">&#x27;metoo&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="nginx">nginx</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">启动nginx 访问 localhost</span><br><span class="line">新建json目录 声明json文件存放数据</span><br><span class="line">location ~.*\.<span class="property">json</span> &#123;</span><br><span class="line">    root  json;</span><br><span class="line">    # ~ 忽略大小写 .*任意字符出现多次 \.单纯的.</span><br><span class="line">    # add_header <span class="string">&quot;Access-Control-Allow-Origin&quot;</span> <span class="string">&quot;*&quot;</span>;</span><br><span class="line">    # 携带凭证和 *通配符不能同时存在</span><br><span class="line">    add_header <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class="string">&#x27;http://localhost:3000&#x27;</span>;</span><br><span class="line">    add_header <span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span> <span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>a.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&#x27;laoxu&#x27;</span></span><br><span class="line">    xhr.<span class="property">cookie</span> = <span class="string">&#x27;laoxu&#x27;</span></span><br><span class="line">    xhr.<span class="property">withCredentials</span> = <span class="literal">true</span></span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;http://localhost:88/a.json&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// 设置请求头</span></span><br><span class="line">    <span class="comment">// xhr.setRequestHeader(&#x27;name&#x27;, &#x27;laoxu&#x27;)</span></span><br><span class="line">    <span class="comment">// 请求头 请求正文 请求体</span></span><br><span class="line">    xhr.<span class="title function_">send</span>()</span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="comment">// 304: 表示走缓存了</span></span><br><span class="line">            <span class="keyword">if</span> (xhr.<span class="property">status</span> &gt;= <span class="number">200</span> &amp;&amp; xhr.<span class="property">status</span> &lt;= <span class="number">300</span> || xhr.<span class="property">status</span> == <span class="number">304</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="XSS攻击">XSS攻击</h4>
<p><strong>登录页</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>登陆页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/node_modules/bootstrap/dist/css/bootstrap.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-6 col-md-offset-3&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-info&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录页面<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;login(event)&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/node_modules/jquery/dist/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> username = $(<span class="string">&#x27;#username&#x27;</span>).<span class="title function_">val</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> password = $(<span class="string">&#x27;#password&#x27;</span>).<span class="title function_">val</span>()</span></span><br><span class="line"><span class="language-javascript">$.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, &#123;username, password&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 根据后端返回的状态码做处理 code: 0 || code: 1</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span>(res.<span class="property">code</span> === <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        location.<span class="property">href</span> = <span class="string">&#x27;/index.html&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(res.<span class="property">error</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>评论页</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>评论页面<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/node_modules/bootstrap/dist/css/bootstrap.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-6 col-md-offset-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-info&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>评论区<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-footer&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;addComment(event)&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;content&quot;</span>&gt;</span>输入内容<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>发表评论<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/node_modules/jquery/dist/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 获取评论列表</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">getList</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 发起请求</span></span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">get</span>(<span class="string">&#x27;/api/list&#x27;</span>, <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> comments = res.<span class="property">comments</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> html = <span class="string">``</span></span></span><br><span class="line"><span class="language-javascript">        comments.<span class="title function_">forEach</span>(<span class="function"><span class="params">comment</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            html += <span class="string">`&lt;li&gt;<span class="subst">$&#123;comment.username&#125;</span>: <span class="subst">$&#123;encodedHTML(comment.content)&#125;</span>&lt;/li&gt;`</span></span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;.list-group&#x27;</span>).<span class="title function_">html</span>(html)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">getList</span>()</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 发表评论</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">addComment</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> comment = $(<span class="string">&#x27;#content&#x27;</span>).<span class="title function_">val</span>()</span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">post</span>(<span class="string">&#x27;/api/addComments&#x27;</span>, &#123; <span class="attr">comment</span>: <span class="title function_">encodedHTML</span>(comment) &#125;, <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (res.<span class="property">code</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">getList</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(res.<span class="property">error</span>)</span></span><br><span class="line"><span class="language-javascript">            location.<span class="property">href</span> = <span class="string">&#x27;/login.html&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 通过正则替换所有的符号</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">encodedHTML</span>(<span class="params">str</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">replace</span>(<span class="regexp">/&gt;/g</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">replace</span>(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&amp;quot;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">replace</span>(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;&amp;apos&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">replace</span>(<span class="regexp">/&amp;/g</span>, <span class="string">&#x27;&amp;amp;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>dombashed</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    图片地址: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span>&gt;</span>插入图片<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/node_modules/jquery/dist/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // 不基于后端 dom-based 改变dom结构 属性</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // 我们客户端的js可以对页面dom节点进行动态的操作，比如插入、修改页面的内容。</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // 比如说客户端从URL中提取数据并且在本地执行、如果用户在客户端输入的数据包含了恶意的js脚本的话，</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // 但是这些脚本又没有做任何过滤处理的话，那么我们的应用程序就有可能受到DOM-based XSS的攻击</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;&#x27;</span> <span class="attr">onerror</span>=<span class="string">&#x27;alert(1)&#x27;</span> &gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">        // <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="number">1</span>)&lt;\/script&gt;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="language-handlebars">        $(<span class="string">&#x27;#insert&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="language-handlebars">            $(<span class="string">&#x27;.box&#x27;</span>).<span class="title function_">html</span>(<span class="string">`&lt;img src=<span class="subst">$&#123;<span class="built_in">encodeURI</span>($(<span class="string">&#x27;.img&#x27;</span>).val())&#125;</span>&gt;`</span>) </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="language-handlebars">        &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="language-handlebars">    </span></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>server.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParse = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; urlencoded &#125; = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)))</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析url上的参数</span></span><br><span class="line"><span class="comment">// username=&#x27;zs&#x27;&amp;password=&#x27;111&#x27; =&gt; &#123;username:zs, password: 111&#125; =&gt; req.body</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyParse</span>(<span class="title function_">urlencoded</span>(&#123; <span class="attr">extends</span>: <span class="literal">true</span> &#125;)))</span><br><span class="line"><span class="comment">// 数组模拟用户数据</span></span><br><span class="line"><span class="keyword">let</span> userList = [&#123; <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;111&#x27;</span> &#125;, &#123; <span class="attr">username</span>: <span class="string">&#x27;zs&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;111&#x27;</span> &#125;]</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SESSION_ID</span> = <span class="string">&#x27;connect.sid&#x27;</span></span><br><span class="line"><span class="keyword">let</span> session = &#123;&#125;</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; username, password &#125; = req.<span class="property">body</span></span><br><span class="line">    <span class="keyword">let</span> user = userList.<span class="title function_">find</span>(<span class="function"><span class="params">user</span> =&gt;</span> (user.<span class="property">username</span> == username &amp;&amp; user.<span class="property">password</span> == password))</span><br><span class="line">    <span class="keyword">if</span> (user) &#123;</span><br><span class="line">        <span class="comment">// 返回给用户一个唯一的凭证 cookie</span></span><br><span class="line">        <span class="comment">// connect.sid = 666</span></span><br><span class="line">        <span class="keyword">let</span> cardId = <span class="title class_">Math</span>.<span class="title function_">random</span>() + <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">        <span class="comment">// 将cookie返回给客户端</span></span><br><span class="line">        <span class="comment">// 一般情况下会让cookie在前端不可以获取 并不是解决xss的方案 只是降低受损的范围</span></span><br><span class="line">        res.<span class="title function_">cookie</span>(<span class="variable constant_">SESSION_ID</span>, cardId, &#123;<span class="attr">httpOnly</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">        <span class="comment">// 维护cookie和user之间的关系</span></span><br><span class="line">        session[cardId] = user <span class="comment">// =&gt; &#123;666: &#123;username:admin, password:111&#125;&#125;</span></span><br><span class="line">        res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;用户或密码错误&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// xss-反射型(一次性的，非持久攻击) 诱导型</span></span><br><span class="line"><span class="comment">// 概念: 反射性XSS的原理是：反射性xss一般指攻击者通过特定的方式来诱惑受害者去访问一个包含恶意代码的URL。</span></span><br><span class="line"><span class="comment">// 当受害者点击恶意链接url的时候，恶意代码会直接在受害者的主机上的浏览器执行。</span></span><br><span class="line"><span class="comment">// http://localhost:3000/welcome?msg=%E4%BD%A0%E5%A5%BD</span></span><br><span class="line"><span class="comment">// http://localhost:3000/welcome?msg=&lt;script&gt;alert(1)&lt;/script&gt; chrome发现异常 屏蔽xss</span></span><br><span class="line"><span class="comment">// http://localhost:3000/welcome?msg=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/welcome&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="built_in">encodeURIComponent</span>(req.<span class="property">query</span>.<span class="property">msg</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取评论列表</span></span><br><span class="line"><span class="keyword">let</span> comments = [&#123;<span class="attr">username</span>: <span class="string">&#x27;鸿星尔克&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;同志们理性消费&#x27;</span>&#125;, </span><br><span class="line">&#123;<span class="attr">username</span>: <span class="string">&#x27;观众&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;别说话直接上链接&#x27;</span>&#125;]</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/list&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123;<span class="attr">code</span>:<span class="number">0</span>, comments&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// xss 存储型攻击</span></span><br><span class="line"><span class="comment">// 存储型XSS的原理是: 主要是将恶意代码上传或存储到服务器中，</span></span><br><span class="line"><span class="comment">// 下次只要受害者浏览包含此恶意代码的页面就会执行恶意代码</span></span><br><span class="line"><span class="comment">// 解决方案</span></span><br><span class="line"><span class="comment">// 1. 服务器做过滤</span></span><br><span class="line"><span class="comment">// 2. 前端发送请求之前做过滤</span></span><br><span class="line"><span class="comment">// 3. 前端输出到页面上之前做过滤</span></span><br><span class="line"><span class="comment">// 添加评论</span></span><br><span class="line"><span class="comment">// 解析cookie</span></span><br><span class="line"><span class="keyword">const</span> cookieParse = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParse</span>())</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/addComments&#x27;</span>,<span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;comment&#125; = req.<span class="property">body</span></span><br><span class="line">    <span class="comment">// 1627865250050.2632: &#123;username: admin, password: 111&#125;</span></span><br><span class="line">    <span class="keyword">let</span> user = session[req.<span class="property">cookies</span>[<span class="string">&#x27;connect.sid&#x27;</span>]] || <span class="literal">null</span></span><br><span class="line">    <span class="keyword">if</span>(user)&#123;</span><br><span class="line">        comments.<span class="title function_">push</span>(&#123;<span class="attr">username</span>: user.<span class="property">username</span>, <span class="attr">content</span>: comment&#125;)</span><br><span class="line">        res.<span class="title function_">json</span>(&#123;<span class="attr">code</span>: <span class="number">0</span>&#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123;<span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;用户未登录&#x27;</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;端口3000已启动&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="CSRF跨站请求伪造">CSRF跨站请求伪造</h4>
<p><strong>fish.html</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>世纪佳缘相亲网，单身光棍的天堂 (注意你的钱包哦)<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;/bad.html&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>bad.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;form name=<span class="string">&quot;myform&quot;</span> action=<span class="string">&quot;http://localhost:3000/api/pay&quot;</span> method=<span class="string">&quot;POST&quot;</span>&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;target&quot; value=&quot;zlq&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;money&quot; value=&quot;1000&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  // 提交表单</span><br><span class="line">  document.myform.submit()</span><br><span class="line">script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>pay.html</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">&lt;title&gt;转账页面&lt;/title&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;/node_modules/bootstrap/dist/css/bootstrap.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;col-md-12&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;col-md-6 col-md-offset-3&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;panel panel-info&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;panel-heading&quot;&gt;</span><br><span class="line">                    &lt;h3&gt;转账区&lt;/h3&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;panel-body&quot;&gt;</span><br><span class="line">                    &lt;h3&gt;用户: &lt;span class=&quot;u&quot;&gt;&lt;/span&gt;&lt;/h3&gt;</span><br><span class="line">                    &lt;h3&gt;金额: &lt;span class=&quot;m&quot;&gt;&lt;/span&gt;&lt;/h3&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;panel-footer&quot;&gt;</span><br><span class="line">                    &lt;form onsubmit=&quot;pay(event)&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                            &lt;label for=&quot;target&quot;&gt;收款人&lt;/label&gt;</span><br><span class="line">                            &lt;input type=&quot;text&quot; id=&quot;target&quot; class=&quot;form-control&quot;&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                            &lt;label for=&quot;money&quot;&gt;转账金额&lt;/label&gt;</span><br><span class="line">                            &lt;input type=&quot;text&quot; id=&quot;money&quot; class=&quot;form-control&quot;&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                            &lt;label for=&quot;code&quot; class=&quot;svg&quot;&gt;验证码&lt;/label&gt;</span><br><span class="line">                            &lt;input type=&quot;text&quot; id=&quot;code&quot; class=&quot;form-control&quot;&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-danger&quot; type=&quot;submit&quot;&gt;转账&lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/form&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script src=&quot;/node_modules/jquery/dist/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function getUserInfo() &#123;</span><br><span class="line">    $.get(&#x27;/api/getUserInfo&#x27;, (res) =&gt; &#123;</span><br><span class="line">        console.log(res);</span><br><span class="line">        if (res.code === 0) &#123;</span><br><span class="line">            $(&#x27;.u&#x27;).html(res.user.username)</span><br><span class="line">            $(&#x27;.m&#x27;).html(res.user.money)</span><br><span class="line">            $(&#x27;.svg&#x27;).html(res.user.pic)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            alert(res.error)</span><br><span class="line">            location.href(&#x27;/login.html&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">getUserInfo()</span><br><span class="line"></span><br><span class="line">function pay(e) &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    let target = $(&#x27;#target&#x27;).val()</span><br><span class="line">    let money = $(&#x27;#money&#x27;).val()</span><br><span class="line">    let code = $(&#x27;#code&#x27;).val()</span><br><span class="line">    // connect.sid=1627886290863.131</span><br><span class="line">    let token = document.cookie.split(&#x27;=&#x27;)[1] + &#x27;_mycookie&#x27;</span><br><span class="line">    $.post(&#x27;/api/pay&#x27;, &#123; target, money, code, token &#125;, (res) =&gt; &#123;</span><br><span class="line">        if (res.code == 0) &#123;</span><br><span class="line">            getUserInfo()</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            alert(res.error)</span><br><span class="line">            // location.href = &#x27;/login.html&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">// 解决方案</span><br><span class="line">// 1. 验证码 暴力破解 高并发量</span><br><span class="line">// 2. Referer: http://localhost:3001/</span><br><span class="line">// 3. token</span><br><span class="line"></span><br><span class="line">// xss + csrf  xsrf</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ad.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">post</span>(<span class="string">&#x27;/api/addComments&#x27;</span>, &#123; <span class="attr">comment</span>: <span class="string">&#x27;小日子过的不错的日本选手&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure>
<p><strong>server.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParse = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; urlencoded &#125; = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> svgCaptcha = <span class="built_in">require</span>(<span class="string">&#x27;svg-captcha&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)))</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析url上的参数</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyParse</span>(<span class="title function_">urlencoded</span>(&#123; <span class="attr">extends</span>: <span class="literal">true</span> &#125;)))</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/getUserInfo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 查询用户是否登录过了</span></span><br><span class="line">    <span class="keyword">let</span> user = session[req.<span class="property">cookies</span>[<span class="variable constant_">SESSION_ID</span>]] || <span class="literal">null</span></span><br><span class="line">    <span class="keyword">if</span> (user) &#123;</span><br><span class="line">        <span class="keyword">let</span> &#123; data, text &#125; = svgCaptcha.<span class="title function_">create</span>()</span><br><span class="line">        user.<span class="property">text</span> = text</span><br><span class="line">        res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">0</span>, <span class="attr">user</span>: &#123; <span class="attr">username</span>: user.<span class="property">username</span>, <span class="attr">money</span>: user.<span class="property">money</span>, <span class="attr">pic</span>: data &#125; &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;用户未登录&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 转账接口</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/pay&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; target, money, code, token &#125; = req.<span class="property">body</span></span><br><span class="line">    <span class="keyword">let</span> referer = req.<span class="property">headers</span>[<span class="string">&#x27;referer&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (token === req.<span class="property">cookies</span>[<span class="variable constant_">SESSION_ID</span>] + <span class="string">&#x27;_mycookie&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (referer.<span class="title function_">includes</span>(<span class="string">&#x27;http://localhost:3000&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (code === session[req.<span class="property">cookies</span>[<span class="variable constant_">SESSION_ID</span>]].<span class="property">text</span>) &#123;</span><br><span class="line">                money = <span class="title class_">Number</span>(money)</span><br><span class="line">                <span class="comment">// 查询用户是否登录过了</span></span><br><span class="line">                <span class="keyword">let</span> user = session[req.<span class="property">cookies</span>[<span class="variable constant_">SESSION_ID</span>]] || <span class="literal">null</span></span><br><span class="line">                <span class="keyword">if</span> (user) &#123;</span><br><span class="line">                    userList.<span class="title function_">forEach</span>(<span class="function"><span class="params">u</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 转账人</span></span><br><span class="line">                        <span class="keyword">if</span> (u.<span class="property">username</span> === user.<span class="property">username</span>) &#123;</span><br><span class="line">                            u.<span class="property">money</span> -= money</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// 收款人</span></span><br><span class="line">                        <span class="keyword">if</span> (u.<span class="property">username</span> === target) &#123;</span><br><span class="line">                            u.<span class="property">money</span> += money</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">0</span> &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;用户未登录&#x27;</span> &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;验证码错误&#x27;</span> &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;被攻击了&#x27;</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: <span class="number">1</span>, <span class="attr">error</span>: <span class="string">&#x27;token不正确&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;端口3000已启动&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>server1.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParse = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; urlencoded &#125; = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)))</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(__dirname))</span><br><span class="line"><span class="comment">// 解析url上的参数</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyParse</span>(<span class="title function_">urlencoded</span>(&#123; <span class="attr">extends</span>: <span class="literal">true</span> &#125;)))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3001</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;端口3001已启动&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

     <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px; padding-top: 10px;"> <i class="fa fa-heart"></i>--------------------------------------- The End ---------------------------------------<i class="fa fa-heart"></i>  </div>
    
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>老许
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://github.com/xuwanghui/blog.git/2024/11/27/javascript/" title="javascript">https://github.com/xuwanghui/blog.git/2024/11/27/javascript/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/javascript/" rel="tag"><i class="fa fa-tag"></i> javascript</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/11/27/helloworld/" rel="prev" title="Hello World">
      <i class="fa fa-chevron-left"></i> Hello World
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/11/27/nodejs/" rel="next" title="nodejs 学习">
      nodejs 学习 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">基础</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Number-2"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">Number</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#bigInt"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">bigInt</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">undefined</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#null"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">null</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Boolean"><span class="nav-number">1.1.1.5.</span> <span class="nav-text">Boolean</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#String"><span class="nav-number">1.1.1.6.</span> <span class="nav-text">String</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Symbol-2"><span class="nav-number">1.1.1.7.</span> <span class="nav-text">Symbol</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.2.</span> <span class="nav-text">引用数据类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.1.3.</span> <span class="nav-text">数据类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Number-3"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">Number()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#isNaN"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">isNaN()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#parseInt"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">parseInt()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#parseFloat"><span class="nav-number">1.1.3.4.</span> <span class="nav-text">parseFloat()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#toString-String"><span class="nav-number">1.1.3.5.</span> <span class="nav-text">toString() &amp;&amp; String()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Boolean-2"><span class="nav-number">1.1.3.6.</span> <span class="nav-text">Boolean</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.1.4.</span> <span class="nav-text">隐式类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E4%B8%BAString"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">转换为String</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E4%B8%BANumber"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">转换为Number</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E4%B8%BABoolean"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">转换为Boolean</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%95%B0%E5%AD%97"><span class="nav-number">1.1.4.4.</span> <span class="nav-text">字符串和数字</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99"><span class="nav-number">1.1.4.5.</span> <span class="nav-text">&#x3D;&#x3D; 隐式转换规则</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%B5%8B"><span class="nav-number">1.1.5.</span> <span class="nav-text">数据类型检测</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#typeof"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">typeof</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#instanceof"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">instanceof</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#constructor"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">constructor</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Object-prototype-toString-call"><span class="nav-number">1.1.5.4.</span> <span class="nav-text">Object.prototype.toString.call()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A0%86%E6%A0%88%E5%86%85%E5%AD%98"><span class="nav-number">1.2.</span> <span class="nav-text">堆栈内存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.3.</span> <span class="nav-text">操作符</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.3.1.</span> <span class="nav-text">算术运算符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%80%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.3.2.</span> <span class="nav-text">一元运算符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E5%B8%83%E5%B0%94%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.3.3.</span> <span class="nav-text">逻辑运算符(布尔运算符)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.3.4.</span> <span class="nav-text">关系运算符(比较运算符)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.3.5.</span> <span class="nav-text">赋值运算符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-number">1.3.6.</span> <span class="nav-text">运算符的优先级</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F-2"><span class="nav-number">1.4.</span> <span class="nav-text">作用域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%AF%E9%87%8C%E5%8C%96"><span class="nav-number">1.6.</span> <span class="nav-text">柯里化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%92%E5%BD%92"><span class="nav-number">1.7.</span> <span class="nav-text">递归</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%97%AD%E5%8C%85"><span class="nav-number">1.8.</span> <span class="nav-text">闭包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E8%A7%A3%E6%9E%90"><span class="nav-number">1.9.</span> <span class="nav-text">预解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#String-2"><span class="nav-number">1.10.</span> <span class="nav-text">String</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Array-2"><span class="nav-number">1.11.</span> <span class="nav-text">Array</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Object-2"><span class="nav-number">1.12.</span> <span class="nav-text">Object</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#this%E6%8C%87%E5%90%91"><span class="nav-number">1.13.</span> <span class="nav-text">this指向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-number">1.14.</span> <span class="nav-text">源码分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#new"><span class="nav-number">1.14.1.</span> <span class="nav-text">new</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#call"><span class="nav-number">1.14.2.</span> <span class="nav-text">call</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#apply-2"><span class="nav-number">1.14.3.</span> <span class="nav-text">apply</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#bind"><span class="nav-number">1.14.4.</span> <span class="nav-text">bind</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.15.</span> <span class="nav-text">对象</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">1.15.1.</span> <span class="nav-text">对象的分类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E6%96%B9%E5%BC%8F1"><span class="nav-number">1.15.2.</span> <span class="nav-text">创建对象方式1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#new-%E5%85%B3%E9%94%AE%E5%AD%97%E5%81%9A%E4%BA%86%E5%93%AA%E4%BA%9B%E4%BA%8B"><span class="nav-number">1.15.3.</span> <span class="nav-text">new 关键字做了哪些事</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0"><span class="nav-number">1.15.4.</span> <span class="nav-text">工厂函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E6%96%B9%E5%BC%8F2"><span class="nav-number">1.15.5.</span> <span class="nav-text">创建对象方式2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E6%96%B9%E5%BC%8F3"><span class="nav-number">1.15.6.</span> <span class="nav-text">创建对象方式3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.15.7.</span> <span class="nav-text">遍历对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-number">1.15.8.</span> <span class="nav-text">构造函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B"><span class="nav-number">1.16.</span> <span class="nav-text">原型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Array%E5%8E%9F%E5%9E%8B"><span class="nav-number">1.16.1.</span> <span class="nav-text">Array原型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E7%9A%84%E7%AE%80%E5%8D%95%E5%86%99%E6%B3%95"><span class="nav-number">1.16.2.</span> <span class="nav-text">原型的简单写法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E7%9A%84%E6%9F%A5%E6%89%BE%E8%A7%84%E5%88%99"><span class="nav-number">1.16.3.</span> <span class="nav-text">原型的查找规则</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E7%9A%84%E7%BB%88%E7%82%B9"><span class="nav-number">1.16.4.</span> <span class="nav-text">原型的终点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%B9%E5%8F%98%E5%8E%9F%E5%9E%8B%E6%8C%87%E5%90%91"><span class="nav-number">1.16.5.</span> <span class="nav-text">改变原型指向</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF-2"><span class="nav-number">1.17.</span> <span class="nav-text">继承</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ajax"><span class="nav-number">1.18.</span> <span class="nav-text">Ajax</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="nav-number">1.18.1.</span> <span class="nav-text">初体验</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ajax%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.18.2.</span> <span class="nav-text">ajax核心对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="nav-number">1.18.3.</span> <span class="nav-text">get请求方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#post%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="nav-number">1.18.4.</span> <span class="nav-text">post请求方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#onreadystatechange"><span class="nav-number">1.18.5.</span> <span class="nav-text">onreadystatechange</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#onload"><span class="nav-number">1.18.6.</span> <span class="nav-text">onload</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98"><span class="nav-number">1.18.7.</span> <span class="nav-text">缓存问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ajax%E5%B0%81%E8%A3%85"><span class="nav-number">1.18.8.</span> <span class="nav-text">ajax封装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ajax%E5%B0%81%E8%A3%85-2"><span class="nav-number">1.18.9.</span> <span class="nav-text">ajax封装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%BE%E4%B9%A6%E6%A1%88%E4%BE%8B"><span class="nav-number">1.18.10.</span> <span class="nav-text">图书案例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jquery%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.18.11.</span> <span class="nav-text">jquery实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jquery%E6%96%B9%E6%B3%95"><span class="nav-number">1.18.12.</span> <span class="nav-text">jquery方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%BE%E4%B9%A6%E6%A1%88%E4%BE%8B-2"><span class="nav-number">1.18.13.</span> <span class="nav-text">图书案例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%A8%E5%9F%9F"><span class="nav-number">1.19.</span> <span class="nav-text">跨域</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B7%A8%E5%9F%9F%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="nav-number">1.19.1.</span> <span class="nav-text">跨域初体验</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9D%99%E6%80%81script%E8%B7%A8%E5%9F%9F"><span class="nav-number">1.19.2.</span> <span class="nav-text">静态script跨域</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8A%A8%E6%80%81script%E8%B7%A8%E5%9F%9F"><span class="nav-number">1.19.3.</span> <span class="nav-text">动态script跨域</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%90%8D%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="nav-number">1.19.4.</span> <span class="nav-text">函数名自定义</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jsonp"><span class="nav-number">1.19.5.</span> <span class="nav-text">jsonp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cors"><span class="nav-number">1.19.6.</span> <span class="nav-text">cors</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#proxy"><span class="nav-number">1.19.7.</span> <span class="nav-text">proxy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#postMessage"><span class="nav-number">1.19.8.</span> <span class="nav-text">postMessage</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#name"><span class="nav-number">1.19.9.</span> <span class="nav-text">name</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hash"><span class="nav-number">1.19.10.</span> <span class="nav-text">hash</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#domain"><span class="nav-number">1.19.11.</span> <span class="nav-text">domain</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#websocket"><span class="nav-number">1.19.12.</span> <span class="nav-text">websocket</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nginx"><span class="nav-number">1.19.13.</span> <span class="nav-text">nginx</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS%E6%94%BB%E5%87%BB"><span class="nav-number">1.20.</span> <span class="nav-text">XSS攻击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0"><span class="nav-number">1.21.</span> <span class="nav-text">CSRF跨站请求伪造</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="老许"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">老许</p>
  <div class="site-description" itemprop="description">当学习成为了习惯<br/>知识也就变成了常识</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xuwanghui" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xuwanghui"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/xu_wang_hui@163.com" title="E-Mail → xu_wang_hui@163.com"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yourname" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=7515636986&auto=1&height=90"></iframe>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer" style="text-align:center">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">老许</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">951k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">14:24</span>
</div>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("03/12/2022 17:00:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        <a href="https://beian.miit.gov.cn/" target="_blank" style='color: #999999;text-decoration: none;'>京ICP备2021019190号-1</a>
      </div>
    </footer>
  </div>

  
  
  <script color='51,51,51' opacity='0.5' zIndex='-1' count='66' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '6mmQGNuthx4k1dsbW9UKhHGT-gzGzoHsz',
      appKey     : 'gXfUEGyEXIARBJjK2K53R51P',
      placeholder: "填写正确的邮箱可及时收到回复提醒哈 ~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

    </div>

</body>
</html>
<script type="text/javascript" src="/js/clicklove.js"></script>
